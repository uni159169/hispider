#ifndef _BASE64_HTML_H
#define _BASE64_HTML_H
static const char *html_code_base64 = "PGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPgogICAgPGhlYWQ+CiAgICA8dGl0bGU+SGl0YXNrIE1vbml0b3I8L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgICAgICBib2R5ewogICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjojRjRGQkZGOwogICAgICAgICAgICAgICAgY29sb3I6IzMzMzsKICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OnZlcmRhbmEsdGFob21hOwogICAgICAgICAgICAgICAgZm9udC1zaXplOjEycHQ7CiAgICAgICAgICAgICAgICB3aWR0aDoxMDAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OjEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI21haW5mcmFtZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6I0Y0RkJGRjsKICAgICAgICAgICAgICAgIHdpZHRoOjEwMCU7CiAgICAgICAgICAgICAgICBoZWlnaHQ6MTAwJTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjaXRhYiB7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO21hcmdpbjowO3BhZGRpbmc6MDsKICAgICAgICAgICAgICAgIGhlaWdodDo0MHB4OyB3aWR0aDoxMDAlO3RvcDowcHg7bGVmdDowcHg7Zm9udC1zaXplOjE2cHQ7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAjaXRhYiB1bHttYXJnaW46MDtwYWRkaW5nOjA7bGlzdC1zdHlsZTpub25lO2ZvbnQtd2VpZ2h0OmJvbGRlcjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjaXRhYiBsaXtmbG9hdDpsZWZ0O2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojYzBjMGMwO3dpZHRoOjEyMHB4OyBoZWlnaHQ6NDBweDsKICAgICAgICAgICAgICAgIGJvcmRlci1yaWdodDoxcHggc29saWQgI2NjYztmb250LXdlaWdodDpib2xkZXI7cGFkZGluZzozcHggOHB4IDNweCA4cHg7fQogICAgICAgICAgICAjaXRhYiAudGFiLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjb2xvcjojMkY1RkExO2JvcmRlci1yaWdodDoxcHggc29saWQgI2NjYzsKICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGRlcjtwYWRkaW5nOjNweCA4cHggM3B4IDhweDt3aWR0aDoxMjBweDtoZWlnaHQ6NDBweDt9CiAgICAgICAgICAgICN0YXNraW5mb3twb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7IGNvbG9yOiMyRjVGQTE7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3OyBwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmt0YXNre2ZvbnQtc2l6ZToxMnB0O2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAudnRhc2t7Zm9udC1zaXplOjEycHQ7Zm9udC13ZWlnaHQ6Ym9sZDt9CiAgICAgICAgICAgICNkYXRhYmFzZXtwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAuZGJsaXN0e3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6MHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAuZGJ0aXRsZXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDsgaGVpZ2h0OjMwcHg7fQogICAgICAgICAgICAjZGJzZWxlY3R7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2NvbG9yOiMyRjVGQTE7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICNkYmZpZWxkcyAuZGJmaWVsZHN7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAuZmllbGQtdGl0bGV7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjMGMwYzA7aGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC51bHRhYntsaXN0LXN0eWxlOm5vbmU7cGFkZGluZzowO21hcmdpbjowO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubHRhYm5hbWV7Y3Vyc29yOnBvaW50ZXI7Zm9udC1zaXplOjEycHQ7fQogICAgICAgICAgICAubHRhYntiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubHRhYi1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7Y3Vyc29yOiBwb2ludGVyO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubGZuYW1le2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5sZmllbGR7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5sZmllbGQtc2VsZWN0ZWR7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgICNkYmZpZWxkZm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo3MjBweDtoZWlnaHQ6NTBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZy10b3A6MTBweDtwYWRkaW5nLWxlZnQ6NnB4O2ZvbnQtc2l6ZToxMnB0OwogICAgICAgICAgICAgICAgY29sb3I6IzJGNUZBMTtvdmVyZmxvdzphdXRvO2Rpc3BsYXk6bm9uZTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZXtwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAudGVtcGxhdGUtdGFie2hlaWdodDoxMDAlO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAudHJlZXRhYntiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7aGVpZ2h0OjEwMCU7bWFyZ2luOmF1dG87b3ZlcmZsb3c6YXV0b30KICAgICAgICAgICAgI3RyZWUtdGl0bGV7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjMGMwYzA7Zm9udC1zaXplOjEzcHQ7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDpib2xkO2hlaWdodDozMHB4O3dpZHRoOjEwMCU7fQogICAgICAgICAgICAjdHJlZWJvZHl7cG9zaXRpb246cmVsYXRpdmU7Y29sb3I6IzAwMDAwMDt3aWR0aDoxMDAlO292ZXJmbG93OmF1dG99CiAgICAgICAgICAgIC50cmVlbGluZXtwb3NpdGlvbjpyZWxhdGl2ZTtib3JkZXI6MHB4O2ZvbnQtc2l6ZToxMnB0O2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAudGl0bGV7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O3dpZHRoOjEwMCU7fQogICAgICAgICAgICAuYnRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I2MwYzBjMDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgI3RlbXBsYXRlLXRpdGxle2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojYzBjMGMwO2ZvbnQtc2l6ZToxM3B0OwogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6Ym9sZDtoZWlnaHQ6MzBweDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgI25vZGUtdGVtcGxhdGV7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjZmZmZmZmO3BhZGRpbmc6MHB4O2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAudGVtcGxhdGUtaGVhZGVye2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAubHRlbXBsYXRle2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjdHh0Zm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDozNTBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzoxMHB4O292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI2RiZm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDozODBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzoxMHB4O292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI3h0ZW1wbGF0ZWZvcm17cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmO2Rpc3BsYXk6bm9uZTt3aWR0aDoxMDAlOwogICAgICAgICAgICAgICAgYm9yZGVyOjBweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2ZvbnQtc2l6ZToxMnB0O2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAjdXJsZm9ybXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7fQogICAgICAgICAgICAjc291cmNlX2NvZGVfb3B7ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI3RlbXBsYXRlZGl2e2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpyZWxhdGl2ZTt9CiAgICAgICAgICAgIC50ZW1wbGF0ZS1iYXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2hlaWdodDozMHB4OwogICAgICAgICAgICAgICAgZm9udC1zaXplOjEzcHQ7Zm9udC13ZWlnaHQ6Ym9sZDtjb2xvcjpzaWx2ZXI7fQogICAgICAgICAgICAjZWRpdG9yLWZyYW1le2hlaWdodDoyMDBweDt3aWR0aDoxMDAlO2JvcmRlcjoxcHggc29saWQgIzAwMDAwMDt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS1jb25maWd7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OwogICAgICAgICAgICAgICAgYm9yZGVyOjJweCBzb2xpZCAjMDAwMDAwO3BhZGRpbmc6MHB4O2ZvbnQtc2l6ZToxMnB0O2NvbG9yOiMyRjVGQTE7aGVpZ2h0OjU1MHB4O30KICAgICAgICAgICAgI3RlbXBsYXRlLWNvbmZpZy1ibG9ja3twb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDo1MjBweDtvdmVyZmxvdzphdXRvO30KICAgICAgICAgICAgI3RlbXBsYXRlLXRlc3R7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OyBib3JkZXI6MnB4IHNvbGlkICMwMDAwMDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOjBweDtoZWlnaHQ6NTUwcHg7Zm9udC1zaXplOjEycHQ7Y29sb3I6IzJGNUZBMTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS1tYXRjaGVze3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDo1MjBweDtvdmVyZmxvdzphdXRvO30KICAgICAgICAgICAgI3RlbXBsYXRlLXRlc3QtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MzBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOnJlZDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgI3RlbXBsYXRlLXZpZXdlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7CiAgICAgICAgICAgICAgICBib3JkZXI6MHB4IHNvbGlkICMwMDAwMDA7d2lkdGg6MTAwJTtoZWlnaHQ6NTAwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTJwdDtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgLmN0eHRfYmxvY2t7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjpzaWx2ZXI7Ym9yZGVyOjFweCBzb2xpZCAjMDAwMDAwO30KICAgICAgICAgICAgLmNsb3NlYnV0dG9ue2ZvbnQtc2l6ZToxNHB0O2ZvbnQtd2VpZ2h0OmJvbGQ7Y29sb3I6cmVkOwogICAgICAgICAgICAgICAgY3Vyc29yOnBvaW50ZXI7ZGlzcGxheTppbmxpbmU7dGV4dC1hbGlnbjpyaWdodDt9CiAgICAgICAgICAgIC5jbG9zZXR4dHtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MTBwdDtjb2xvcjojY2NjY2NjO3RleHQtYWxpZ246cmlnaHQ7fQogICAgICAgICAgICAjdXJsYmxvY2t7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO30KICAgICAgICAgICAgI3VybC1oZWFkZXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjY2NjY2M7CiAgICAgICAgICAgICAgICBoZWlnaHQ6MzBweDt3aWR0aDoxMDAlO2JvcmRlcjoxcHggc29saWQgI0ZGRkZGRjt9CiAgICAgICAgICAgIC51cmwtdWx7bGlzdC1zdHlsZTpub25lO3BhZGRpbmc6MDttYXJnaW46MDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLnVybC1saXtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAudXJsLWxpLXdhcm57YmFja2dyb3VuZC1jb2xvcjojRkY4MDAwO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLnVybC1saS1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAudXJsbGktaGVhZGVye2xpc3Qtc3R5bGU6bm9uZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Zm9udC13ZWlnaHQ6Ym9sZDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOiNjMGMwYzA7fQogICAgICAgICAgICAudXJsLWxpLXBhZ2V7Y29sb3I6I2NjY2M3MDtmb250LXdlaWdodDpib2xkO2ZvbnQtc2l6ZToxM3B0O30KICAgICAgICAgICAgI3VybGxpc3QtZm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo3MjBweDtoZWlnaHQ6MTUwcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmctdG9wOjEwcHg7cGFkZGluZy1sZWZ0OjZweDtmb250LXNpemU6MTJwdDsKICAgICAgICAgICAgICAgIGNvbG9yOiMyRjVGQTE7b3ZlcmZsb3c6YXV0bztkaXNwbGF5Om5vbmU7fQogICAgICAgICAgICAjcmVjb3JkLXZpZXd7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OyBib3JkZXI6MnB4IHNvbGlkICMwMDAwMDA7CiAgICAgICAgICAgICAgICBwYWRkaW5nOjBweDtoZWlnaHQ6NTUwcHg7Zm9udC1zaXplOjEycHQ7Y29sb3I6IzJGNUZBMTt9CiAgICAgICAgICAgICNyZWNvcmQtcmVze3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDo1MjBweDtvdmVyZmxvdzphdXRvO30KICAgICAgICAgICAgI3JlY29yZC1oZWFkZXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2hlaWdodDozMHB4OwogICAgICAgICAgICAgICAgZm9udC1zaXplOjE0cHQ7Y29sb3I6cmVkO2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAucmVjb3JkLXRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MjBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOiNjY2NjY2M7Zm9udC13ZWlnaHQ6Ym9sZDt3aWR0aDoxMDAlO3RleHQtYWxpZ246Y2VudGVyfQogICAgICAgICAgICAjZGF0YXtwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAjZG5ze3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtkaXNwbGF5Om5vbmU7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt9CiAgICAgICAgICAgICNkbnMtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojY2NjY2NjOwogICAgICAgICAgICAgICAgaGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTtib3JkZXI6MXB4IHNvbGlkICNGRkZGRkY7fQogICAgICAgICAgICAjZG5zLWxpc3R7cG9zaXRpb246cmVsYXRpdmU7fQogICAgICAgICAgICAuZG5zLXVse2xpc3Qtc3R5bGU6bm9uZTtwYWRkaW5nOjA7bWFyZ2luOjA7fQogICAgICAgICAgICAuZG5zLWxpe2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAuZG5zLWxpLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjcHJveHl7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO30KICAgICAgICAgICAgI3Byb3h5LWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2NjY2NjYzsKICAgICAgICAgICAgICAgIGhlaWdodDozMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjFweCBzb2xpZCAjRkZGRkZGO30KICAgICAgICAgICAgI3Byb3h5LWxpc3R7cG9zaXRpb246cmVsYXRpdmU7fQogICAgICAgICAgICAucHJveHktdWx7bGlzdC1zdHlsZTpub25lO3BhZGRpbmc6MDttYXJnaW46MDt9CiAgICAgICAgICAgIC5wcm94eS1saXtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLnByb3h5LWxpLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjdXNlcntwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7IGNvbG9yOiMyRjVGQTE7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3OyBwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmxpc3Rmb3Jte21hcmdpbjowcHg7ZGlzcGxheTogaW5saW5lO30KICAgICAgICAgICAgLm5vZGV7b3ZlcmZsb3c6aGlkZGVuO2NvbG9yOmJsYWNrO2ZvbnQtc2l6ZToxMnB0O30KICAgICAgICAgICAgLm5vZGVuYW1le2NvbG9yOmJsYWNrO2ZvbnQtc2l6ZToxMnB0O2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLmVhZGR7Y29sb3I6IzVGQjQwNDtmb250LXNpemU6MTNwdDtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAuZXVwZGF0ZXtjb2xvcjojRkY4MDAwO2ZvbnQtc2l6ZToxM3B0O2ZvbnQtd2VpZ2h0OmJvbGRlcjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5lZGVsZXRle2NvbG9yOiNCNDA0NUY7Zm9udC1zaXplOjEzcHQ7Zm9udC13ZWlnaHQ6Ym9sZGVyO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLmV2aWV3e2NvbG9yOiMwMDAwZmY7Zm9udC1zaXplOjEzcHQ7Zm9udC13ZWlnaHQ6Ym9sZGVyO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLmljb257ZGlzcGxheTppbmxpbmU7Y29sb3I6I0ZGODAwMDtmb250LXNpemU6MTNwdDt0ZXh0LWFsaWduOmNlbnRlcjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5uY2hpbGRze2Rpc3BsYXk6aW5saW5lO2NvbG9yOnJlZDtmb250LXNpemU6MTJwdDt9CiAgICAgICAgPC9zdHlsZT4KICAgIDxzY3JpcHQgbGFuZ3VhZ2U9J2phdmFzY3JpcHQnPgogICAgICAgICAgICB2YXIgb1RpbWVyID0gbnVsbDsKICAgICAgICAgICAgdmFyIGJhc2U2NEVuY29kZUNoYXJzID0gCiAgICAgICAgICAgICAgICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgICAgICAgICAgIHZhciBiYXNlNjREZWNvZGVDaGFycyA9IG5ldyBBcnJheSgKICAgICAgICAgICAgICAgIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsCiAgICAgICAgICAgICAgICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDYyLCAtMSwgLTEsIC0xLCA2MywKICAgICAgICAgICAgICAgIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsICAwLCAgMSwgIDIsICAzLCAgNCwgIDUsICA2LCAgNywgIDgsICA5LCAxMCwgMTEsIDEyLCAxMywgMTQsCiAgICAgICAgICAgICAgICAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjUsIC0xLCAtMSwgLTEsIC0xLCAtMSwKICAgICAgICAgICAgICAgIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLAogICAgICAgICAgICAgICAgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCAtMSwgLTEsIC0xLCAtMSwgLTEpOwogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRlbmNvZGUoc3RyKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG91dCwgaSwgbGVuOwogICAgICAgICAgICAgICAgdmFyIGMxLCBjMiwgYzM7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYzEgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICBpZihpID09IGxlbikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoYzEgPj4gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKGMxICYgMHgzKSA8PCA0KTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9ICI9PSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSBsZW4pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KGMxID4+IDIpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KChjMiAmIDB4RikgPDwgMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSAiPSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMSA+PiAyKTsKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKChjMiAmIDB4RikgPDwgMikgfCAoKGMzICYgMHhDMCkgPj42KSk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMyAmIDB4M0YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRkZWNvZGUoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYzEsIGMyLCBjMywgYzQ7CiAgICAgICAgICAgICAgICB2YXIgaSwgbGVuLCBvdXQ7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgLyogYzEgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMxID0gYmFzZTY0RGVjb2RlQ2hhcnNbc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmZdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMSA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzEgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIC8qIGMyICovCiAgICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgICAgICBjMiA9IGJhc2U2NERlY29kZUNoYXJzW3N0ci5jaGFyQ29kZUF0KGkrKykgJiAweGZmXTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzIgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGMyID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYzEgPDwgMikgfCAoKGMyICYgMHgzMCkgPj4gNCkpOwoKICAgICAgICAgICAgICAgICAgICAvKiBjMyAqLwogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgYzMgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gNjEpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGMzID0gYmFzZTY0RGVjb2RlQ2hhcnNbYzNdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMyA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzIgJiAwWEYpIDw8IDQpIHwgKChjMyAmIDB4M0MpID4+IDIpKTsKCiAgICAgICAgICAgICAgICAgICAgLyogYzQgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGM0ID0gc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmY7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IDYxKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgICAgICAgICAgICAgICAgICBjNCA9IGJhc2U2NERlY29kZUNoYXJzW2M0XTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzQgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzMgJiAweDAzKSA8PCA2KSB8IGM0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmMTZ0bzgoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICBvdXQgPSAiIjsKICAgICAgICAgICAgICAgIGxlbiA9IHN0ci5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoKGMgPj0gMHgwMDAxKSAmJiAoYyA8PSAweDAwN0YpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGMgPiAweDA3RkYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhFMCB8ICgoYyA+PiAxMikgJiAweDBGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDYpICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDgwIHwgKChjID4+ICAwKSAmIDB4M0YpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhDMCB8ICgoYyA+PiAgNikgJiAweDFGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDApICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmOHRvMTYoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICB2YXIgY2hhcjIsIGNoYXIzOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICBsZW4gPSBzdHIubGVuZ3RoOwogICAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGMgPj4gNCkKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogY2FzZSAyOiBjYXNlIDM6IGNhc2UgNDogY2FzZSA1OiBjYXNlIDY6IGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMHh4eHh4eHgKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IHN0ci5jaGFyQXQoaS0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6IGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDExMHggeHh4eCAgIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYyAmIDB4MUYpIDw8IDYpIHwgKGNoYXIyICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTExMCB4eHh4ICAxMHh4IHh4eHggIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIzID0gc3RyLmNoYXJDb2RlQXQoaSsrKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjICYgMHgwRikgPDwgMTIpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMiAmIDB4M0YpIDw8IDYpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMyAmIDB4M0YpIDw8IDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ3dhaXQnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG92ZXJfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2F1dG8nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGJhc2U2NHN0cmRlY29kZShzdHIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRmOHRvMTYoYmFzZTY0ZGVjb2RlKHN0cikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRyaW0oc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyheXHMrfFxzKyQpLywgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodChvYmopCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9iai5jbGFzc05hbWUgPSAiYnRpdGxlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYWNrY3NzKG9iaikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb2JqLmNsYXNzTmFtZSA9ICJ0aXRsZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudChfZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIF9wYXJlbnRFbGVtZW50ID0gX2VsZW1lbnQucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgIGlmKF9wYXJlbnRFbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICBfcGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChfZWxlbWVudCk7ICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBDcmVhdGVYTUxIVFRQKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbGh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIHhtbGh0dHAgPSBuZXcgQWN0aXZlWE9iamVjdCgiTWljcm9zb2Z0LlhNTEhUVFAiKTsKICAgICAgICAgICAgICAgICAgICBhcyA9IDE7CiAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICAgICAgeG1saHR0cCA9IG5ldyBBY3RpdmVYT2JqZWN0KCJNc3htbDIuWE1MSFRUUCIpOwogICAgICAgICAgICAgICAgICAgICAgICBhcyA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1saHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXMgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoKGUpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1saHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4geG1saHR0cDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZWJ1aWxkQ2hpbGQob1BhcmVudCwgcGlkLCBpZCwgbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYob1BhcmVudCAmJiBwYXJzZUludChpZCkgPiAwICYmIG5hbWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGNoaWxkcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSBuYW1lOwogICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyA9ICIoeyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0geCsiOiciK2NoaWxkc1t4XSsiJywiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyArPSBwaWQrIjonIitwTmFtZSsiJ30pIjsKICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnY2hpbGRzJywgc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVDaGlsZChvUGFyZW50LCBwaWQsIGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihvUGFyZW50ICYmIHBhcnNlSW50KGlkKSA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHMgPSBldmFsKHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzID0gIih7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4ICE9IHBpZCAmJiBjaGlsZHNbeF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyArPSB4KyI6JyIrY2hpbGRzW3hdKyInLCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0gcGlkKyI6JyIrcE5hbWUrIid9KSI7CiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCdjaGlsZHMnLCBzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGROb2RlKHBpZCwgaWQsIG5hbWUsIGNvdW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9kZSIraWQpICE9IG51bGwpIHJldHVybjsKICAgICAgICAgICAgICAgIC8vYWxlcnQoInBpZDoiK3BpZCsiaWQ6IitpZCsibmFtZToiK25hbWUpOwogICAgICAgICAgICAgICAgdmFyIG9QYXJlbnQgPSBudWxsOwogICAgICAgICAgICAgICAgaWYocGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgb1BhcmVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJub2RlIitwaWQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9QYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlZWJvZHknKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vYWxlcnQocGlkKyc6JytpZCsnOicrbmFtZSk7CiAgICAgICAgICAgICAgICBpZihvUGFyZW50ID09IG51bGwpIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBvTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ2xldmVsJykgKiAxOwogICAgICAgICAgICAgICAgdmFyIG5jaGlsZHMgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnbmNoaWxkcycpICogMTsKICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCduY2hpbGRzJywgbmNoaWxkcyArIDEpOwogICAgICAgICAgICAgICAgaWYocGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGNoaWxkcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSBuYW1lOwogICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyA9ICIoeyI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gY2hpbGRzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0geCsiOiciK2NoaWxkc1t4XSsiJywiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0gcGlkKyI6JyIrcE5hbWUrIid9KSI7CiAgICAgICAgICAgICAgICAgICAgb1BhcmVudC5zZXRBdHRyaWJ1dGUoJ2NoaWxkcycsIHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgb2ZvbGQgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoKG9mb2xkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRfJytwaWQpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihuY2hpbGRzID09IDApIG9mb2xkLmlubmVySFRNTCA9ICfilrwnOyAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBvbmNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigob25jaGlsZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hfJytwaWQpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvbmNoaWxkcy5pbm5lckhUTUwgPSBuY2hpbGRzKzE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvTm9kZS5pZCA9ICJub2RlIiArIGlkOwogICAgICAgICAgICAgICAgb05vZGUuY2xhc3NOYW1lID0gJ25vZGUnOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdsZXZlbCcsIGxldmVsICsgMSk7CiAgICAgICAgICAgICAgICBvTm9kZS5zZXRBdHRyaWJ1dGUoJ25jaGlsZHMnLCAwKTsKICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgncGFyZW50JywgcGlkKTsKICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgnVUlEJywgaWQpOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdVTmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgaHRtbHN0ciA9ICI8ZGl2IGlkPSd0aXRsZV8iKyBpZCArIicgY2xhc3M9J3RpdGxlJyAiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ2J0aXRsZScpO1wiICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAndGl0bGUnKTtcIj4iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3RyZWVsaW5lJz4iOwogICAgICAgICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgKGxldmVsLTEpOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGxldmVsID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBpZihjb3VudCA+IDApCiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gaWQ9J2ZvbGRfIisgaWQgKyInIGNsYXNzPSdpY29uJyBvbmNsaWNrPSdGb2xkKHRoaXMpJz7inJo8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBpZD0nZm9sZF8iKyBpZCArIicgY2xhc3M9J2ljb24nIG9uY2xpY2s9J0ZvbGQodGhpcyknPuKWujwvc3Bhbj4iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGlkPSduZF8iK2lkKyInIGNsYXNzPSdub2RlbmFtZScgdGl0bGU9J+eCueWHu+i/m+WFpeaooeeJiOeuoeeQhiciOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9uY2xpY2s9J1ZpZXdUZW1wbGF0ZXMoIitpZCsiKScgPiIrbmFtZSsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJbPHNwYW4gaWQ9J2NoXyIrIGlkICsiJyBjbGFzcz0nbmNoaWxkcycgPiIrY291bnQrIjwvc3Bhbj5dIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWFkZCcgdGl0bGU9J0FkZCcgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hBZGQoZXZlbnQpJz7inJo8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXVwZGF0ZScgdGl0bGU9J1JlbmFtZScgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hFZGl0KGV2ZW50KSc+4pyOPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPSdYRGVsZXRlKCIraWQrIiwiK3BpZCsiKSc+4pyYPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgIG9Ob2RlLmlubmVySFRNTCA9IGh0bWxzdHI7IAogICAgICAgICAgICAgICAgb1BhcmVudC5hcHBlbmRDaGlsZChvTm9kZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVXBkYXRlTm9kZShpZCwgbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUnK2lkKTsKICAgICAgICAgICAgICAgIGlmKG9Ob2RlICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdVTmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgICAgIHZhciBvTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZF8nK2lkKTsKICAgICAgICAgICAgICAgICAgICBpZihvTmFtZSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb05hbWUuaW5uZXJIVE1MID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGlzdENoaWxkcyhwYXJlbnQsIHVybCwgYXJndikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCk7CiAgICAgICAgICAgICAgICBpZih4bWxIdHRwICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bm9kZSA9IGV2YWwoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRub2RlWydpZCddID09IHBhcmVudCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdG5vZGVbJ25jaGlsZHMnXTsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGROb2RlKHBhcmVudCwgdG5vZGVbJ2NoaWxkcyddW2ldWydpZCddICogMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25hbWUnXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25jaGlsZHMnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vY2xvc2UgZm9ybQogICAgICAgICAgICBmdW5jdGlvbiBDbG9zZVRoaXMoZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0FkZCBjaGlsZAogICAgICAgICAgICBmdW5jdGlvbiBYQWRkKGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1siZWRpdG9yZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdub2RlX2FkZCc7CiAgICAgICAgICAgICAgICBmb3JtWydwaWQnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnVUlEJyk7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlaWQnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhFZGl0KGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYOwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFk7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbImVkaXRvcmZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAnbm9kZV91cGRhdGUnOwogICAgICAgICAgICAgICAgZm9ybVsncGlkJ10udmFsdWUgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3BhcmVudCcpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkJ10udmFsdWUgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ1VJRCcpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5FZGl0b3IoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R4dGZvcm0nKTsKICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdE5vZGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgcGlkID0gZm9ybVsncGlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbm9kZW5hbWUgPSBmb3JtWydub2RlbmFtZSddLnZhbHVlOwogICAgICAgICAgICAgICAgaWYob3AgPT0gJ25vZGVfYWRkJyAmJiBub2RlbmFtZSAmJiBwaWQgPj0gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPSIrb3ArIiZuYW1lPSIrZW5jb2RlVVJJQ29tcG9uZW50KG5vZGVuYW1lKSsiJnBhcmVudGlkPSIrcGlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnbm9kZV91cGRhdGUnICYmIG5vZGVuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD0iK29wKyImbmFtZT0iK2VuY29kZVVSSUNvbXBvbmVudChub2RlbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgKyImbm9kZWlkPSIrbm9kZWlkKyImcGFyZW50aWQ9IitwaWQ7CiAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFVwZGF0ZU5vZGUobm9kZWlkLCBub2RlbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5FZGl0b3IoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiA7CiAgICAgICAgICAgICAgICAvL2FsZXJ0KCJvcDoiK29wKyJub2RlaWQ6Iitub2RlaWQrInBpZDoiK3BpZCsibm9kZW5hbWU6Iitub2RlbmFtZSk7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKTsKICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3AgPT0gJ25vZGVfYWRkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bm9kZSA9IGV2YWwoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bm9kZVsnaWQnXSA9PSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IHRub2RlWyduY2hpbGRzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGROb2RlKHBpZCwgdG5vZGVbJ2NoaWxkcyddW2ldWydpZCddICogMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25hbWUnXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25jaGlsZHMnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnbm9kZV91cGRhdGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gdHJpbSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlkID4gMCAmJiBpZCA9PSBub2RlaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVcGRhdGVOb2RlKGlkLCBub2RlbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2RlbGV0ZSBub2RlCiAgICAgICAgICAgIGZ1bmN0aW9uIFhEZWxldGUobm9kZWlkLCBwYXJlbnRpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5vZGUiK25vZGVpZCk7CiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIG9Ob2RlICE9IG51bGwgJiYgKG5hbWUgPSBvTm9kZS5nZXRBdHRyaWJ1dGUoJ1VOYW1lJykpCiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgnQXJlIHlvdSBzdXJlIGRlbGV0ZSBub2RlOicrbm9kZWlkKycgbmFtZTonK25hbWUrJyA/JykgCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9bm9kZV9kZWxldGUmbm9kZWlkPSIrbm9kZWlkKyImcGFyZW50aWQ9IitwYXJlbnRpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gdHJpbSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpZCA9IG9Ob2RlLmdldEF0dHJpYnV0ZSgncGFyZW50Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9QYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZScrcGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpZCA9PSBub2RlaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCduY2hpbGRzJykgLSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnbmNoaWxkcycsIG5jaGlsZHMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDaGlsZChvUGFyZW50LCBwaWQsIGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9jaGlsZCA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hfJytwaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvY2hpbGQuaW5uZXJIVE1MID0gbmNoaWxkczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmVudC5yZW1vdmVDaGlsZChvTm9kZSk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsaWQgPSBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ25vZGVpZCddLnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlkID09IHVybGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIaWRkZW5UZW1wbGF0ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vZm9sZCBub2RlCiAgICAgICAgICAgIGZ1bmN0aW9uIEZvbGQoZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG5jaGlsZHMgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ25jaGlsZHMnKSAqIDE7CiAgICAgICAgICAgICAgICB2YXIgdWlkID0gZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdVSUQnKSAqIDE7CiAgICAgICAgICAgICAgICB2YXIgdXJsID0gIi8iOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9bm9kZV9jaGlsZHMmbm9kZWlkPSIrdWlkOwogICAgICAgICAgICAgICAgaWYoZWxlbWVudC5pbm5lckhUTUwgPT0gJ+KcmicpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0ID0gJyc7CiAgICAgICAgICAgICAgICAgICAgTGlzdENoaWxkcyh1aWQsIHVybCwgYXJndik7CiAgICAgICAgICAgICAgICAgICAgaWYobmNoaWxkcyA+IDApZWxlbWVudC5pbm5lckhUTUwgPSAn4pa8JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZWxlbWVudC5pbm5lckhUTUwgPT0gJ+KWuicpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgTGlzdENoaWxkcyh1aWQsIHVybCwgYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0ID0gZWxlbWVudC5wYXJlbnROb2RlLm9mZnNldEhlaWdodDsKICAgICAgICAgICAgICAgICAgICBpZihuY2hpbGRzID4gMCkgZWxlbWVudC5pbm5lckhUTUwgPSAn4pyaJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5FZGl0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMaW1pdFNwZWVkKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBzcGVlZCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChzcGVlZCA9IGZvcm1bJ3NwZWVkJ10udmFsdWUpICE9ICcnCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9c3BlZWRfbGltaXQmc3BlZWQ9IitzcGVlZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Rhc2tJbmZvKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9TaG93IFRhc2sKICAgICAgICAgICAgZnVuY3Rpb24gU2hvd1Rhc2tJbmZvKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhc2tpbmZvID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiAodGFza2luZm8gPSBldmFsKHR4dCkpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzcGVlZCA9IHRhc2tpbmZvWydzcGVlZF9saW1pdCddOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7nirbmgIE6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGEgaHJlZj1cImphdmFzY3JpcHQ6Vmlld1Rhc2soJ3Rhc2tfIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IHRhc2tpbmZvWydzdGF0dXMnXSsiJyk7XCIgY2xhc3M9J3Z0YXNrJyI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPiIrdGFza2luZm9bJ3N0YXR1cyddKyI8L2E+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz5VUkzmgLvmlbA6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfdG90YWwnXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7ku7vliqHmgLvmlbA6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfbnRhc2tzJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+5Lu75Yqh5a6M5oiQOiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+Iit0YXNraW5mb1sndXJsX3Rhc2tfb2snXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7ku7vliqHplJnor686Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfdGFza19lcnJvciddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPuaWh+aho+Wkp+WwjzombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ2RvY190b3RhbF96c2l6ZSddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIi8iICsgdGFza2luZm9bJ2RvY190b3RhbF9zaXplJ10rIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPkROU+ino+aekDombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ2hvc3RfY3VycmVudCddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIi8iICsgdGFza2luZm9bJ2hvc3RfdG90YWwnXSsiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+5bey55So5pe26Ze0OiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+WyIrdGFza2luZm9bJ3RfZGF5J107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7RGF5KHMpJm5ic3A7Jm5ic3A7Iit0YXNraW5mb1sndF9ob3VyJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiOiIrdGFza2luZm9bJ3RfbWluJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiOiIrdGFza2luZm9bJ3Rfc2VjJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7KyIrdGFza2luZm9bJ3RfdXNlYyddKyJdIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7kuIvovb3pgJ/luqY6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWydzcGVlZCddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiAoS0IvUykgPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+6YCf5bqm6ZmQ5Yi2OiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8Zm9ybSBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgY2xhc3M9J2xpc3Rmb3JtJyAiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbnN1Ym1pdD0nTGltaXRTcGVlZCh0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT10ZXh0IG5hbWU9c3BlZWQgdmFsdWU9JyIrc3BlZWQrIic+IChLQi9TKSAiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOzxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdPSyc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICAi77yIMOWSjOi0n+aVsOihqOekuuS4jemZkOmAn++8iTwvZm9ybT48L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIG90YXNraW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNraW5mbycpOwogICAgICAgICAgICAgICAgICAgIGlmKG90YXNraW5mbykgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdGFza2luZm8uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgICAgICAgICBvdGFza2luZm8uaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vdmlldyBUYXNrCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdUYXNrKG9wKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD0iK29wOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGFza0luZm8oeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG9uRGl2KGRpdiwgY3NzTmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9IGNzc05hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gb3V0RGl2KGRpdiwgY3NzTmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9IGNzc05hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUmVzZXREQigpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBvZGIuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgb2RiZiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZpZWxkcycpOwogICAgICAgICAgICAgICAgICAgIG9kYmYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld0RCKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRiID0gZXZhbCh0eHQpOwogICAgICAgICAgICAgICAgaWYoZGIgJiYgZGJbJ3RhYmxlcyddLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmlkID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibmFtZSA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0ndWx0YWInPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgZGJbJ3RhYmxlcyddLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiaWQgPSBkYlsndGFibGVzJ11baV1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHRhYm5hbWUgPSBkYlsndGFibGVzJ11baV1bJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdsdGFiJyBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICdsdGFiLXNlbGVjdGVkJylcIiAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAnbHRhYicpXCIgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdsdGFibmFtZScgb25jbGljaz0nVmlld1RhYmxlKCIrdGFiaWQrIiknICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiB0aXRsZT0n54K55Ye76L+b5YWl5pWw5o2u6KGo566h55CGJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSB0YWJuYW1lKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2V1cGRhdGUnIHRpdGxlPSdSZW5hbWUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEQlhFZGl0KGV2ZW50LCIrdGFiaWQrIiwgJyIrdGFibmFtZSsiJylcIj7inI48L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEZWxldGVUYWJsZSgiK3RhYmlkKyIsICciK3RhYm5hbWUrIicpXCI+4pyYPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBvZGIuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gQWRkVGFibGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhYm5hbWUgPSBmb3JtWyd0YWJuYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0YWJuYW1lICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXRhYmxlX2FkZCZuYW1lPSIrdGFibmFtZTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RCKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtWyd0YWJuYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgUmVzZXREQigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlVGFibGUodGFiaWQsIHRhYm5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGNvbmZpcm0oIkFyZSB5b3Ugc3VyZSBkZWxldGUgdGFiYmxlOiIrdGFibmFtZSsiID8iKSAKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10YWJsZV9kZWxldGUmdGFibGVpZD0iK3RhYmlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3REIoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdEYXRhYmFzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICBSZXNldERCKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0xpc3QgVGFibGUgRmllbGRzCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdGaWVsZHModHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdGFiID0gZXZhbCh0eHQpOwogICAgICAgICAgICAgICAgaWYodGFiKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB0YWJpZCA9IHRhYlsnaWQnXTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibmFtZSA9IHRhYlsnbmFtZSddOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBmbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZ0eXBlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgZmxhZyA9IDA7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciA9ICAiPHVsIGNsYXNzPSd1bHRhYicgPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdmaWVsZC10aXRsZSc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIueCueWHuzxzcGFuIGNsYXNzPSdlYWRkJyB0aXRsZT0nQ2xpY2sgQWRkIE5ldyBGaWVsZCcgIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiREJGWEFkZChldmVudCwgJyIrdGFiaWQrIicpXCI+4pyaPC9zcGFuPua3u+WKoOWtl+autSI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nbHRhYm5hbWUnPiIrdGFibmFtZSsiWyI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J25jaGlsZHMnPiIrdGFiWyduZmllbGRzJ10rIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIl08L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdGFiWyduZmllbGRzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpZCA9IHRhYlsnZmllbGRzJ11baV1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGZuYW1lID0gdGFiWydmaWVsZHMnXVtpXVsnbmFtZSddOwogICAgICAgICAgICAgICAgICAgICAgICBmdHlwZSA9IHRhYlsnZmllbGRzJ11baV1bJ3R5cGUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgZmxhZyA9IHRhYlsnZmllbGRzJ11baV1bJ2ZsYWcnXTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdsZmllbGQnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICdsZmllbGQtc2VsZWN0ZWQnKVwiICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsICdsZmllbGQnKTtcIiA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2xmbmFtZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRCRlhFZGl0KGV2ZW50LCAiK3RhYmlkKyIsIitmaWQrIiwiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICInIitmbmFtZSsiJywgIitmdHlwZSsiLCAiK2ZsYWcrIilcIj4iK2ZuYW1lKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2V1cGRhdGUnIHRpdGxlPSdDaGFuZ2UnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEQkZYRWRpdChldmVudCwgIit0YWJpZCsiLCIrZmlkKyIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJyIrZm5hbWUrIicsICIrZnR5cGUrIiwgIitmbGFnKyIpXCI+4pyOPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiRGVsZXRlRmllbGQoIit0YWJpZCsiLCIrZmlkKyIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJyIrdGFibmFtZSsiJywgJyIrZm5hbWUrIicpXCI+4pyYPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIHZhciBvZGJmaWVsZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmaWVsZHMnKTsKICAgICAgICAgICAgICAgICAgICBvZGJmaWVsZHMuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvL0xpc3QvVmlldyBGaWVsZAogICAgICAgICAgICBmdW5jdGlvbiBWaWV3VGFibGUodGFiaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKCiAgICAgICAgICAgICAgICBpZih0YWJpZCA+PSAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXRhYmxlX3ZpZXcmdGFibGVpZD0iK3RhYmlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RmllbGRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgIC8vVmlldyBkYXRhYmFzZQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3RGF0YWJhc2UoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1kYXRhYmFzZV92aWV3IjsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9kYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRhYmFzZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9kYi5zZXRBdHRyaWJ1dGUoJ2RiYXNlJywgeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvYWRMaW5rT3B0aW9ucygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vTGlzdCBUYWJsZXMKICAgICAgICAgICAgZnVuY3Rpb24gTGlzdFRhYmxlcygpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKCh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXRhYmxlX2xpc3QiOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3REIoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5EQmZvcm0oKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RiZm9ybScpOwogICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEQlhBZGQoZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDsKICAgICAgICAgICAgICAgIHZhciB5ID0gZS5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICB2YXIgWGRpdiA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGJmb3JtIik7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInhkYmZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAndGFibGVfYWRkJzsKICAgICAgICAgICAgICAgIGZvcm1bJ3RhYmxlaWQnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEQlhFZGl0KGUsIGlkLCBuYW1lKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYmZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sieGRiZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0YWJsZV9yZW5hbWUnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gaWQ7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS52YWx1ZSA9IG5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdERCKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBmb3JtWyduYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICBpZihvcCA9PSAndGFibGVfYWRkJyAmJiBuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9dGFibGVfYWRkJm5hbWU9IituYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGFibGVfcmVuYW1lJyAmJiB0YWJsZWlkID49IDAgJiYgbmFtZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPXRhYmxlX3JlbmFtZSZ0YWJsZWlkPSIrdGFibGVpZCsiJm5hbWU9IituYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGFibGVfZGVsZXRlJyAmJiB0YWJsZWlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD10YWJsZV9kZWxldGUmdGFibGVpZD0iK3RhYmxlaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3REIoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5EQmZvcm0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEQkZYQWRkKGUsIHRhYmlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYmZpZWxkZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJkYmZpZWxkZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdmaWVsZF9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gdGFiaWQ7CiAgICAgICAgICAgICAgICBmb3JtWydmaWVsZGlkJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ29sZG5hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsndHlwZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydmbGFnJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ2lzX2luZGV4J10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfbnVsbCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gREJGWEVkaXQoZSwgdGFiaWQsIGZpZWxkaWQsIGZuYW1lLCBmdHlwZSwgZmxhZykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgICAgICB2YXIgWGRpdiA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZGJmaWVsZGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1siZGJmaWVsZGZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAnZmllbGRfdXBkYXRlJzsKICAgICAgICAgICAgICAgIGZvcm1bJ3RhYmxlaWQnXS52YWx1ZSA9IHRhYmlkOwogICAgICAgICAgICAgICAgZm9ybVsnZmllbGRpZCddLnZhbHVlID0gZmllbGRpZDsKICAgICAgICAgICAgICAgIGZvcm1bJ29sZG5hbWUnXS52YWx1ZSA9IGZuYW1lOwogICAgICAgICAgICAgICAgZm9ybVsndHlwZSddLnZhbHVlID0gZnR5cGU7CiAgICAgICAgICAgICAgICBmb3JtWydmbGFnJ10udmFsdWUgPSBmbGFnOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaW5kZXgnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19udWxsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgZm9ybVsnZnR5cGUnXS5vcHRpb25zLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2Z0eXBlJ10ub3B0aW9uc1tpXS52YWx1ZSA9PSBmdHlwZSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnZnR5cGUnXS5vcHRpb25zW2ldLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydmdHlwZSddLm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGZsYWcgJiAxKSBmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYoZmxhZyAmIDIpIGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLnZhbHVlID0gZm5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gSGlkZGVuREJGaWVsZGZvcm0oKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RiZmllbGRmb3JtJyk7CiAgICAgICAgICAgICAgICBkaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEVkaXRGaWVsZChmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihmb3JtID09IG51bGwpIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IGZvcm1bJ3RhYmxlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBmaWVsZGlkID0gZm9ybVsnZmllbGRpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZuYW1lID0gZm9ybVsnbmFtZSddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZ0eXBlID0gZm9ybVsnZnR5cGUnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBvbGRuYW1lID0gZm9ybVsnb2xkbmFtZSddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG9sZHR5cGUgPSBmb3JtWyd0eXBlJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgb2xkZmxhZyA9IGZvcm1bJ2ZsYWcnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBmbGFnID0gMDsKICAgICAgICAgICAgICAgIGlmKG9wID09ICdmaWVsZF9hZGQnICYmIHRhYmxlaWQgPj0gMCAmJiBmbmFtZSAmJiBmdHlwZSA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD1maWVsZF9hZGQmdGFibGVpZD0iK3RhYmxlaWQrIiZuYW1lPSIrZm5hbWUrIiZ0eXBlPSIrZnR5cGU7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfaW5kZXgnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19udWxsJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDI7CiAgICAgICAgICAgICAgICAgICAgaWYoZmxhZyA+IDApIGFyZ3YgKz0gIiZmbGFnPSIrZmxhZzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYob3AgPT0gJ2ZpZWxkX3VwZGF0ZScgJiYgdGFibGVpZCA+PSAwICYmIGZpZWxkaWQgPj0gMCkgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVhcmd2ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaWYoZm5hbWUgJiYgZm5hbWUgIT0gb2xkbmFtZSkgZWFyZ3YgKz0gIiZuYW1lPSIrZm5hbWU7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfaW5kZXgnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19udWxsJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDI7CiAgICAgICAgICAgICAgICAgICAgaWYoZnR5cGUgIT0gb2xkdHlwZSkgZWFyZ3YgKz0gIiZ0eXBlPSIrZnR5cGU7CiAgICAgICAgICAgICAgICAgICAgaWYoZmxhZyAhPSBvbGRmbGFnKSBlYXJndiArPSAiJmZsYWc9IitmbGFnOwogICAgICAgICAgICAgICAgICAgIGlmKGVhcmd2KQogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPWZpZWxkX3VwZGF0ZSZ0YWJsZWlkPSIrdGFibGVpZCsiJmZpZWxkaWQ9IitmaWVsZGlkK2Vhcmd2OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0ZpZWxkcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RhdGFiYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkRCRmllbGRmb3JtKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlRmllbGQodGFiaWQsIGZpZWxkaWQsIHRhYm5hbWUsIGZpZWxkbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoY29uZmlybSgiQXJlIHlvdSBzdXJlIGRlbGV0ZSBUYWJsZToiK3RhYm5hbWUrIiBGaWVsZDoiK2ZpZWxkbmFtZSsiPyIpIAogICAgICAgICAgICAgICAgICAgICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPWZpZWxkX2RlbGV0ZSZ0YWJsZWlkPSIrdGFiaWQrIiZmaWVsZGlkPSIrZmllbGRpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0ZpZWxkcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RhdGFiYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9kZWxldGUgZGl2CiAgICAgICAgICAgIGZ1bmN0aW9uIGRpdnJlbW92ZShlbGVtZW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gZGl2aGlkZGVuKGVsZW1lbnQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQgJiYgZWxlbWVudC5pbm5lckhUTUwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvL21vdmluZyBkaXYKICAgICAgICAgICAgZnVuY3Rpb24gZGl2bW92ZShlLCBvKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvLm9uc2VsZWN0c3RhcnQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKGZhbHNlKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBvLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlID0gZXx8d2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgICAgIHZhciB4ID0gcGFyc2VJbnQoZS5jbGllbnRYIC0gby5wYXJlbnROb2RlLm9mZnNldExlZnQpOwogICAgICAgICAgICAgICAgICAgIHZhciB5ID0gcGFyc2VJbnQoZS5jbGllbnRZIC0gby5wYXJlbnROb2RlLm9mZnNldFRvcCk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSBmdW5jdGlvbihlKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZT1lfHx3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ucGFyZW50Tm9kZS5zdHlsZS5sZWZ0PShlLmNsaWVudFgteCkrInB4IjsKICAgICAgICAgICAgICAgICAgICAgICAgby5wYXJlbnROb2RlLnN0eWxlLnRvcD0oZS5jbGllbnRZLXkpKyJweCI7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5vbm1vdXNldXA9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQub25tb3VzZW1vdmU9bnVsbDsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldFRlbXBsYXRlZm9ybSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInRlbXBsYXRlZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlID0gLTE7CiAgICAgICAgICAgICAgICBmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSAnJwogICAgICAgICAgICAgICAgZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmsnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua21hcCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydtYXAnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19tZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbGlzdCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfdGFibGUnXS5vcHRpb25zWzBdLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfZmllbGQnXS5vcHRpb25zWzBdLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbm9kZSddLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhUUmVzZXQoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfdmlldycpOwogICAgICAgICAgICAgICAgaWYob2Rpdikgb2Rpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInRlbXBsYXRlZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkJ10udmFsdWUgPSAtMTsKICAgICAgICAgICAgICAgIGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZSA9IC0xOwogICAgICAgICAgICAgICAgZm9ybVsnY29kZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSAnJwogICAgICAgICAgICAgICAgZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ3VybCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmttYXAnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbWFwJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ21ldGhvZCddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbWV0aG9kJ11bMF0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX2xpc3QnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX3RhYmxlJ10ub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19maWVsZCddLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbm9kZSddLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsZm9ybSddOwogICAgICAgICAgICAgICAgZm9ybVsnbWV0aG9kJ11bMF0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWFRBZGQobm9kZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgWGRpdiA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieHRlbXBsYXRlZm9ybSIpOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBYVFJlc2V0KCk7CiAgICAgICAgICAgICAgICB2YXIgeGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICB4Zm9ybVsnbm9kZWlkJ10udmFsdWUgPSBub2RlaWQ7CiAgICAgICAgICAgICAgICB2YXIgdXJsZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ1cmxmb3JtIl07CiAgICAgICAgICAgICAgICB1cmxmb3JtWydtZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ3VybCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICB1cmxmb3JtWyd1cmwnXS52YWx1ZSA9ICdodHRwOi8vJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBYVEVkaXQoZm9ybWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBYVFJlc2V0KCk7CiAgICAgICAgICAgICAgICB2YXIgeGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zW2Zvcm1pZF07CiAgICAgICAgICAgICAgICB4Zm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV91cGRhdGUnOwogICAgICAgICAgICAgICAgeGZvcm1bJ25vZGVpZCddLnZhbHVlID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsndGFibGVpZCddLnZhbHVlID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZSA9IGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSBmb3JtWydwYXR0ZXJuJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnZmxhZyddLnZhbHVlID0gZm9ybVsnZmxhZyddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ25maWVsZHMnXS52YWx1ZSA9IGZvcm1bJ25maWVsZHMnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWyd1cmwnXS52YWx1ZSA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ2xpbmsnXS52YWx1ZSA9IGZvcm1bJ2xpbmsnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rbWFwJ10udmFsdWUgPSBmb3JtWydsaW5rbWFwJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbWFwJ10udmFsdWUgPSBmb3JtWydtYXAnXS52YWx1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiAxKQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiAyKQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiA0KQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbWV0aG9kJ10udmFsdWUgPSAwOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnbWV0aG9kJ10udmFsdWUgPT0gMSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4Zm9ybVsnbWV0aG9kJ10udmFsdWUgPSAxOwogICAgICAgICAgICAgICAgICAgIHhmb3JtWydmbGFnJ10udmFsdWUgfD0gMTY7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgc3RybGlua21hcCA9IGZvcm1bJ2xpbmttYXAnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHN0cmxpbmttYXAgJiYgKGxpbmttYXAgPSBldmFsKHN0cmxpbmttYXApKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwWydmbGFnJ10gJiAxNikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rX21ldGhvZCddWzFdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwWydmbGFnJ10gJiA2NCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rX2xpc3QnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgZWRpdiA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd4dGVtcGxhdGVmb3JtJykpKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKChlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlZGl2JykpKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciB1cmxmb3JtID0gZG9jdW1lbnQuZm9ybXNbInVybGZvcm0iXTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ21ldGhvZCddWzBdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnZmxhZyddLnZhbHVlICYgMTYpCiAgICAgICAgICAgICAgICAgICAgdXJsZm9ybVsnbWV0aG9kJ11bMV0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB1cmxmb3JtWyd1cmwnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgaWYoZm9ybVsndXJsJ10udmFsdWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdXJsZm9ybVsndXJsJ10udmFsdWUgPSBmb3JtWyd1cmwnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBMb2FkVVJMKHVybGZvcm0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhURGVsZXRlKG5vZGVpZCwgdGVtcGxhdGVpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG1zZyA9ICJBcmUgeW91IHN1cmUgZGVsZXRlIHRlbXBsYXRlWyIrdGVtcGxhdGVpZCsiXSBmcm9tIG5vZGVbIitub2RlaWQrIl0gPyI7CiAgICAgICAgICAgICAgICBpZihjb25maXJtKG1zZykgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGVtcGxhdGVfZGVsZXRlJm5vZGVpZD0iK25vZGVpZCsiJnRlbXBsYXRlaWQ9Iit0ZW1wbGF0ZWlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0hpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1RlbXBsYXRlcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gSGlkZGVuVGVtcGxhdGUoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGUtY29uZmlnJykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS10ZW1wbGF0ZScpKSkKICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICBpZigoZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV92aWV3JykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlX2NvZGVfb3AnKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBpZigoZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlZGl2JykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgaWYoKGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd4dGVtcGxhdGVmb3JtJykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgWFRSZXNldCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVGFibGUoZm9ybSwgZnNlbGVjdGlkLCBlbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHN0cmRiID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBkYmFzZSA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciB0YWJpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIGZpZWxkc29wdGlvbnMgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBzZWxlY3QgPSBmb3JtW2ZzZWxlY3RpZF07CiAgICAgICAgICAgICAgICBpZihzZWxlY3QpIHNlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFiYXNlJykpIAogICAgICAgICAgICAgICAgICAgICYmIChzdHJkYiA9IG9kaXYuZ2V0QXR0cmlidXRlKCdkYmFzZScpKSAmJiAoZGJhc2UgPSBldmFsKHN0cmRiKSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoKHRhYmlkID0gZWwub3B0aW9uc1tlbC5zZWxlY3RlZEluZGV4XS52YWx1ZSkgPj0gMCAKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGZpZWxkcyA9IGRiYXNlWyd0YWJsZXMnXVt0YWJpZF1bJ2ZpZWxkcyddKQogICAgICAgICAgICAgICAgICAgICAgICAmJiBzZWxlY3QpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZmllbGRzKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Qub3B0aW9uc1tpKytdID0gbmV3IE9wdGlvbihmaWVsZHNbeF1bJ25hbWUnXSwgeCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChmaWVsZHNvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc2VsZWN0VVJMKGZvcm0sIGJveCwgaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgYm94ICYmIGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoYm94LmNoZWNrZWQgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2lzX3VuaXFlXycraWRdLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2lzX2xpc3RfJytpZF0uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfZmlsZV8nK2lkXS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydub2RlaWRfJytpZF0uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfdW5pcWVfJytpZF0uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydpc19saXN0XycraWRdLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfZmlsZV8nK2lkXS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ25vZGVpZF8nK2lkXS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQ29uZmlnVGVtcGxhdGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGFyciA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgY29kZSA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChwYXR0ZXJuID0gZm9ybVsncGF0dGVybiddLnZhbHVlKSAmJiAoY29kZSA9IGZvcm1bJ2NvZGUnXS52YWx1ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGNvZGUucmVwbGFjZSgvXHJ8XG4vbWlnLCcnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSBmb3JtWydsaW5rX3RhYmxlJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlaWQgPSBmb3JtWyd0ZW1wbGF0ZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSBmb3JtWydtZXRob2QnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgb3AgPSBmb3JtWydvcCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBjb25kaXRpb24gPSAibSI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX3B1YmxpYyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHZhciBpc19pZ25vcmVjYXNlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX2dsb2JhbCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3B1YmxpYyddLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpc19wdWJsaWMgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2lnbm9yZWNhc2UgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gKz0gImkiOyAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2dsb2JhbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciByZWcgPSBuZXcgIFJlZ0V4cChwYXR0ZXJuLCBjb25kaXRpb24pOwogICAgICAgICAgICAgICAgICAgIGlmKChhcnIgPSByZWcuZXhlYyhjb2RlKSkgJiYgYXJyLmxlbmd0aCA+IDEpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChmb3JtWydtYXAnXS52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ21hcCddLnZhbHVlKSBtYXAgPSBldmFsKGZvcm1bJ21hcCddLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gYXJyLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzb3B0aW9ucyA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzb3B0aW9ucyA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZigob2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRhYmFzZScpKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmRiID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2RiYXNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGJhc2UgPSBldmFsKHN0cmRiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRiYXNlICYmIGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXSAmJiB0YWJsZWlkID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdWydmaWVsZHMnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkc29wdGlvbnMgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHNvcHRpb25zICs9IGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ11beF1bJ25hbWUnXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUnK25vZGVpZCkpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyY2hpbGRzID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2NoaWxkcycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHNvcHRpb25zICs9ICI8b3B0aW9uIHZhbHVlPSciK3grIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRzb3B0aW9ucyArPSBjaGlsZHNbeF0rIiA8L29wdGlvbj5cbiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlbXBsYXRlaWQgPj0gMCkgb3AgPSAidGVtcGxhdGVfdXBkYXRlIjsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICI8ZGl2IGNsYXNzPSd0ZW1wbGF0ZS1iYXInIG9ubW91c2Vkb3duPSciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJkaXZtb3ZlKGV2ZW50LCB0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSdkaXZyZW1vdmUoIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+WDwvc3Bhbj4mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJ0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID7lhbPpl608L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICB2YXIgIGJsb2NrID0gIjxkaXYgaWQ9J3RlbXBsYXRlLWNvbmZpZy1ibG9jayc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8Zm9ybSBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgY2xhc3M9J2xpc3Rmb3JtJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIm9uc3VibWl0PSdFZGl0VGVtcGxhdGUodGhpcywgdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbm9kZWlkJyB2YWx1ZT0nIitub2RlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSciK29wKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21ldGhvZCcgdmFsdWU9JyIrbWV0aG9kKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPSciK3RhYmxlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndGVtcGxhdGVpZCcgdmFsdWU9JyIrdGVtcGxhdGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSduZmllbGRzJyB2YWx1ZT0nIithcnIubGVuZ3RoKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICJVUkw6PGlucHV0IHR5cGU9dGV4dCBuYW1lPSd1cmwnIHNpemU9ODAgdmFsdWU9JyIrdXJsKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAi5qih54mIOjx0ZXh0YXJlYSBuYW1lPSdwYXR0ZXJuJyBjb2xzPTc2IHJvd3M9ND4iIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICtwYXR0ZXJuKyI8L3RleHRhcmVhPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19wdWJsaWMnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19wdWJsaWMpIGJsb2NrICs9ICJjaGVja2VkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5YWs5YWx5pWw5o2uIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19nbG9iYWwnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19nbG9iYWwpIGJsb2NrICs9ICJjaGVja2VkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+6YeN5aSN5Yy56YWN5aSa5p2hIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX2lnbm9yZWNhc2UnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19pZ25vcmVjYXNlKSBibG9jayArPSAiY2hlY2tlZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuW/veeVpeWkp+Wwj+WGmSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMTsgaSA8IGFyci5sZW5ndGg7aSsrKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkgPCAxMCkgYmxvY2sgKz0gJzAnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gaSsiOiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHRleHRhcmVhIG5hbWU9J3JfIitpKyInIGNvbHM9NzYgcm93cz0xIHJlYWRvbmx5L2Rpc2FibGVkPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBhcnJbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC90ZXh0YXJlYT48YnI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfoh6rliqjmi7zmjqXkuLrlrozmiJDpk77mjqUnPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfdXJsXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBvbmNsaWNrPSdzZWxlY3RVUkwodGhpcy5mb3JtLHRoaXMsIitpKyIpJz7pk77mjqU8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n6ZO+5o6l5qCH6K+G5LiA5p2h5a6M5pW05L+h5oGv55qE57uT5p2fJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX3VuaXFlXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcFtpLTFdWydmbGFnJ10gJiAzMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgZGlzYWJsZWQ9dHJ1ZSAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7moIfor4bmgKfpk77mjqU8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfliJfooajpobXlsIbkvJrkvJjlhYjkuIvovb3lubbkuJTkvJrlrprmnJ/mm7TmlrAnPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfbGlzdF8iK2krIiciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIG1hcFtpLTFdWydmbGFnJ10gJiAxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXBbaS0xXVsnZmxhZyddICYgNjQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiIGRpc2FibGVkPXRydWUgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5YiX6KGo6aG1PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n5LiL6L295a2Y5YKo5Li65paH5Lu25q+U5aaCOuWbvueJhyxtcDPnrYknPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfZmlsZV8iK2krIiciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIG1hcFtpLTFdWydmbGFnJ10gJiAxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXBbaS0xXVsnZmxhZyddICYgMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgZGlzYWJsZWQ9dHJ1ZSAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7mlofku7Y8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfljrvmjolodG1s5qCH562+5ZCO55qE5paH5pys5YaF5a65Jz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX25lZWRfY2xlYXJodG1sXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDQpIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7ljrtIVE1MPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n5Y675o6J55aR5Ly85bm/5ZGK55qE6YOo5YiG5YaF5a6577yM6K+l5Yqf6IO96LCo5oWO5L2/55SoJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX25lZWRfYW50aXNwYW1fIitpKyInIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmxhZyddICYgOCkgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuWOu+W5v+WRijwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNlbGVjdCBuYW1lPSdmaWVsZGlkXyIraSsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7lr7nlupTlrZfmrrU8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIHRhYmxlaWQgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBkYmFzZVsndGFibGVzJ11bdGFibGVpZF1bJ2ZpZWxkcyddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZpZWxkaWQnXSA9PSB4KSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgc2VsZWN0ZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj4iK2RiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ11beF1bJ25hbWUnXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBmaWVsZHNvcHRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc2VsZWN0PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNlbGVjdCBuYW1lPSdub2RlaWRfIitpKyInICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgKG1hcFtpLTFdWydmbGFnJ10gJiAxKSkgYmxvY2sgKz0gIiAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBibG9jayArPSAiIGRpc2FibGVkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuWFs+iBlOiKgueCuTwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gY2hpbGRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ25vZGVpZCddID09IHgpIGJsb2NrICs9ICIgc2VsZWN0ZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj4iKyBjaGlsZHNbeF0rIiA8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBjaGlsZHNvcHRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc2VsZWN0PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J09LJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvZm9ybT48L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLWNvbmZpZycpKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gc3RyICsgYmxvY2s7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaWQgPSAndGVtcGxhdGUtY29uZmlnJzsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdndpZHRoID0gNzAwOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbmZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4bGVmdCA9IHBhcnNlSW50KG9ib2R5Lm9mZnNldFdpZHRoKSAtIGRpdndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IG9ib2R5Lm9mZnNldExlZnQgKyh4bGVmdC8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSAyMCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0geSsncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZGl2d2lkdGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuaWQgPSAndGVtcGxhdGUtY29uZmlnLWZyYW1lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LndyaXRlKGJsb2NrKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFRlc3RUZW1wbGF0ZShmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9ICIiOwogICAgICAgICAgICAgICAgdmFyIGxpbmsgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBjb2RlID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBjb25kaXRpb24gPSAibSI7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwOwogICAgICAgICAgICAgICAgdmFyIGlzX2dsb2JhbD0gMDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKHBhdHRlcm4gPSBmb3JtWydwYXR0ZXJuJ10udmFsdWUpCiAgICAgICAgICAgICAgICAgICAgJiYgKGNvZGUgPSBmb3JtWydjb2RlJ10udmFsdWUpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXR0ZXJuLnJlcGxhY2UoL1xyfFxuL21pZywnJyk7CiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGNvZGUucmVwbGFjZSgvXHJ8XG4vbWlnLCcnKTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uICs9ICJpIjsgCiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2dsb2JhbCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbiArPSAiZyI7IAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHBhdHRlcm4pOwogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoY29uZGl0aW9uKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3ICBSZWdFeHAocGF0dGVybiwgY29uZGl0aW9uKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGlmKGlzX2dsb2JhbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKChhcnIgPSByZWcuZXhlYyhjb2RlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGFyci5sZW5ndGggPiAxKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyclswXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzW2NvdW50KytdID0gYXJyOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChhcnIgPSByZWcuZXhlYyhjb2RlKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBhcnIubGVuZ3RoID4gMSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc1tjb3VudCsrXSA9IGFycjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihjb3VudCA+IDApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gIjxkaXYgaWQ9J3RlbXBsYXRlLXRlc3QtaGVhZGVyJyBvbm1vdXNlZG93bj0nIjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJkaXZtb3ZlKGV2ZW50LCB0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPlg8L3NwYW4+Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPuWFs+mXrTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO01hdGNoIFJlc3VsdCBDb3VudDoiK2NvdW50KyI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxkaXYgaWQ9J3RlbXBsYXRlLW1hdGNoZXMnID4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSBmb3JtWydsaW5rJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGNvdW50OyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmspIHVybCA9IGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuPnJlc3VsdDoiK2krIjxocj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGogPSAxOyBqIDwgbWF0Y2hlc1tpXS5sZW5ndGg7IGorKykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaiA8IDEwKSBzdHIgKz0gIjAiOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gaisiOjx0ZXh0YXJlYSBjb2xzPTc2IHJvd3M9MT4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICttYXRjaGVzW2ldW2pdKyI8L3RleHRhcmVhPjxicj4iOyAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnID0gbmV3IFJlZ0V4cCgiPCIraisiPiIsICJpZyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShyZWcsIG1hdGNoZXNbaV1bal0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIlVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9NDggdmFsdWU9JyIrdXJsKyInPjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLXRlc3QnKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IHN0cjsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9ICd0ZW1wbGF0ZS10ZXN0JzsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdndpZHRoID0gNzAwOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbmZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4bGVmdCA9IHBhcnNlSW50KG9ib2R5Lm9mZnNldFdpZHRoKSAtIGRpdndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IG9ib2R5Lm9mZnNldExlZnQgKyh4bGVmdC8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSAyMCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0geSsncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZGl2d2lkdGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuaWQgPSAndGVtcGxhdGUtdmlld2VyJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2NrID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGNvdW50OyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmspIHVybCA9IGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNwYW4gY2xhc3M9J2N0eHRfYmxvY2snPlJlc3VsdDoiK2krIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaiA9IDE7IGogPCBtYXRjaGVzW2ldLmxlbmd0aDsgaisrKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihqIDwgMTApIGJsb2NrICs9ICIwIjsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gaisiOjx0ZXh0YXJlYSBjb2xzPTc2IHJvd3M9MT4iIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbWF0Y2hlc1tpXVtqXSsiPC90ZXh0YXJlYT48YnI+IjsgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGluaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZyA9IG5ldyBSZWdFeHAoIjwiK2orIj4iLCAiaWciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UocmVnLCBtYXRjaGVzW2ldW2pdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih1cmwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIlVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9NDggdmFsdWU9JyIrdXJsKyInPjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50Lm9wZW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC53cml0ZShibG9jayk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBTaG93VGVtcGxhdGVzKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGFyciA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLXRlbXBsYXRlJyk7CiAgICAgICAgICAgICAgICBpZihlZGl2KSBlZGl2LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgaWYodHh0ICYmIGVkaXYgJiYgKGFyciA9IGV2YWwodHh0KSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh0eHQpOwogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gYXJyWydpZCddOwogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1waWQgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBmbGFnID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBzdHJtYXAgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5maWVsZHMgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RybGlua21hcCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gYXJyWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydub2RlaWQnXS52YWx1ZSA9IG5vZGVpZDsKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICAiPHVsIGNsYXNzPSd1bHRhYicgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0ndGVtcGxhdGUtaGVhZGVyJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICLovpPlhaVVUkzmtYvor5XmqKHniYgiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICLnhLblkI7mt7vliqDliLAmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IG5hbWUgKyAiWyIgKyBhcnJbJ250ZW1wbGF0ZXMnXSArICJdIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGFyclsnbnRlbXBsYXRlcyddOyBpKyspCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gYXJyWyd0ZW1wbGF0ZXMnXVtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9IGJhc2U2NHN0cmRlY29kZSh0ZW1wWydwYXR0ZXJuJ10pOwogICAgICAgICAgICAgICAgICAgICAgICBmbGFnID0gdGVtcFsnZmxhZ3MnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGlkID0gdGVtcFsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVpZCA9IHRlbXBbJ3RhYmxlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgbWFwID0gdGVtcFsnbWFwJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmttYXAgPSB0ZW1wWydsaW5rbWFwJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm1hcCA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RybWFwID0gIntbIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIG1hcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJtYXAgKz0gIntmaWVsZGlkOiIrbWFwW3hdWydmaWVsZGlkJ10rICIsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJub2RlaWQ6IittYXBbeF1bJ25vZGVpZCddKyAiLCIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmxhZzoiK21hcFt4XVsnZmxhZyddKyAifSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCA8IChtYXAubGVuZ3RoIC0gMSkpIHN0cm1hcCArPSAiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJtYXAgKz0gIl19IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdHJsaW5rbWFwID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmxpbmttYXAgPSAiKHsiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmllbGRpZDonIitsaW5rbWFwWydmaWVsZGlkJ10rIicsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIm5vZGVpZDonIitsaW5rbWFwWydub2RlaWQnXSsiJywiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmxhZzonIitsaW5rbWFwWydmbGFnJ10rIiciIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsifSkiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHRlbXBbJ3VybCddOwogICAgICAgICAgICAgICAgICAgICAgICBsaW5rID0gdGVtcFsnbGluayddOwogICAgICAgICAgICAgICAgICAgICAgICBuZmllbGRzID0gdGVtcFsnbmZpZWxkcyddKzE7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxmb3JtIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyBjbGFzcz0nbGlzdGZvcm0nICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBuYW1lPSd4Zm9ybSIrdGVtcGlkKyInIG9uc3VibWl0PSdYVEVkaXQodGhpcyknPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0nbHRlbXBsYXRlJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHRleHRhcmVhIG5hbWU9J3BhdHRlcm4nIGNvbHM9ODAgcm93cz0xIHJlYWRvbmx5L2Rpc2FibGVkID4iIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgK3BhdHRlcm4rIjwvdGV4dGFyZWE+Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25vZGVpZCcgdmFsdWU9JyIrbm9kZWlkKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0ZW1wbGF0ZWlkJyB2YWx1ZT0nIit0ZW1waWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZsYWcnIHZhbHVlPSciK2ZsYWcrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPSciK3RhYmxlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25maWVsZHMnIHZhbHVlPSciK25maWVsZHMrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21hcCcgdmFsdWU9JyIrc3RybWFwKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdsaW5rJyB2YWx1ZT0nIitsaW5rKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdsaW5rbWFwJyB2YWx1ZT1cIiIrc3RybGlua21hcCsiXCI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3VybCcgdmFsdWU9JyIrdXJsKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdldXBkYXRlJyB0aXRsZT0nQ2hhbmdlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiWFRFZGl0KCd4Zm9ybSIrdGVtcGlkKyInKVwiID7inI48L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hURGVsZXRlKCIrbm9kZWlkKyIsICIrdGVtcGlkKyIpJz7inJg8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2Zvcm0+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIGVkaXYuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3VGVtcGxhdGVzKG5vZGVpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9sZG5vZGVpZCA9IGRvY3VtZW50LmZvcm1zWyd0ZW1wbGF0ZWZvcm0nXVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICBpZihvbGRub2RlaWQgIT0gbm9kZWlkKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIEhpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBGb2xkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkXycrbm9kZWlkKSk7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXRlbXBsYXRlX2xpc3Qmbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGVtcGxhdGVzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBYVEFkZChub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vZWRpdCBMaW5rCiAgICAgICAgICAgIGZ1bmN0aW9uIEVkaXRMaW5rKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBsaW5rID0gIiI7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChsaW5rID0gZm9ybVsnbGluayddLnZhbHVlKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgb3AgPSBmb3JtWydvcCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSBmb3JtWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IGZvcm1bJ2xpbmtfdGFibGUnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVpZCA9IGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9IGZvcm1bJ3BhdHRlcm4nXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IGZvcm1bJ2xpbmsnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybVsndXJsJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZsYWcgPSA4OwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3B1YmxpYyddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2dsb2JhbCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAyOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2lnbm9yZWNhc2UnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gNDsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydtZXRob2QnXS52YWx1ZSA9PSAxKSBmbGFnIHw9IDE2OwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rX2ZsYWcgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2xpbmtfbWV0aG9kJ11bMV0uY2hlY2tlZCA9PSB0cnVlKSBsaW5rX2ZsYWcgfD0gMTY7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbGlua19saXN0J10uY2hlY2tlZCA9PSB0cnVlKSBsaW5rX2ZsYWcgfD0gNjQ7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmttYXAgPSAiWyIgKyBmb3JtWydsaW5rX2ZpZWxkJ10udmFsdWUgKyAnLCcKICAgICAgICAgICAgICAgICAgICAgICAgKyBmb3JtWydsaW5rX25vZGUnXS52YWx1ZSArICcsJwogICAgICAgICAgICAgICAgICAgICAgICArIGxpbmtfZmxhZyArICddJzsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGxpbmttYXApOwogICAgICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJub2RlaWQ9Iitub2RlaWQrIiZ0YWJsZWlkPSIrdGFibGVpZCsiJmZsYWc9IitmbGFnCiAgICAgICAgICAgICAgICAgICAgICAgICsiJmxpbmttYXA9IitlbmNvZGVVUklDb21wb25lbnQobGlua21hcCkKICAgICAgICAgICAgICAgICAgICAgICAgKyImbGluaz0iK2VuY29kZVVSSUNvbXBvbmVudChsaW5rKQogICAgICAgICAgICAgICAgICAgICAgICArIiZwYXR0ZXJuPSIrZW5jb2RlVVJJQ29tcG9uZW50KHBhdHRlcm4pOwogICAgICAgICAgICAgICAgICAgIGlmKHVybCkgYXJndiArPSAiJnVybD0iK2VuY29kZVVSSUNvbXBvbmVudCh1cmwpOwogICAgICAgICAgICAgICAgICAgIGlmKG9wID09ICd0ZW1wbGF0ZV9hZGQnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJm9wPXRlbXBsYXRlX2FkZCI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYob3AgPT0gJ3RlbXBsYXRlX3VwZGF0ZScpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImb3A9dGVtcGxhdGVfdXBkYXRlJnRlbXBsYXRlaWQ9Iit0ZW1wbGF0ZWlkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3AgPT0gJ3RlbXBsYXRlX2FkZCcpIFJlc2V0VGVtcGxhdGVmb3JtKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgSGlkZGVuVGVtcGxhdGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1RlbXBsYXRlcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9lZGl0IHRlbXBsYXRlCiAgICAgICAgICAgIGZ1bmN0aW9uIEVkaXRUZW1wbGF0ZShmb3JtLCBlbGVtZW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3AgPSBmb3JtWydvcCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG5vZGVpZCA9IGZvcm1bJ25vZGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlaWQgPSBmb3JtWyd0ZW1wbGF0ZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IGZvcm1bJ3RhYmxlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gZm9ybVsncGF0dGVybiddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHVybCA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IGZvcm1bJ21ldGhvZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDE7CiAgICAgICAgICAgICAgICBpZihmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2lnbm9yZWNhc2UnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gNDsKICAgICAgICAgICAgICAgIGlmKG1ldGhvZCA9PSAxKSBmbGFnIHw9IDE2OwogICAgICAgICAgICAgICAgdmFyIG5maWVsZHMgPSBmb3JtWyduZmllbGRzJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRpZCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgaXNfdXJsID0gMDsKICAgICAgICAgICAgICAgIHZhciBpc19maWxlID0gMDsKICAgICAgICAgICAgICAgIHZhciBpc19uZWVkX2NsZWFyaHRtbCA9IDA7CiAgICAgICAgICAgICAgICB2YXIgaXNfbmVlZF9hbnRpc3BhbSA9IDA7CiAgICAgICAgICAgICAgICB2YXIgY2hpbGRfbm9kZWlkID0gMDsKICAgICAgICAgICAgICAgIHZhciBjaGlsZF9mbGFnID0gMDsKICAgICAgICAgICAgICAgIHZhciBtYXAgPSAieyI7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDE7IGkgPCBuZmllbGRzOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZmllbGRpZCA9ICBmb3JtWydmaWVsZGlkXycraV0udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnID0gMDsKICAgICAgICAgICAgICAgICAgICBub2RlX2lkID0gLTE7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfdXJsXycraV0uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc191bmlxZV8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSAzMjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZmlsZV8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfbGlzdF8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSA2NDsKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9pZCA9IGZvcm1bJ25vZGVpZF8nK2ldLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19uZWVkX2NsZWFyaHRtbF8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSA0OwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX25lZWRfYW50aXNwYW1fJytpXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gODsKICAgICAgICAgICAgICAgICAgICBtYXAgKz0gIlsiK2ZpZWxkaWQrIiwiK25vZGVfaWQrIiwiK25vZGVfZmxhZysiXSI7CiAgICAgICAgICAgICAgICAgICAgaWYoaSA8IChuZmllbGRzIC0gMSkpIG1hcCArPSAiOyI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBtYXAgKz0gIn0iOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAibm9kZWlkPSIrbm9kZWlkKyImdGFibGVpZD0iK3RhYmxlaWQrIiZmbGFnPSIgCiAgICAgICAgICAgICAgICAgICAgK2ZsYWcrIiZtYXA9IitlbmNvZGVVUklDb21wb25lbnQobWFwKQogICAgICAgICAgICAgICAgICAgICsiJnBhdHRlcm49IitlbmNvZGVVUklDb21wb25lbnQocGF0dGVybik7CiAgICAgICAgICAgICAgICBpZih1cmwpIGFyZ3YgKz0gIiZ1cmw9IitlbmNvZGVVUklDb21wb25lbnQodXJsKTsKICAgICAgICAgICAgICAgIGlmKG9wID09ICd0ZW1wbGF0ZV9hZGQnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZvcD10ZW1wbGF0ZV9hZGQiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGVtcGxhdGVfdXBkYXRlJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImb3A9dGVtcGxhdGVfdXBkYXRlJnRlbXBsYXRlaWQ9Iit0ZW1wbGF0ZWlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdnJlbW92ZShlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihvcCA9PSAndGVtcGxhdGVfYWRkJykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlc2V0VGVtcGxhdGVmb3JtKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSGlkZGVuVGVtcGxhdGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGVtcGxhdGVzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2RhdGFiYXNlCiAgICAgICAgICAgIGZ1bmN0aW9uIHNlbGVjdFZpZXcoZGl2LCBlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZWxpc3QgPSBuZXcgQXJyYXkoJ3Rhc2tpbmZvJywnZGF0YWJhc2UnLCAndGVtcGxhdGUnLCAKICAgICAgICAgICAgICAgICAgICAndXJsYmxvY2snLCAnZGF0YScsICdkbnMnLCAncHJveHknLCAndXNlcicpOwogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgICAgICB2YXIgb2xpID0gbnVsbCwgb2IgPSBudWxsLCBvZGl2ID0gbnVsbDsKICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGVsaXN0Lmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKChvbGkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFiJytpKSkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZihvbGkgPT0gZWxlbWVudCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9saS5jbGFzc05hbWUgPSAndGFiLXNlbGVjdGVkJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9saS5jbGFzc05hbWUgPSAnJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoZGl2ID09IGVsaXN0W2ldKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb2IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGlzdFtpXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9iLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsaXN0W2ldKTsKICAgICAgICAgICAgICAgICAgICAgICAgb2Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICBpZihlbGlzdFtpXSA9PSAndGFza2luZm8nKSAKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob1RpbWVyKSB3aW5kb3cuY2xlYXJJbnRlcnZhbChvVGltZXIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb1RpbWVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGVsaXN0W2ldID09ICdkYXRhYmFzZScpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RiZm9ybScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGl2Zm9ybSkgZGl2Zm9ybS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGRpdmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmaWVsZGZvcm0nKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2Zm9ybS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZWxpc3RbaV0gPT0gJ3RlbXBsYXRlJykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHh0Zm9ybScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGl2Zm9ybSkgZGl2Zm9ybS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoZGl2ID09ICd0YXNraW5mbycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbG9hZFRhc2tJbmZvKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAnZGF0YWJhc2UnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBpZihvZGIuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFRhYmxlcygpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICd0ZW1wbGF0ZScpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRyZWVib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZWVib2R5Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYodHJlZWJvZHkuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgQWRkTm9kZSgtMSwwLCJSb290IiwwKTsKICAgICAgICAgICAgICAgICAgICAgICAgRm9sZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZF8wJykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICd1cmxibG9jaycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybGJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybGJsb2NrJyk7CiAgICAgICAgICAgICAgICAgICAgaWYodXJsYmxvY2spCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB1cmxibG9jay5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmxsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3QuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3VybGJsb2NrZm9ybSddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFBOb2RlcygwKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICdkYXRhJykKICAgICAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAnZG5zJykKICAgICAgICAgICAgICAgIC8vJiYgb2IuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0RE5TTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIExpc3RETlMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICdwcm94eScpCiAgICAgICAgICAgICAgICAvLyYmIG9iLmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFByb3h5TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIExpc3RQcm94eSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihkaXYgPT0gJ3VzZXInKQogICAgICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBsb2FkVGFza0luZm8oKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBWaWV3VGFzaygndGFza192aWV3Jyk7CiAgICAgICAgICAgICAgICBvVGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoIlZpZXdUYXNrKCd0YXNrX3ZpZXcnKSIsIDEwMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBHZXRDb250ZW50KHVybCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgLy94bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIC8veG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkRCRmllbGRmb3JtKCk7CiAgICAgICAgICAgIH0KCSAgICAgICAgZnVuY3Rpb24gZ2V0RnJhbWVEb2N1bWVudChpZCkKCSAgICAgICAgewoJICAgICAgICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKCSAgICAgICAgICAgIHZhciBEb2MgPSBudWxsOwoJICAgICAgICAgICAgaWYoaWZyYW1lKQoJICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgIGlmKGlmcmFtZS5kb2N1bWVudCkKCSAgICAgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgICAgIERvYyA9IGlmcmFtZS5kb2N1bWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZihpZnJhbWUuY29udGVudERvY3VtZW50KSAvLyBGb3IgTlM2CgkgICAgICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgICAgICBEb2MgPSBpZnJhbWUuY29udGVudERvY3VtZW50OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmKGlmcmFtZS5jb250ZW50V2luZG93KQoJICAgICAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICAgICAgRG9jID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmKERvYykKCSAgICAgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgICAgIGlmKERvYy5kZXNpZ25Nb2RlKSBEb2MuZGVzaWduTW9kZSA9ICdPbic7CgkgICAgICAgICAgICAgICAgICAgIGlmKERvYy5jb250ZW50RWRpdGFibGUpIERvYy5jb250ZW50RWRpdGFibGUgPSB0cnVlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiBEb2M7CgkgICAgICAgIH0KCSAgICAgICAgZnVuY3Rpb24gZ2V0U2VsZWN0Q29udGVudChpZCkKCSAgICAgICAgewoJICAgICAgICAgICAgdmFyIERvYyA9IGdldEZyYW1lRG9jdW1lbnQoaWQpOwoJICAgICAgICAgICAgaWYoRG9jKQoJICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKERvYy5nZXRTZWxlY3Rpb24pCiAgICAgICAgICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgICAgICBhbGVydChEb2MuZ2V0U2VsZWN0aW9uKCkucGFyZW50Tm9kZS5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKERvYy5zZWxlY3Rpb24pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydChEb2Muc2VsZWN0aW9uLnBhcmVudE5vZGUuaW5uZXJIVE1MKTsKICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld1NlbGVjdChlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuaW5uZXJIVE1MKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KGVsZW1lbnQucGFyZW50Tm9kZS5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExvYWRMaW5rT3B0aW9ucygpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgZmxhZyA9IDA7CiAgICAgICAgICAgICAgICB2YXIgb2RpdiA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgbGlua21hcCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgb3NlbGVjdCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZGJhc2UgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChub2RlaWQgPSBmb3JtWydub2RlaWQnXS52YWx1ZSkgPiAwICkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydsaW5rbWFwJ10udmFsdWUpIGxpbmttYXAgPSBldmFsKGZvcm1bJ2xpbmttYXAnXS52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgZmxhZyA9IGZvcm1bJ2ZsYWcnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIGlmKChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFiYXNlJykpCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChzdHJkYiA9IG9kaXYuZ2V0QXR0cmlidXRlKCdkYmFzZScpKSAKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGRiYXNlID0gZXZhbChzdHJkYikpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdCA9IGZvcm1bJ2xpbmtfdGFibGUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBkYmFzZVsndGFibGVzJ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlID0gZGJhc2VbJ3RhYmxlcyddW3hdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldID0gbmV3IE9wdGlvbih0YWJsZVsnbmFtZSddLCB4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXAgJiYgeCA9PSB0YWJsZWlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2k7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYobGlua21hcCAmJiB0YWJsZWlkICA+PSAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzID0gZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdWydmaWVsZHMnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3QgPSBmb3JtWydsaW5rX2ZpZWxkJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZmllbGRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXSA9IG5ldyBPcHRpb24oZmllbGRzW3hdWyduYW1lJ10sIHgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXAgJiYgZmxhZyA+PSAwICYmIChmbGFnICYgOCkgJiYgeCA9PSBsaW5rbWFwWydmaWVsZGlkJ10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2k7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZHMgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgKG9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZScrbm9kZWlkKSkKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKHN0cmNoaWxkcyA9IG9kaXYuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChjaGlsZHMgPSBldmFsKHN0cmNoaWxkcykpICkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChmb3JtWydsaW5rbWFwJ10udmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0ID0gZm9ybVsnbGlua19ub2RlJ107CiAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBpZihjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gY2hpbGRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXSA9IG5ldyBPcHRpb24oY2hpbGRzW3hdLCB4KTsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGlua21hcCAmJiB4ID09IGxpbmttYXBbJ25vZGVpZCddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCQkgICAgZnVuY3Rpb24gTG9hZFVSTChmb3JtKQoJCSAgICB7CgkJICAgICAgICB2YXIgdXJsID0gZm9ybVsndXJsJ10udmFsdWU7CgkJICAgICAgICBpZih1cmwpCgkJICAgICAgICB7CgkJICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwoJCSAgICAgICAgICAgIGlmKCh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQoJCSAgICAgICAgICAgIHsKCQkgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3RVUkwgPSAnL3Byb3h5LycrdXJsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbWV0aG9kJ11bMV0uY2hlY2tlZCA9PSB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigocG9zID0gdXJsLmluZGV4T2YoJz8nKSkgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0VVJMID0gJy9wcm94eS8nK3VybC5zdWJzdHJpbmcoMCwgcG9zLTEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSB1cmwuc3Vic3RyaW5nKHBvcyArIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVUkwgPSAnL3Byb3h5LycrdXJsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsIHJlcXVlc3RVUkwsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVSTCA9ICcvcHJveHkvJyt1cmw7CgkJICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ0dFVCcsIHJlcXVlc3RVUkwsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKCQkgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQoJCSAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKCQkgICAgICAgICAgICAgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSB4bWxIdHRwLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXYgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfY29kZV9vcCcpKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlX3ZpZXcnKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudCkgZWxlbWVudC5pbm5lckhUTUwgPSAiIjsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgiaWQiLCAnZWRpdG9yLWZyYW1lJyk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZnJhbWUpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gbnVsbDsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGRvYyA9IGdldEZyYW1lRG9jdW1lbnQoJ2VkaXRvci1mcmFtZScpKSkKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzdHIgPSBzdHI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdHIubWF0Y2goLzxiYXNlIC4qP2hyZWY9Lio/Pi9pKSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYXNldXJsID0gdXJsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigocG9zID0gdXJsLmxhc3RJbmRleE9mKCcvJykpID4gNikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2V1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIHBvcysxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VocmVmID0gIjxoZWFkPjxiYXNlIGhyZWY9JyIrYmFzZXVybCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgPSBzdHIucmVwbGFjZSgvPGhlYWQ+L2ksIGJhc2VocmVmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5vcGVuKCk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2Mud3JpdGUoaHRtbHN0cik7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuY2xvc2UoKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZWRpdicpKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXYuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydjb2RlJ10udmFsdWUgPSBzdHI7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ3VybCddLnZhbHVlID0gdXJsOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydtZXRob2QnXS52YWx1ZSA9IG1ldGhvZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ2NvZGUnXS52YWx1ZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0geG1sSHR0cC5nZXRBbGxSZXNwb25zZUhlYWRlcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJfd2FpdCgpOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZCgpOwogICAgICAgICAgICAgICAgICAgICAgICBzdGFydF93YWl0KCk7CgkJICAgICAgICAgICAgfQoJCSAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIFZpZXdEYXRhYmFzZSgpOwoJCSAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0RGl2KGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICAgICAgICAgICAgaWYoZGl2KSBkaXYuaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUmVzZXRVUkxMaXN0KCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsYmxvY2tmb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0RGl2KCd1cmwtbGlzdCcpOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2xldmVsJ10ub3B0aW9uc1swXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsndXJsJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICBmb3JtWyd1cmwnXS52YWx1ZSA9ICdodHRwOi8vJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMaXN0UE5vZGVzKG5vZGVpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsYmxvY2tmb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIG5vZGVpZCA+PSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD1ub2RlX2Jyb3RoZXImbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9bm9kZV9jaGlsZHMmbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGlmKGFyZ3YgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vUmVzZXRVUkxMaXN0KCk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRub2RlID0gZXZhbCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvc2VsZWN0ID0gZm9ybVsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9zZWxlY3QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAwLCB4ID0gMSwgdGlkID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bmFtZSA9ICIuLiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bm9kZVsnaWQnXSA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW3grK109bmV3IE9wdGlvbih0bmFtZSwgdG5vZGVbJ2lkJ10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdG5vZGVbJ25jaGlsZHMnXTsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpZCA9IHRub2RlWydjaGlsZHMnXVtpXVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bmFtZSA9IHRub2RlWydjaGlsZHMnXVtpXVsnbmFtZSddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA9PSB0aWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1t4XSA9IG5ldyBPcHRpb24odG5hbWUsIHRpZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbeF0gPSBuZXcgT3B0aW9uKHRuYW1lLCB0aWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsreDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbW92ZUNoaWxkTm9kZXMoZm9ybSwgbm9kZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2xpc3QgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9jaGlsZHMgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAob2xpc3QgPSBmb3JtWydub2RlaWQnXSkgJiYgKG9jaGlsZHMgPSBmb3JtWydjaGlsZHMnXSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgb2xpc3Qub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgIHggPSAxOwogICAgICAgICAgICAgICAgICAgIGZvcihpID0gMTsgaSA8IG9jaGlsZHMub3B0aW9ucy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRuYW1lID0gb2NoaWxkcy5vcHRpb25zW2ldLnRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpZCA9IG9jaGlsZHMub3B0aW9uc1tpXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYodGlkID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodG5hbWUgPT0gJyonKSB0bmFtZSA9ICcuLic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPT0gdGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9saXN0Lm9wdGlvbnNbeCsrXSA9IG5ldyBPcHRpb24odG5hbWUsIHRpZCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9saXN0Lm9wdGlvbnNbeCsrXSA9IG5ldyBPcHRpb24odG5hbWUsIHRpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgb2NoaWxkcy5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGlzdE5vZGVVUkxzKGZvcm0sIG9uYW1lKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBvc2VsZWN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IDA7CiAgICAgICAgICAgICAgICB2YXIgb3RleHQgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAob3NlbGVjdCA9IGZvcm1bb25hbWVdKSAmJiAoaW5kZXggPSBvc2VsZWN0LnNlbGVjdGVkSW5kZXgpID4gMCAKICAgICAgICAgICAgICAgICAgICAmJiAobm9kZWlkID0gb3NlbGVjdC5vcHRpb25zW2luZGV4XS52YWx1ZSkgPj0gMCAKICAgICAgICAgICAgICAgICAgICAmJiAob3RleHQgPSBvc2VsZWN0Lm9wdGlvbnNbaW5kZXhdLnRleHQpICE9ICcqJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihvbmFtZSA9PSAnY2hpbGRzJykgbW92ZUNoaWxkTm9kZXMoZm9ybSwgbm9kZWlkKTsKICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IGZvcm1bJ2xldmVsJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRVUkxMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExpc3RVUkxzKCdsaXN0Jywgbm9kZWlkLCBsZXZlbCwgMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld0NoaWxkc1VSTCh1cmxub2RlaWQsIGxldmVsLCBwYWdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYodXJsbm9kZWlkID49IDAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRVUkxMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dXJsbm9kZV9jaGlsZHMmdXJsbm9kZWlkPSIrdXJsbm9kZWlkKyImcGFnZT0iK3BhZ2U7CiAgICAgICAgICAgICAgICAgICAgaWYobGV2ZWwgPj0gMCkgYXJndiArPSAiJmxldmVsPSIrbGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgcGFnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBmdW5jdGlvbiBMaXN0VVJMcyh0eXBlLCBub2RlaWQsIGxldmVsLCBwYWdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYobm9kZWlkID49IDAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRVUkxMaXN0KCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZih0eXBlID09ICdsaXN0JykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9dXJsbm9kZV9saXN0Jm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD11cmxub2RlX2NoaWxkcyZ1cmxub2RlaWQ9Iitub2RlaWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZwYWdlPSIrcGFnZTsKICAgICAgICAgICAgICAgICAgICBpZihsZXZlbCA+PSAwKSBhcmd2ICs9ICImbGV2ZWw9IitsZXZlbDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd05vZGVVUkxzKHhtbEh0dHAucmVzcG9uc2VUZXh0LCBwYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld1JlY29yZHModHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbnJlY29yZHMgPSAwOwogICAgICAgICAgICAgICAgdmFyIHJlcyA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgcmVjb3JkcyA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgeCA9IDA7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgKHJlcyA9IGV2YWwodHh0KSkgIT0gbnVsbCAmJiAocmVjb3JkcyA9IHJlc1sncmVjb3JkcyddKSAKICAgICAgICAgICAgICAgICAgICAmJiAobnJlY29yZHMgPSByZXNbJ25yZWNvcmRzJ10pID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gIjxkaXYgaWQ9J3JlY29yZC1oZWFkZXInIG9ubW91c2Vkb3duPSciOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gImRpdm1vdmUoZXZlbnQsIHRoaXMpJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0nZGl2cmVtb3ZlKCI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+WDwvc3Bhbj4mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0nZGl2cmVtb3ZlKCI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+5YWz6ZetPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A757uT5p6cOiIrbnJlY29yZHMrIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPGRpdiBpZD0ncmVjb3JkLXJlcycgPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gcmVjb3JkcykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gY2xhc3M9J3JlY29yZC10aXRsZSc+IityZWNvcmRzW3hdWyduYW1lJ10rIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiA+IgogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjx0ZXh0YXJlYSBjb2xzPTkwIHJvd3M9NCA+IitiYXNlNjRzdHJkZWNvZGUocmVjb3Jkc1t4XVsnZGF0YSddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyI8L3RleHRhcmVhPjxicj4iOyAgICAKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYoKGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjb3JkLXZpZXcnKSkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBzdHI7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9ICdyZWNvcmQtdmlldyc7CiAgICAgICAgICAgICAgICAgICAgdmFyIGRpdndpZHRoID0gNzUwOwogICAgICAgICAgICAgICAgICAgIHZhciBvYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgeGxlZnQgPSBwYXJzZUludChvYm9keS5vZmZzZXRXaWR0aCkgLSBkaXZ3aWR0aDsKICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IG9ib2R5Lm9mZnNldExlZnQgKyh4bGVmdC8yKTsKICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IDIwICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0geCsncHgnOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0geSsncHgnOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBkaXZ3aWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3UmVjb3JkKHJlY29yZGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYocmVjb3JkaWQgPiAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXJlY29yZF92aWV3JnJlY29yZGlkPSIrcmVjb3JkaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdSZWNvcmRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLyogU2hvdyBOb2RlIFVSTHMgKi8KICAgICAgICAgICAgZnVuY3Rpb24gU2hvd05vZGVVUkxzKHR4dCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsYmxvY2tmb3JtJ107CiAgICAgICAgICAgICAgICB2YXIgdXJsbGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZm9ybSAmJiAodXJsbGlzdCA9IGV2YWwodHh0KSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFVSTExpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgdmFyIHVybGl0ZW0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSAtMTsKICAgICAgICAgICAgICAgICAgICB2YXIgdG5hbWUgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbmNoaWxkcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybG5vZGVpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmRpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBvY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsIHggPSAxOwogICAgICAgICAgICAgICAgICAgIGlmKChvY2hpbGRzID0gZm9ybVsnY2hpbGRzJ10pKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZWlkID0gdXJsbGlzdFsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaWQgPSB1cmxsaXN0WydwYXJlbnQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9ub2RlID0gZm9ybVsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQocGlkKyI6Iitub2RlaWQrIjoiK29ub2RlLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYob25vZGUub3B0aW9uc1tvbm9kZS5zZWxlY3RlZEluZGV4XS50ZXh0ID09ICcuLicgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBvbm9kZS5vcHRpb25zW29ub2RlLnNlbGVjdGVkSW5kZXhdLnZhbHVlICE9IG5vZGVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFBOb2Rlcyhub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLCB4ID0gMSwgeiA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIG9jaGlsZHMub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydudG5vZGVzJ10gPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwKW9jaGlsZHMub3B0aW9uc1t4KytdID0gbmV3IE9wdGlvbignKicsIG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xpc3RjaGlsZHMgPSBkb2N1bWVudC5mb3Jtc1sndXJsbGlzdC1hZGQtZm9ybSddWydub2RlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9saXN0Y2hpbGRzKSBvbGlzdGNoaWxkcy5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSBpbiB1cmxsaXN0Wyd0bm9kZXMnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlaWQgPSB1cmxsaXN0Wyd0bm9kZXMnXVtpXVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bmFtZSA9IHVybGxpc3RbJ3Rub2RlcyddW2ldWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmNoaWxkcyA9IHVybGxpc3RbJ3Rub2RlcyddW2ldWyduY2hpbGRzJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2NoaWxkcy5vcHRpb25zW3grK10gPSBuZXcgT3B0aW9uKHRuYW1lLCBub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9saXN0Y2hpbGRzKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpc3RjaGlsZHMub3B0aW9uc1t6KytdID0gbmV3IE9wdGlvbih0bmFtZSwgbm9kZWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICI8dWwgY2xhc3M9J3VybC11bCc+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IDAsIHRvID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgcGh0bWxzdHIgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgcHBpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAibGlzdCI7CiAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSBmb3JtWydsZXZlbCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIG5vZGVpZCA9IHVybGxpc3RbJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgIGZyb20gPSBwYXJzZUludChwYWdlKSAtIDEwOwogICAgICAgICAgICAgICAgICAgIGlmKGZyb20gPCAxKSBmcm9tID0gMTsKICAgICAgICAgICAgICAgICAgICB0byA9IGZyb20gKyAyMDsKICAgICAgICAgICAgICAgICAgICBpZih0byA+IHVybGxpc3RbJ3BhZ2VzJ10pIHRvID0gcGFyc2VJbnQodXJsbGlzdFsncGFnZXMnXSkgKyAxOwogICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8bGkgY2xhc3M9J3VybGxpLWhlYWRlcic+ICI7CiAgICAgICAgICAgICAgICAgICAgaWYodXJsbGlzdFsnaXNfY2hpbGRzJ10gPiAwKSB0eXBlID0gImNoaWxkcyI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB0eXBlID0gImxpc3QiOwogICAgICAgICAgICAgICAgICAgIGlmKChwcGlkID0gdXJsbGlzdFsncHBpZCddKSA+IDApIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIls8YSBocmVmPSdqYXZhc2NyaXB0OjsnIGNsYXNzPSdlYWRkJyBvbmNsaWNrPVwiTGlzdFVSTHMoJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICt0eXBlKyInLCIrcHBpZCsiLCAiK2xldmVsKyIsIDEpO1wiPuS4iuS4gOWxgjwvYT5dJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIlVSTOaAu+aVsO+8miIrdXJsbGlzdFsndG90YWwnXTsKICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydwYWdlcyddID4gMSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICIg5YWxIit1cmxsaXN0WydwYWdlcyddKyLpobUiOwogICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZnJvbSA+IDIwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiPGEgY2xhc3M9J3VybC1saS1wYWdlJyBocmVmPSdqYXZhc2NyaXB0OjsnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiIG9uY2xpY2s9XCJMaXN0VVJMcygnIit0eXBlKyInLCAiK25vZGVpZCsiLCciCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK2xldmVsKyInLCcxJyk7XCI+MTwvYT4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOy4uLiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSBmcm9tOyBpIDwgdG87IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpID09IHBhZ2UpIHBodG1sc3RyICs9IGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8YSBjbGFzcz0ndXJsLWxpLXBhZ2UnIGhyZWY9J2phdmFzY3JpcHQ6OycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAib25jbGljaz1cIkxpc3RVUkxzKCciK3R5cGUrIicsICIrbm9kZWlkKyIsJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK2xldmVsKyInLCciK2krIicpO1wiPiIraSsiPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodG8gPCAodXJsbGlzdFsncGFnZXMnXSAtIDIwKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHVybGxpc3RbJ3BhZ2VzJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Li4uJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8YSBjbGFzcz0ndXJsLWxpLXBhZ2UnIGhyZWY9J2phdmFzY3JpcHQ6OycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICJvbmNsaWNrPVwiTGlzdFVSTHMoJyIrdHlwZSsiJywgIitub2RlaWQgKyIsJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbGV2ZWwrIicsJyIraSsiJyk7XCI+IitpKyI8L2E+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIGlmKHBodG1sc3RyICE9ICIiKWh0bWxzdHIgKz0gcGh0bWxzdHIgKyAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChwaHRtbHN0cik7CiAgICAgICAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gdXJsbGlzdFsndXJsbm9kZXMnXSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsaXRlbSA9IHVybGxpc3RbJ3VybG5vZGVzJ11beF07CiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVpZCA9IHVybGl0ZW1bJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgICAgICB1cmxpZCA9IHVybGl0ZW1bJ3VybGlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsID0gdXJsaXRlbVsnbGV2ZWwnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsbm9kZWlkID0gdXJsaXRlbVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkaWQgPSB1cmxpdGVtWydyZWNvcmRpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBuY2hpbGRzID0gdXJsaXRlbVsnbmNoaWxkcyddOwogICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmxpdGVtWyd1cmwnXTsKICAgICAgICAgICAgICAgICAgICAgICAgY3NzID0gJ3VybC1saSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybGl0ZW1bJ3N0YXR1cyddIDwgMCkgY3NzID0gJ3VybC1saS13YXJuJzsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSciK2NzcysiJyBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsJyIrY3NzKyInKVwiICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICd1cmwtbGktc2VsZWN0ZWQnKVwiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IGkrIjombmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8YSB0YXJnZXQ9J19ibGFuaycgaHJlZj0nIit1cmwrIic+Iit1cmwrIjwvYT4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihuY2hpbGRzID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiWzxzcGFuIGNsYXNzPSdldmlldycgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9uY2xpY2s9XCJWaWV3Q2hpbGRzVVJMKCIrdXJsbm9kZWlkKyIsMCwxKVwiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IG5jaGlsZHMrIjwvc3Bhbj5dIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c2VsZWN0IG5hbWU9J2xldmVsJyBvbmNoYW5nZT1cIlVwZGF0ZU5vZGVVUkwoIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBub2RlaWQrIiwiK3VybG5vZGVpZCsiLCAiK3VybGlkKyIsIHRoaXMsICIrcGFnZSsiKVwiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7kvJjlhYjnuqc8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8b3B0aW9uIHZhbHVlPScwJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihsZXZlbCA9PSAwKSBodG1sc3RyICs9ICJzZWxlY3RlZD10cnVlIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPuaZrumAmjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxvcHRpb24gdmFsdWU9JzEnIjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobGV2ZWwgPT0gMSkgaHRtbHN0ciArPSAic2VsZWN0ZWQ9dHJ1ZSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIj7ntKfmgKU8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NlbGVjdD4iOwogICAgICAgICAgICAgICAgICAgICAgICBpZihyZWNvcmRpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXZpZXcnIHRpdGxlPSdWaWV3JyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIlZpZXdSZWNvcmQoIityZWNvcmRpZCsiKVwiPuKYnCA8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydudG5vZGVzJ10gPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VhZGQnIHRpdGxlPSdBZGQnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiWEFkZE5vZGVVUkwoZXZlbnQsICIrdXJsbm9kZWlkKyIpXCI+4pyaPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEZWxldGVOb2RlVVJMKCIrbm9kZWlkKyIsICIrdXJsbm9kZWlkKyIsIit1cmxpZCsiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiciK3VybCsiJywnIitwYWdlKyInKVwiPuKcmDwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3RbJ3BhZ2VzJ10gPiAxKSBodG1sc3RyICs9ICI8aHI+IjsKICAgICAgICAgICAgICAgICAgICBpZihwaHRtbHN0ciAhPSAiIilodG1sc3RyICs9IHBodG1sc3RyOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYoZGl2KSBkaXYuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEhpZGRlblVSTExpc3RGb3JtKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmxsaXN0LWZvcm0nKTsKICAgICAgICAgICAgICAgIGlmKGRpdikgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQWRkTm9kZVVSTChmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgcGFyZW50aWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG5vZGVpZCA9IGZvcm1bJ25vZGVpZCddLnZhbHVlKSA+IDAgCiAgICAgICAgICAgICAgICAgICAgJiYgKHVybCA9IGZvcm1bJ3VybCddLnZhbHVlKQogICAgICAgICAgICAgICAgICAgICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXVybG5vZGVfYWRkJm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJnVybD0iK2VuY29kZVVSSUNvbXBvbmVudCh1cmwpOwogICAgICAgICAgICAgICAgICAgIGlmKChwYXJlbnRpZCA9IGZvcm1bJ3BhcmVudGlkJ10udmFsdWUpID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZwYXJlbnRpZD0iK3BhcmVudGlkOwogICAgICAgICAgICAgICAgICAgIGlmKChsZXZlbCA9IGZvcm1bJ2xldmVsJ10udmFsdWUpID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZsZXZlbD0iK2xldmVsOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5VUkxMaXN0Rm9ybSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWEFkZE5vZGVVUkwoZSwgcGFyZW50aWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVybGxpc3QtZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ1cmxsaXN0LWFkZC1mb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydwYXJlbnRpZCddLnZhbHVlID0gcGFyZW50aWQ7CiAgICAgICAgICAgICAgICBmb3JtWyd1cmwnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsndXJsJ10udmFsdWUgPSAnaHR0cDovLyc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIFVwZGF0ZU5vZGVVUkwobm9kZWlkLCB1cmxub2RlaWQsIHVybGlkLCBvc2VsZWN0LCBwYWdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKG9zZWxlY3QpID8gb3NlbGVjdC5zZWxlY3RlZEluZGV4IDogMDsKICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IChpbmRleCA+PSAwKSA/IG9zZWxlY3Qub3B0aW9uc1tpbmRleF0udmFsdWUgOiAtMTsKICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gKGluZGV4ID49IDApPyBvc2VsZWN0Lm9wdGlvbnNbaW5kZXhdLnRleHQgOiAiIjsKICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgdXJsbm9kZWlkID4gMCAmJiBsZXZlbCA+PSAwCiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgi5oKo56Gu6K6k5L+u5pS55LyY5YWI57qn5Li6WyIrdGV4dCsiXT8iKQogICAgICAgICAgICAgICAgICAgICYmKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dXJsbm9kZV91cGRhdGUmbm9kZWlkPSIrbm9kZWlkKyImdXJsbm9kZWlkPSIgCiAgICAgICAgICAgICAgICAgICAgICAgICt1cmxub2RlaWQrIiZ1cmxpZD0iK3VybGlkKyImbGV2ZWw9IitsZXZlbDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd05vZGVVUkxzKHhtbEh0dHAucmVzcG9uc2VUZXh0LCBwYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEZWxldGVOb2RlVVJMKG5vZGVpZCwgdXJsbm9kZWlkLCB1cmxpZCwgdXJsLCBwYWdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCAmJiB1cmxub2RlaWQgPiAwIAogICAgICAgICAgICAgICAgICAgICYmIGNvbmZpcm0oIuaCqOehruiupOWIoOmZpFVSTFsiK3VybCsiXSA/IikKICAgICAgICAgICAgICAgICAgICAmJih4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dXJsbm9kZV9kZWxldGUmbm9kZWlkPSIrbm9kZWlkKyImdXJsbm9kZWlkPSIKICAgICAgICAgICAgICAgICAgICArdXJsbm9kZWlkKyImdXJsaWQ9Iit1cmxpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd05vZGVVUkxzKHhtbEh0dHAucmVzcG9uc2VUZXh0LCBwYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgUmVzZXREaXYoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldEROU0xpc3QoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWydkbnMtYWRkLWZvcm0nXTsKICAgICAgICAgICAgICAgIGlmKGZvcm0pCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsnaG9zdCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsnaG9zdCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gU2hvd0ROUyh0eHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG5zLWxpc3QnKTsKICAgICAgICAgICAgICAgIHZhciBvYmpkbnNsaXN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBkbnNsaXN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiBkaXYgJiYgKG9iamRuc2xpc3QgPSBldmFsKHR4dCkpICE9IG51bGwgCiAgICAgICAgICAgICAgICAgICAgJiYgKGRuc2xpc3QgPSBvYmpkbnNsaXN0WydkbnNsaXN0J10pKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0RE5TTGlzdCgpOyAKICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdGlkID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzdHIgPSAiPHVsIGNsYXNzPSdkbnMtdWwnPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZG5zbGlzdCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RpZCA9IGRuc2xpc3RbeF1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSAgZG5zbGlzdFt4XVsnaG9zdCddOwogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBkbnNsaXN0W3hdWydzdGF0dXMnXTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdkbnMtbGknIG9ubW91c2VvdXQ9XCJvdXREaXYodGhpcywgJ2Rucy1saScpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ2Rucy1saS1zZWxlY3RlZCcpXCIgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gaG9zdDsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3RhdHVzID4gMCkgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3N0YXR1c19lcnInPuacieaViDwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nc3RhdHVzX29rJz7lpLHmlYg8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEZWxldGVETlMoIitob3N0aWQrIiwgJyIraG9zdCsiJylcIj7inJg8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3VsPiI7CiAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IGh0bWxzdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGRETlMoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGhvc3QgPSAiIjsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChob3N0ID0gZm9ybVsnaG9zdCddLnZhbHVlKSAKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1kbnNfYWRkJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dETlMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERlbGV0ZUROUyhob3N0aWQsIGhvc3QpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihob3N0aWQgPj0gMCAmJiBob3N0CiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgi5oKo56Gu6K6k5Yig6ZmkRE5TWyIraG9zdCsiXSA/IikKICAgICAgICAgICAgICAgICAgICAmJih4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPWRuc19kZWxldGUmaG9zdGlkPSIraG9zdGlkKyImaG9zdD0iK2hvc3Q7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dETlMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RETlMoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZG5zX2xpc3QiOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93RE5TKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldFByb3h5TGlzdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb3h5LWFkZC1mb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFNob3dQcm94eSh0eHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJveHktbGlzdCcpOwogICAgICAgICAgICAgICAgdmFyIHByb3h5bGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZGl2ICYmIChwcm94eWxpc3QgPSBldmFsKHR4dCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRQcm94eUxpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0ncHJveHktdWwnPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gcHJveHlsaXN0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaG9zdGlkID0gcHJveHlsaXN0W3hdWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gIHByb3h5bGlzdFt4XVsnaG9zdCddOwogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBwcm94eWxpc3RbeF1bJ3N0YXR1cyddOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8bGkgY2xhc3M9J3Byb3h5LWxpJyBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsICdwcm94eS1saScpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ3Byb3h5LWxpLXNlbGVjdGVkJylcIiA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBob3N0OwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihzdGF0dXMgPiAwKSBodG1sc3RyICs9ICLmnInmlYgiOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlICBodG1sc3RyICs9ICLlrp7mlYgiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZVByb3h5KCIraG9zdGlkKyIsICciK2hvc3QrIicpXCI+4pyYPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEFkZFByb3h5KGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBob3N0ID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoZm9ybSA9PSBudWxsIHx8IChob3N0PWZvcm1bJ2hvc3QnXS52YWx1ZSkgPT0gIiIgfHwgaG9zdC5pbmRleE9mKCc6JykgPD0gMCkgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+S7o+eQhuacjeWKoeWZqOagvOW8j+S4ujoyMDIuMTA2LjAuMjA6ODg4OCcpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGhvc3QgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cHJveHlfYWRkJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dQcm94eSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlUHJveHkoaG9zdGlkLCBob3N0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoaG9zdGlkID49IDAgJiYgaG9zdAogICAgICAgICAgICAgICAgICAgICYmIGNvbmZpcm0oIuaCqOehruiupOWIoOmZpOS7o+eQhlsiK2hvc3QrIl0gPyIpCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cHJveHlfZGVsZXRlJmhvc3RpZD0iK2hvc3RpZCsiJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93UHJveHkoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RQcm94eSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1wcm94eV9saXN0IjsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Byb3h5KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgIDwvc2NyaXB0PgogICAgPC9oZWFkPgogICAgPCEtLSA8Ym9keSBvbmxvYWQ9J2phdmFzY3JpcHQ6bG9hZEluaXQoKTsnPiAtLT4KICAgIDxib2R5IG9ubG9hZD0namF2YXNjcmlwdDpsb2FkVGFza0luZm8oKTsnPgogIDxkaXYgaWQ9J21haW5mcmFtZSc+CiAgICA8ZGl2IGlkPSdpdGFiJz4KICAgICAgICA8dWw+CiAgICAgICAgPGxpIGNsYXNzPSd0YWItc2VsZWN0ZWQnIGlkPSd0YWIwJyBvbmNsaWNrPSJzZWxlY3RWaWV3KCd0YXNraW5mbycsZXZlbnQpIiA+5LiL6L295Lu75YqhPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjEnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ2RhdGFiYXNlJyxldmVudCkiID7mlbDmja7lupPphY3nva48L2xpPgogICAgICAgIDxsaSBpZD0ndGFiMicgb25jbGljaz0ic2VsZWN0VmlldygndGVtcGxhdGUnLCBldmVudCkiID7mqKHniYjphY3nva48L2xpPgogICAgICAgIDxsaSBpZD0ndGFiMycgb25jbGljaz0ic2VsZWN0VmlldygndXJsYmxvY2snLCBldmVudCkiID5VUkznrqHnkIY8L2xpPgogICAgICAgIDxsaSBpZD0ndGFiNCcgb25jbGljaz0ic2VsZWN0VmlldygnZGF0YScsIGV2ZW50KSIgPuaVsOaNrueuoeeQhjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWI1JyBvbmNsaWNrPSJzZWxlY3RWaWV3KCdkbnMnLCBldmVudCkiID5ETlPnrqHnkIY8L2xpPgogICAgICAgIDxsaSBpZD0ndGFiNicgb25jbGljaz0ic2VsZWN0VmlldygncHJveHknLCBldmVudCkiID7ku6PnkIborr7nva48L2xpPgogICAgICAgIDxsaSBpZD0ndGFiNycgb25jbGljaz0ic2VsZWN0VmlldygndXNlcicsIGV2ZW50KSIgPueUqOaIt+euoeeQhjwvbGk+CiAgICAgICAgPC91bD4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0ndGFza2luZm8nPjwvZGl2PgogICAgPGRpdiBpZD0nZGF0YWJhc2UnPgogICAgICAgIDx0YWJsZSB3aWR0aD0xMDAlIGhlaWdodD0xMDAlIGNlbGxzcGFjaW5nPTAgYm9yZGVyPTAgdmFsaWduPXRvcCBhbGlnbj1sZWZ0ID4KICAgICAgICA8dHI+CiAgICAgICAgPHRkIGNsYXNzPSdkYmxpc3QnIHZhbGlnbj10b3Agd2lkdGg9MjAlIGhlaWdodD0xMDAlID4KICAgICAgICAgICAgPHRhYmxlIGNlbGxzcGFjaW5nPTAgYm9yZGVyPTAgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IHdpZHRoPTEwMCUgPgogICAgICAgICAgICA8dHI+CiAgICAgICAgICAgICAgICA8dGQgdmFsaWduPXRvcCBjbGFzcz0nZGJ0aXRsZScgd2lkdGg9MTAwJSA+CiAgICAgICAgICAgICAgICDngrnlh7s8c3BhbiBjbGFzcz0nZWFkZCcgdGl0bGU9J0FkZCcgb25jbGljaz0nREJYQWRkKGV2ZW50KSc+4pyaPC9zcGFuPua3u+WKoOaVsOaNruihqDwvZGl2PgogICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgPHRkIHZhbGlnbj10b3Agd2lkdGg9MTAwJSA+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nZGJzZWxlY3QnPjwvZGl2PgogICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPC90YWJsZT4KICAgICAgICA8L3RkPgogICAgICAgIDx0ZCB2YWxpZ249dG9wIGFsaWduPWxlZnQgY2xhc3M9J2RiZmllbGRzJyBjZWxsc3BhY2luZz0wIGJvcmRlcj0wID4KICAgICAgICAgICAgPGRpdiBpZD0nZGJmaWVsZHMnPjwvZGl2PgogICAgICAgIDwvdGQ+CiAgICAgICAgPC90cj4KICAgICAgICA8L3RhYmxlPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd0ZW1wbGF0ZSc+CiAgICA8dGFibGUgY2VsbHNwYWNpbmc9MCBib3JkZXI9MCB2YWxpZ249dG9wIGFsaWduPWxlZnQgaGVpZ2h0PTEwMCUgY2xhc3M9J3RlbXBsYXRlLXRhYicgPgogICAgICAgIDx0cj4KICAgICAgICA8dGQgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IGhlaWdodD0xMDAlIHdpZHRoPTMwMHB4IGNsYXNzPSd0cmVldGFiJz4KICAgICAgICAgICAgPGRpdiBpZD0ndHJlZS10aXRsZSc+5oqT5Y+W5qCR55So5LqO5oyH5a+854is6Jmr55qE54is5Y+W6Lev5b6EPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9J3RyZWVib2R5JyBsZXZlbD0nMCc+PC9kaXY+CiAgICAgICAgPC90ZD4KICAgICAgICA8dGQgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IGhlaWdodD0xMDAlID4KICAgICAgICAgICAgICA8ZGl2IGlkPSd0ZW1wbGF0ZS10aXRsZSc+5qih54mI55So5LqO5oq95Y+W6Ieq5bex6ZyA6KaB55qE5pWw5o2uPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBpZD0nbm9kZS10ZW1wbGF0ZSc+PC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBpZD0neHRlbXBsYXRlZm9ybSc+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPXVybGZvcm0gPgogICAgICAgICAgICAgICAgPGZvcm0gYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCk7JyBuYW1lPSd1cmxmb3JtJyBvbnN1Ym1pdD0ncmV0dXJuIExvYWRVUkwodGhpcyk7Jz4KICAgICAgICAgICAgICAgIFVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9JzY0JyBuYW1lPSd1cmwnPgogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdtZXRob2QnIHZhbHVlPScwJyBjaGVja2VkPkdFVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdtZXRob2QnIHZhbHVlPScxJz5QT1NUCiAgICAgICAgICAgICAgICAmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nTG9hZCc+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9J3NvdXJjZV9jb2RlX29wJz4KICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nc291cmNlX3ZpZXcnPjwvZGl2PgogICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdzb3VyY2Vfb3AnPjwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSd0ZW1wbGF0ZWRpdic+CiAgICAgICAgICAgICAgICA8Zm9ybSBuYW1lPSJ0ZW1wbGF0ZWZvcm0iIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0ZW1wbGF0ZV9hZGQnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdub2RlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RlbXBsYXRlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZsYWcnIHZhbHVlPScwJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbmZpZWxkcycgdmFsdWU9Jy0xJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbWFwJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbGlua21hcCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3VybCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21ldGhvZCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAg5Luj56CBOjx0ZXh0YXJlYSBuYW1lPSdjb2RlJyByb3dzPTggIGNvbHM9MTIwPjwvdGV4dGFyZWE+IAogICAgICAgICAgICAgICAgPGJyPgogICAgICAgICAgICAgICAg5qih54mIOjx0ZXh0YXJlYSBuYW1lPSdwYXR0ZXJuJyByb3dzPTQgIGNvbHM9MTIwPjwvdGV4dGFyZWE+CiAgICAgICAgICAgICAgICA8YnI+CiAgICAgICAgICAgICAgICA8c3BhbiBhbGlnbj1jZW50ZXI+CiAgICAgICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX3B1YmxpYycgPuWFrOWFseWtl+autQogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19nbG9iYWwnID7ph43lpI3ljLnphY3lpJrmnaEKICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfaWdub3JlY2FzZScgPuW/veeVpeWkp+Wwj+WGmQogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xpbmtfdGFibGUnIG9uY2hhbmdlPSJjaGFuZ2VUYWJsZSh0aGlzLmZvcm0sICdsaW5rX2ZpZWxkJywgdGhpcykiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7mlbDmja7ooag8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nVGVzdCBUZW1wbGF0ZScgb25jbGljaz0iVGVzdFRlbXBsYXRlKHRoaXMuZm9ybSkiPgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nQ29uZmlnIFRlbXBsYXRlJyBvbmNsaWNrPSJDb25maWdUZW1wbGF0ZSh0aGlzLmZvcm0pIj4KICAgICAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RlbXBsYXRlLWJhcic+55So5LqO5ou85o6l6ZqQ6JeP55qE6ZO+5o6l5ZKMQWpheOWGheWuueWdl+WcsOWdgDwvZGl2PgogICAgICAgICAgICAgICAgVVJM6KeE5YiZOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0nbGluaycgdmFsdWU9Jycgc2l6ZT00OD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2J1dHRvbicgdmFsdWU9J1Rlc3QgVGVtcGxhdGUgJiBMaW5rJyBvbmNsaWNrPSJUZXN0VGVtcGxhdGUodGhpcy5mb3JtKSI+CiAgICAgICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPSdTdWJtaXQgTGluaycgb25jbGljaz0iRWRpdExpbmsodGhpcy5mb3JtKTsiPgogICAgICAgICAgICAgICAgPGJyPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT0nbGlua19tZXRob2QnIHZhbHVlPScwJyBjaGVja2VkPkdFVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdsaW5rX21ldGhvZCcgdmFsdWU9JzEnPlBPU1QKICAgICAgICAgICAgICAgICZuYnNwOwogICAgICAgICAgICAgICAgPHNwYW4gdGl0bGU9J+WIl+ihqOmhteS8muWumuacn+abtOaWsCc+PGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0nbGlua19saXN0JyA+5YiX6KGo6aG1PC9zcGFuPgogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xpbmtfZmllbGQnID4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5a2X5q61PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdsaW5rX25vZGUnID4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5a2Q6IqC54K5PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZm9ybT4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3RkPgogICAgICAgIDwvdHI+CiAgICAgICA8L3RhYmxlPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1cmxibG9jayc+CiAgICA8ZGl2IGlkPSd1cmwtaGVhZGVyJz4KICAgIDxmb3JtIG5hbWU9J3VybGJsb2NrZm9ybScgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgCiAgICAgICAgICAgIG9uc3VibWl0PSdyZXR1cm4gQWRkTm9kZVVSTCh0aGlzKScgPgogICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJ3ZhbHVlPSd1cmxfYWRkJyA+CiAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ncGFyZW50aWQndmFsdWU9JzAnID4KICAgIDxzZWxlY3QgbmFtZT0nbm9kZWlkJyBvbmNoYW5nZT0nTGlzdE5vZGVVUkxzKHRoaXMuZm9ybSwgIm5vZGVpZCIpJz4KICAgIDxvcHRpb24gdmFsdWU9Jy0xJz7pgInmi6noioLngrk8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9JzAnIHNlbGVjdGVkPlJvb3Q8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8c2VsZWN0IG5hbWU9J2NoaWxkcycgb25jaGFuZ2U9J0xpc3ROb2RlVVJMcyh0aGlzLmZvcm0sICJjaGlsZHMiKSc+CiAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+6YCJ5oup5a2Q6IqC54K5PC9vcHRpb24+CiAgICA8L3NlbGVjdD4KICAgICZuYnNwOyZuYnNwOwogICAgPHNlbGVjdCBuYW1lPSdtZXRob2QnPgogICAgPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuivt+axguaWueazlTwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0nMCcgPkdFVDwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0nMScgPlBPU1Q8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8c2VsZWN0IG5hbWU9J2xldmVsJyA+CiAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5LyY5YWI57qnPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScwJyA+5pmu6YCaPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScxJyA+57Sn5oClPC9vcHRpb24+CiAgICA8L3NlbGVjdD4KICAgICZuYnNwOyZuYnNwOwogICAgPGlucHV0IHR5cGU9dGV4dCBuYW1lPXVybCBzaXplPTQ4IHZhbHVlPSdodHRwOi8vJyA+CiAgICAmbmJzcDsmbmJzcDsKICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdBZGQnPgogICAgPC9mb3JtPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1cmwtbGlzdCc+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J2RhdGEnPjwvZGl2PgogICAgPGRpdiBpZD0nZG5zJz4KICAgIDxkaXYgaWQ9J2Rucy1oZWFkZXInPgogICAgPGZvcm0gbmFtZT0nZG5zLWFkZC1mb3JtJyBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyAKICAgICAgICAgICAgb25zdWJtaXQ9J3JldHVybiBBZGRETlModGhpcyknPgogICAg5re75YqgRE5TOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0naG9zdCcgc2l6ZT00OCB2YWx1ZT0nJyA+CiAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJz4KICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZG5zLWxpc3QnPjwvZGl2PgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSdwcm94eSc+CiAgICA8ZGl2IGlkPSdwcm94eS1oZWFkZXInPgogICAgPGZvcm0gbmFtZT0ncHJveHktYWRkLWZvcm0nIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyBvbnN1Ym1pdD0ncmV0dXJuIEFkZFByb3h5KHRoaXMpJz4KICAgIOa3u+WKoOS7o+eQhjo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9J2hvc3QnIHNpemU9NDggdmFsdWU9JycgPgogICAgPGlucHV0IHR5cGU9c3VibWl0IHZhbHVlPSdvayc+CiAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3Byb3h5LWxpc3QnPjwvZGl2PgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1c2VyJz4KICAgIDwvZGl2Pgo8L2Rpdj4KICAgIDxkaXYgaWQ9J3R4dGZvcm0nPgogICAgICAgIDxmb3JtIG5hbWU9ImVkaXRvcmZvcm0iIGNsYXNzPSdsaXN0Zm9ybScgYWN0aW9uPSJqYXZhc2NyaXB0OnZvaWQoMCkiIAogICAgICAgICAgICBvbnN1Ym1pdD0icmV0dXJuIEVkaXROb2RlKHRoaXMpOyI+IAogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSIgPuWFs+mXrTwvc3Bhbj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0nbm9kZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25vZGVpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3BpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9J3RleHQnIG5hbWU9J25vZGVuYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nb2snIGNsYXNzPSdzdWJtaXQnID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIj54PC9zcGFuPgogICAgICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZGJmb3JtJz4KICAgICAgICA8Zm9ybSBuYW1lPSJ4ZGJmb3JtIiBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiAKICAgICAgICAgICAgb25zdWJtaXQ9InJldHVybiBFZGl0REIodGhpcyk7Ij4gCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIiA+5YWz6ZetPC9zcGFuPgogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0YWJsZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPScwJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSduYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nb2snIGNsYXNzPSdzdWJtaXQnID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIj54PC9zcGFuPgogICAgICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZGJmaWVsZGZvcm0nPgogICAgICAgIDxmb3JtIG5hbWU9ImRiZmllbGRmb3JtIiBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiAKICAgICAgICAgICAgb25zdWJtaXQ9InJldHVybiBFZGl0RmllbGQodGhpcyk7Ij4gCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIiA+5YWz6ZetPC9zcGFuPgogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0YWJsZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZpZWxkaWQnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29sZG5hbWUnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3R5cGUnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZsYWcnIHZhbHVlPScnID4KICAgICAgICAgICAg5a2X5q615ZCNOjxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSduYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICDnsbvlnos6PHNlbGVjdCBuYW1lPSdmdHlwZScgPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMSc+SU5UPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScyJz5Eb3VibGU8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzQnIHNlbGVjdGVkPlRleHQ8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzgnPkJsb2I8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19pbmRleCcgdmFsdWU9MSA+5piv5ZCm57Si5byVCiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX251bGwnIHZhbHVlPTQgPuaYr+WQpuS4uuepugogICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJyBjbGFzcz0nc3VibWl0JyA+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSI+eDwvc3Bhbj4KICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3VybGxpc3QtZm9ybSc+CiAgICAgICAgPGZvcm0gbmFtZT0idXJsbGlzdC1hZGQtZm9ybSIgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249ImphdmFzY3JpcHQ6dm9pZCgwKSIgCiAgICAgICAgICAgIG9uc3VibWl0PSJyZXR1cm4gQWRkTm9kZVVSTCh0aGlzKTsiPiAKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NldHh0JyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiID7lhbPpl608L3NwYW4+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd1cmxfYWRkJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdwYXJlbnRpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdtZXRob2QnPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuivt+axguaWueazlTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMCcgPkdFVDwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMScgPlBPU1Q8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xldmVsJyA+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5LyY5YWI57qnPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScwJyA+5pmu6YCaPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScxJyA+57Sn5oClPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdub2RlaWQnID4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7pgInmi6nlrZDoioLngrk8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiPng8L3NwYW4+CiAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIFVSTDo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9dXJsIHNpemU9NDggdmFsdWU9J2h0dHA6Ly8nID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdBZGQnPjxicj4KICAgICAgICAgICAgPGhyPgogICAgICAgICAgICBodHRwOi8vYWJjLmNvbS9saXN0L1sxLTQ4NzZdLmh0bWwgJm5ic3A7Jm5ic3A7aHR0cDovL2FiYy5jb20vMDBsaXN0L1sxLTQ4NzZdezJ9Lmh0bWw8YnI+CiAgICAgICAgICAgIGh0dHA6Ly9hYmMuY29tL2FiY2xpc3QvW2Etel0uaHRtbCAmbmJzcDsmbmJzcDtodHRwOi8vYWJjLmNvbS9hYWFsaXN0L1thLXpdezN9Lmh0bWwKICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KCiAgICA8L2JvZHk+CjwvaHRtbD4K";
#endif
