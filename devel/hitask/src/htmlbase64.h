#ifndef _BASE64_HTML_H
#define _BASE64_HTML_H
static const char *html_code_base64 = "PGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPgogICAgPGhlYWQ+CiAgICA8dGl0bGU+SGl0YXNrIE1vbml0b3I8L3RpdGxlPgogICAgPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9VVRGLTgiPgogICAgPHN0eWxlPgogICAgICAgIGJvZHkuSUVfTTcsIGJvZHkuSUVfTTgsIGJvZHkuV2luNntmb250LWZhbWlseToiU2Vnb2UgVUkiLCBUYWhvbWEsIFZlcmRhbmEsIEFyaWFsO30KICAgICAgICBib2R5LlNhZmFyaXttaW4td2lkdGg6OTg3cHg7fQogICAgICAgIGJvZHkuU0ZfaVBob25ley13ZWJraXQtdGV4dC1zaXplLWFkanVzdDpub25lO30KICAgICAgICBib2R5CiAgICAgICAgewogICAgICAgICAgICBtYXJnaW46MDtmb250LWZhbWlseTpUYWhvbWEsIFZlcmRhbmEsIEFyaWFsOwogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7CiAgICAgICAgICAgIGNvbG9yOiMzMzM7CiAgICAgICAgICAgIGZvbnQtc2l6ZToxMnB0OwogICAgICAgICAgICB3aWR0aDoxMDAlOwogICAgICAgICAgICBoZWlnaHQ6MTAwJTsKICAgICAgICB9CiAgICAgICAgICAgICNtYWluZnJhbWUKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7CiAgICAgICAgICAgICAgICB6LWluZGV4OjA7CiAgICAgICAgICAgICAgICB3aWR0aDoxMDAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OjEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2l0YWIge3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjttYXJnaW46MDtwYWRkaW5nOjA7CiAgICAgICAgICAgICAgICBoZWlnaHQ6NDBweDsgd2lkdGg6MTAwJTt0b3A6MHB4O2xlZnQ6MHB4O2ZvbnQtc2l6ZToxNnB0O2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgI2l0YWIgdWx7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgI2l0YWIgbGl7ZmxvYXQ6bGVmdDtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDt3aWR0aDoxNDBweDsgaGVpZ2h0OjQwcHg7CiAgICAgICAgICAgICAgICBib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNjY2M7Zm9udC13ZWlnaHQ6Ym9sZGVyO3BhZGRpbmc6M3B4IDhweCAzcHggOHB4O30KICAgICAgICAgICAgI2l0YWIgLnRhYi1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y29sb3I6IzJGNUZBMTtib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNjY2M7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDpib2xkZXI7cGFkZGluZzozcHggOHB4IDNweCA4cHg7fQogICAgICAgICAgICAjdGFza2luZm97cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OyBjb2xvcjojMkY1RkExO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNzsgcGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC5rdGFza3tmb250LXNpemU6MTJwdDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgLnZ0YXNre2ZvbnQtc2l6ZToxMnB0O2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAjZGF0YWJhc2V7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTtvdmVyZmxvdzphdXRvOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAuZGJsaXN0e3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6MHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAuZGJ0aXRsZXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDsgaGVpZ2h0OjMwcHg7fQogICAgICAgICAgICAjZGJzZWxlY3R7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2NvbG9yOiMyRjVGQTE7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICNkYmZpZWxkcyAuZGJmaWVsZHN7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAuZmllbGQtdGl0bGV7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjMGMwYzA7aGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC51bHRhYntsaXN0LXN0eWxlOm5vbmU7cGFkZGluZzowO21hcmdpbjowO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubHRhYm5hbWV7Y3Vyc29yOnBvaW50ZXI7Zm9udC1zaXplOjEycHQ7fQogICAgICAgICAgICAubHRhYntiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubHRhYi1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7Y3Vyc29yOiBwb2ludGVyO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAubGZuYW1le2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5sZmllbGR7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5sZmllbGQtc2VsZWN0ZWR7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgICNkYmZpZWxkZm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDo3MjBweDtoZWlnaHQ6NTBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZy10b3A6MTBweDtwYWRkaW5nLWxlZnQ6NnB4O2ZvbnQtc2l6ZToxMnB0OwogICAgICAgICAgICAgICAgY29sb3I6IzJGNUZBMTt6LWluZGV4Ojk5O292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI3RlbXBsYXRle3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtkaXNwbGF5Om5vbmU7b3ZlcmZsb3c6YXV0bzsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLnRlbXBsYXRlLXRhYntoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLnRyZWV0YWJ7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2hlaWdodDoxMDAlO21hcmdpbjphdXRvO3otaW5kZXg6OTk7b3ZlcmZsb3c6YXV0bzt9CiAgICAgICAgICAgICN0cmVlLXRpdGxle2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojYzBjMGMwO2ZvbnQtc2l6ZToxM3B0OwogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6Ym9sZDtoZWlnaHQ6MzBweDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgI3RyZWVib2R5e3Bvc2l0aW9uOnJlbGF0aXZlO2NvbG9yOiMwMDAwMDA7d2lkdGg6MTAwJTtvdmVyZmxvdzphdXRvfQogICAgICAgICAgICAudHJlZWxpbmV7cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweDtmb250LXNpemU6MTJwdDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgLnRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmJ0aXRsZXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNjMGMwYzA7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS10aXRsZXtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDtmb250LXNpemU6MTNwdDsKICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7aGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICNub2RlLXRlbXBsYXRle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgI2ZmZmZmZjtwYWRkaW5nOjBweDtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgLnRlbXBsYXRlLWhlYWRlcntiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7fQogICAgICAgICAgICAubHRlbXBsYXRle2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzt9CiAgICAgICAgICAgIC5sdGVtcGxhdGUtaGx7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO30KICAgICAgICAgICAgI3R4dGZvcm17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MzUwcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MTBweDt6LWluZGV4Ojk5O292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI2RiZm9ybXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDozODBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzoxMHB4O3otaW5kZXg6OTk7b3ZlcmZsb3c6YXV0bztkaXNwbGF5Om5vbmU7fQogICAgICAgICAgICAjeHRlbXBsYXRlZm9ybXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7ZGlzcGxheTpub25lO3dpZHRoOjEwMCU7CiAgICAgICAgICAgICAgICBib3JkZXI6MHB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzowcHg7Zm9udC1zaXplOjEycHQ7Y29sb3I6IzJGNUZBMTt9CiAgICAgICAgICAgICN1cmxmb3Jte3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzt9CiAgICAgICAgICAgICNzb3VyY2VfY29kZV9vcHtkaXNwbGF5Om5vbmU7fQogICAgICAgICAgICAjdGVtcGxhdGVkaXZ7ZGlzcGxheTpub25lO3Bvc2l0aW9uOnJlbGF0aXZlO30KICAgICAgICAgICAgLnRlbXBsYXRlLWJhcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7aGVpZ2h0OjMwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTNwdDtmb250LXdlaWdodDpib2xkO2NvbG9yOnNpbHZlcjt9CiAgICAgICAgICAgICNlZGl0b3ItZnJhbWV7aGVpZ2h0OjIwMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjFweCBzb2xpZCAjMDAwMDAwO30KICAgICAgICAgICAgI3RlbXBsYXRlLWNvbmZpZ3twb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7ei1pbmRleDo5OTsKICAgICAgICAgICAgICAgIGJvcmRlcjoycHggc29saWQgIzAwMDAwMDtwYWRkaW5nOjBweDtmb250LXNpemU6MTJwdDtjb2xvcjojMkY1RkExO2hlaWdodDo1NTBweDt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS1jb25maWctYmxvY2t7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTtoZWlnaHQ6NTIwcHg7b3ZlcmZsb3c6YXV0bzt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS10ZXN0e3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsgYm9yZGVyOjJweCBzb2xpZCAjMDAwMDAwOwogICAgICAgICAgICAgICAgcGFkZGluZzowcHg7aGVpZ2h0OjU1MHB4O2ZvbnQtc2l6ZToxMnB0O2NvbG9yOiMyRjVGQTE7ei1pbmRleDo5OTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS1tYXRjaGVze3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDo1MjBweDtvdmVyZmxvdzphdXRvO30KICAgICAgICAgICAgI3RlbXBsYXRlLXRlc3QtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MzBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOnJlZDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgI3RlbXBsYXRlLXZpZXdlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7CiAgICAgICAgICAgICAgICBib3JkZXI6MHB4IHNvbGlkICMwMDAwMDA7d2lkdGg6MTAwJTtoZWlnaHQ6NTAwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTJwdDtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgLmN0eHRfYmxvY2t7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjpzaWx2ZXI7Ym9yZGVyOjFweCBzb2xpZCAjMDAwMDAwO30KICAgICAgICAgICAgLmNsb3NlYnV0dG9ue2ZvbnQtc2l6ZToxNHB0O2ZvbnQtd2VpZ2h0OmJvbGQ7Y29sb3I6cmVkOwogICAgICAgICAgICAgICAgY3Vyc29yOnBvaW50ZXI7ZGlzcGxheTppbmxpbmU7dGV4dC1hbGlnbjpyaWdodDt9CiAgICAgICAgICAgIC5jbG9zZXR4dHtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MTBwdDtjb2xvcjojY2NjY2NjO3RleHQtYWxpZ246cmlnaHQ7fQogICAgICAgICAgICAjdXJsYmxvY2t7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTtvdmVyZmxvdzphdXRvOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAjdXJsLWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2NjY2NjYzsKICAgICAgICAgICAgICAgIGhlaWdodDozMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjFweCBzb2xpZCAjRkZGRkZGO30KICAgICAgICAgICAgLnVybC11bHtsaXN0LXN0eWxlOm5vbmU7cGFkZGluZzowO21hcmdpbjowO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAudXJsLWxpe2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC51cmwtbGktd2FybntiYWNrZ3JvdW5kLWNvbG9yOiNGRjgwMDA7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAudXJsLWxpLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC51cmxsaS1oZWFkZXJ7bGlzdC1zdHlsZTpub25lO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtmb250LXdlaWdodDpib2xkOwogICAgICAgICAgICAgICAgZm9udC1zaXplOjE0cHQ7Y29sb3I6I2MwYzBjMDt9CiAgICAgICAgICAgIC51cmwtbGktcGFnZXtjb2xvcjojY2NjYzcwO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjEzcHQ7fQogICAgICAgICAgICAjdXJsbGlzdC1mb3Jte3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjcyMHB4O2hlaWdodDoxNTBweDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZy10b3A6MTBweDtwYWRkaW5nLWxlZnQ6NnB4O2ZvbnQtc2l6ZToxMnB0OwogICAgICAgICAgICAgICAgY29sb3I6IzJGNUZBMTt6LWluZGV4Ojk5O292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI3JlY29yZC12aWV3e3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsgei1pbmRleDo5OTsKICAgICAgICAgICAgICAgIGJvcmRlcjoycHggc29saWQgIzAwMDAwMDtwYWRkaW5nOjBweDtoZWlnaHQ6NTUwcHg7Zm9udC1zaXplOjEycHQ7Y29sb3I6IzJGNUZBMTt9CiAgICAgICAgICAgICNyZWNvcmQtcmVze3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDo1MjBweDtvdmVyZmxvdzphdXRvO30KICAgICAgICAgICAgI3JlY29yZC1oZWFkZXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2hlaWdodDozMHB4OwogICAgICAgICAgICAgICAgZm9udC1zaXplOjE0cHQ7Y29sb3I6cmVkO2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAucmVjb3JkLXRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MjBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOiNjY2NjY2M7Zm9udC13ZWlnaHQ6Ym9sZDt3aWR0aDoxMDAlO3RleHQtYWxpZ246Y2VudGVyfQogICAgICAgICAgICAjZGF0YXtwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAjZG5ze3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtkaXNwbGF5Om5vbmU7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt9CiAgICAgICAgICAgICNkbnMtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojY2NjY2NjOwogICAgICAgICAgICAgICAgaGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTtib3JkZXI6MXB4IHNvbGlkICNGRkZGRkY7fQogICAgICAgICAgICAjZG5zLWxpc3R7cG9zaXRpb246cmVsYXRpdmU7fQogICAgICAgICAgICAuZG5zLXVse2xpc3Qtc3R5bGU6bm9uZTtwYWRkaW5nOjA7bWFyZ2luOjA7fQogICAgICAgICAgICAuZG5zLWxpe2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAuZG5zLWxpLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjcHJveHl7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO30KICAgICAgICAgICAgI3Byb3h5LWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2NjY2NjYzsKICAgICAgICAgICAgICAgIGhlaWdodDozMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjFweCBzb2xpZCAjRkZGRkZGO30KICAgICAgICAgICAgI3Byb3h5LWxpc3R7cG9zaXRpb246cmVsYXRpdmU7fQogICAgICAgICAgICAucHJveHktdWx7bGlzdC1zdHlsZTpub25lO3BhZGRpbmc6MDttYXJnaW46MDt9CiAgICAgICAgICAgIC5wcm94eS1saXtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLnByb3h5LWxpLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjdXNlcntwb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7IGNvbG9yOiMyRjVGQTE7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3OyBwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmxpc3Rmb3Jte21hcmdpbjowcHg7ZGlzcGxheTogaW5saW5lO30KICAgICAgICAgICAgLm5vZGV7ei1pbmRleDo5OTtvdmVyZmxvdzpoaWRkZW47Y29sb3I6YmxhY2s7Zm9udC1zaXplOjEycHQ7fQogICAgICAgICAgICAubm9kZW5hbWV7Y29sb3I6YmxhY2s7Zm9udC1zaXplOjEycHQ7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAuZWFkZHtjb2xvcjojNUZCNDA0O2ZvbnQtc2l6ZToxM3B0O2ZvbnQtd2VpZ2h0OmJvbGRlcjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5ldXBkYXRle2NvbG9yOiNGRjgwMDA7Zm9udC1zaXplOjEzcHQ7Zm9udC13ZWlnaHQ6Ym9sZGVyO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLmVkZWxldGV7Y29sb3I6I0I0MDQ1Rjtmb250LXNpemU6MTNwdDtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAuZXZpZXd7Y29sb3I6IzAwMDBmZjtmb250LXNpemU6MTNwdDtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAuaWNvbntkaXNwbGF5OmlubGluZTtjb2xvcjojRkY4MDAwO2ZvbnQtc2l6ZToxM3B0O3RleHQtYWxpZ246Y2VudGVyO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLm5jaGlsZHN7ZGlzcGxheTppbmxpbmU7Y29sb3I6cmVkO2ZvbnQtc2l6ZToxMnB0O30KICAgICAgICAgICAgI2JmcmFtZXtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjE7ZGlzcGxheTpub25lO2JvcmRlcjowfQogICAgICAgIDwvc3R5bGU+CiAgICA8c2NyaXB0IGxhbmd1YWdlPSdqYXZhc2NyaXB0Jz4KICAgICAgICAgICAgdmFyIGNocmFkZCA9ICfinJonLCBjaHJmb2xkID0gJ+KWuicsIGNocnRyZWUgPSAn4pa8JywgY2hyZWRpdD0n4pyOJywgY2hyZGVsPSfinJgnLCBjaHJ2aWV3ID0gJ+KYnCAnOwogICAgICAgICAgICB2YXIgb1RpbWVyID0gbnVsbDsKICAgICAgICAgICAgdmFyIGJhc2U2NEVuY29kZUNoYXJzID0gCiAgICAgICAgICAgICAgICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgICAgICAgICAgIHZhciBiYXNlNjREZWNvZGVDaGFycyA9IG5ldyBBcnJheSgKICAgICAgICAgICAgICAgIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsCiAgICAgICAgICAgICAgICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDYyLCAtMSwgLTEsIC0xLCA2MywKICAgICAgICAgICAgICAgIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsICAwLCAgMSwgIDIsICAzLCAgNCwgIDUsICA2LCAgNywgIDgsICA5LCAxMCwgMTEsIDEyLCAxMywgMTQsCiAgICAgICAgICAgICAgICAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjUsIC0xLCAtMSwgLTEsIC0xLCAtMSwKICAgICAgICAgICAgICAgIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLAogICAgICAgICAgICAgICAgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCAtMSwgLTEsIC0xLCAtMSwgLTEpOwogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRlbmNvZGUoc3RyKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG91dCwgaSwgbGVuOwogICAgICAgICAgICAgICAgdmFyIGMxLCBjMiwgYzM7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYzEgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICBpZihpID09IGxlbikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoYzEgPj4gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKGMxICYgMHgzKSA8PCA0KTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9ICI9PSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSBsZW4pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KGMxID4+IDIpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KChjMiAmIDB4RikgPDwgMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSAiPSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMSA+PiAyKTsKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKChjMiAmIDB4RikgPDwgMikgfCAoKGMzICYgMHhDMCkgPj42KSk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMyAmIDB4M0YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRkZWNvZGUoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYzEsIGMyLCBjMywgYzQ7CiAgICAgICAgICAgICAgICB2YXIgaSwgbGVuLCBvdXQ7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgLyogYzEgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMxID0gYmFzZTY0RGVjb2RlQ2hhcnNbc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmZdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMSA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzEgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIC8qIGMyICovCiAgICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgICAgICBjMiA9IGJhc2U2NERlY29kZUNoYXJzW3N0ci5jaGFyQ29kZUF0KGkrKykgJiAweGZmXTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzIgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGMyID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYzEgPDwgMikgfCAoKGMyICYgMHgzMCkgPj4gNCkpOwoKICAgICAgICAgICAgICAgICAgICAvKiBjMyAqLwogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgYzMgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gNjEpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGMzID0gYmFzZTY0RGVjb2RlQ2hhcnNbYzNdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMyA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzIgJiAwWEYpIDw8IDQpIHwgKChjMyAmIDB4M0MpID4+IDIpKTsKCiAgICAgICAgICAgICAgICAgICAgLyogYzQgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGM0ID0gc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmY7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IDYxKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgICAgICAgICAgICAgICAgICBjNCA9IGJhc2U2NERlY29kZUNoYXJzW2M0XTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzQgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzMgJiAweDAzKSA8PCA2KSB8IGM0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmMTZ0bzgoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICBvdXQgPSAiIjsKICAgICAgICAgICAgICAgIGxlbiA9IHN0ci5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoKGMgPj0gMHgwMDAxKSAmJiAoYyA8PSAweDAwN0YpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGMgPiAweDA3RkYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhFMCB8ICgoYyA+PiAxMikgJiAweDBGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDYpICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDgwIHwgKChjID4+ICAwKSAmIDB4M0YpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhDMCB8ICgoYyA+PiAgNikgJiAweDFGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDApICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmOHRvMTYoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICB2YXIgY2hhcjIsIGNoYXIzOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICBsZW4gPSBzdHIubGVuZ3RoOwogICAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGMgPj4gNCkKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogY2FzZSAyOiBjYXNlIDM6IGNhc2UgNDogY2FzZSA1OiBjYXNlIDY6IGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMHh4eHh4eHgKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IHN0ci5jaGFyQXQoaS0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6IGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDExMHggeHh4eCAgIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYyAmIDB4MUYpIDw8IDYpIHwgKGNoYXIyICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTExMCB4eHh4ICAxMHh4IHh4eHggIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIzID0gc3RyLmNoYXJDb2RlQXQoaSsrKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjICYgMHgwRikgPDwgMTIpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMiAmIDB4M0YpIDw8IDYpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMyAmIDB4M0YpIDw8IDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ3dhaXQnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG92ZXJfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2F1dG8nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGJhc2U2NHN0cmRlY29kZShzdHIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRmOHRvMTYoYmFzZTY0ZGVjb2RlKHN0cikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRyaW0oc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyheXHMrfFxzKyQpLywgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodChvYmopCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9iai5jbGFzc05hbWUgPSAiYnRpdGxlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYWNrY3NzKG9iaikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb2JqLmNsYXNzTmFtZSA9ICJ0aXRsZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gb3ZlckJGcmFtZShlbGVtZW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYmZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JmcmFtZScpOwogICAgICAgICAgICAgICAgaWYoYmZyYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGJmcmFtZS5zdHlsZS5sZWZ0ID0gZWxlbWVudC5vZmZzZXRMZWZ0KyJweCI7CiAgICAgICAgICAgICAgICAgICAgYmZyYW1lLnN0eWxlLnRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wKyJweCI7CiAgICAgICAgICAgICAgICAgICAgYmZyYW1lLnN0eWxlLndpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aCsicHgiOwogICAgICAgICAgICAgICAgICAgIGJmcmFtZS5zdHlsZS5oZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodCsicHgiOwogICAgICAgICAgICAgICAgICAgIGJmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gaGlkZUJGcmFtZSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBiZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmZyYW1lJyk7CiAgICAgICAgICAgICAgICBiZnJhbWUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVFbGVtZW50KF9lbGVtZW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgX3BhcmVudEVsZW1lbnQgPSBfZWxlbWVudC5wYXJlbnROb2RlOwogICAgICAgICAgICAgICAgaWYoX3BhcmVudEVsZW1lbnQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgX3BhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoX2VsZW1lbnQpOyAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gaGlkZUJGcmFtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIENyZWF0ZVhNTEhUVFAoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1saHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICB4bWxodHRwT2JqID0gWyJNU1hNTDIuWG1sSHR0cC41LjAiLCJNU1hNTDIuWG1sSHR0cC40LjAiLAogICAgICAgICAgICAgICAgIk1TWE1MMi5YbWxIdHRwLjMuMCIsIk1TWE1MMi5YbWxIdHRwIiwiTWljcm9zb2Z0LlhtbEh0dHAiXTsKICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5YTUxIdHRwUmVxdWVzdCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKHdpbmRvdy5BY3RpdmVYT2JqZWN0KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcihpPTA7aTx4bWxodHRwT2JqLmxlbmd0aDtpKyspICAgIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e3htbGh0dHAgPSBuZXcgQWN0aXZlWE9iamVjdCh4bWxodHRwT2JqW2ldKTticmVhazt9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoKGUpe3htbGh0dHAgPSBudWxsO30KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdDYW4gbm90IGNyZWF0ZSBYTUxIVFRQIE9iamVjdCcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHhtbGh0dHA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmVidWlsZENoaWxkKG9QYXJlbnQsIHBpZCwgaWQsIG5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKG9QYXJlbnQgJiYgcGFyc2VJbnQoaWQpID4gMCAmJiBuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzdHJjaGlsZHMgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnY2hpbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBOYW1lID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ1VOYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYoc3RyY2hpbGRzKSBjaGlsZHMgPSBldmFsKHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBjaGlsZHMgPSBuZXcgQXJyYXkoKTsKICAgICAgICAgICAgICAgICAgICBjaGlsZHNbaWRdID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgPSAiKHsiOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHggIT0gcGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzICs9IHgrIjonIitjaGlsZHNbeF0rIicsIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0gcGlkKyI6JyIrcE5hbWUrIid9KSI7CiAgICAgICAgICAgICAgICAgICAgb1BhcmVudC5zZXRBdHRyaWJ1dGUoJ2NoaWxkcycsIHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlQ2hpbGQob1BhcmVudCwgcGlkLCBpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYob1BhcmVudCAmJiBwYXJzZUludChpZCkgPiAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzdHJjaGlsZHMgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnY2hpbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBOYW1lID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ1VOYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYoc3RyY2hpbGRzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRzID0gZXZhbChzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHNbaWRdID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyA9ICIoeyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBwaWQgJiYgY2hpbGRzW3hdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0geCsiOiciK2NoaWxkc1t4XSsiJywiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzICs9IHBpZCsiOiciK3BOYW1lKyInfSkiOwogICAgICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnY2hpbGRzJywgc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQWRkTm9kZShwaWQsIGlkLCBuYW1lLCBjb3VudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5vZGUiK2lkKSAhPSBudWxsKSByZXR1cm47CiAgICAgICAgICAgICAgICAvL2FsZXJ0KCJwaWQ6IitwaWQrImlkOiIraWQrIm5hbWU6IituYW1lKTsKICAgICAgICAgICAgICAgIHZhciBvUGFyZW50ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHBpZCA+PSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9QYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9kZSIrcGlkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvUGFyZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZWVib2R5Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvL2FsZXJ0KHBpZCsnOicraWQrJzonK25hbWUpOwogICAgICAgICAgICAgICAgaWYob1BhcmVudCA9PSBudWxsKSByZXR1cm47CiAgICAgICAgICAgICAgICB2YXIgb05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdsZXZlbCcpICogMTsKICAgICAgICAgICAgICAgIHZhciBuY2hpbGRzID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ25jaGlsZHMnKSAqIDE7CiAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnbmNoaWxkcycsIG5jaGlsZHMgKyAxKTsKICAgICAgICAgICAgICAgIGlmKHBpZCA+PSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzdHJjaGlsZHMgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnY2hpbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBOYW1lID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ1VOYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYoc3RyY2hpbGRzKSBjaGlsZHMgPSBldmFsKHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBjaGlsZHMgPSBuZXcgQXJyYXkoKTsKICAgICAgICAgICAgICAgICAgICBjaGlsZHNbaWRdID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgPSAiKHsiOwogICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHggIT0gcGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzICs9IHgrIjonIitjaGlsZHNbeF0rIicsIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzICs9IHBpZCsiOiciK3BOYW1lKyInfSkiOwogICAgICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCdjaGlsZHMnLCBzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIG9mb2xkID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKChvZm9sZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmb2xkXycrcGlkKSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYobmNoaWxkcyA9PSAwKSBvZm9sZC5pbm5lckhUTUwgPSBjaHJ0cmVlOyAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBvbmNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigob25jaGlsZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hfJytwaWQpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvbmNoaWxkcy5pbm5lckhUTUwgPSBuY2hpbGRzKzE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBvTm9kZS5pZCA9ICJub2RlIiArIGlkOwogICAgICAgICAgICAgICAgb05vZGUuY2xhc3NOYW1lID0gJ25vZGUnOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdsZXZlbCcsIGxldmVsICsgMSk7CiAgICAgICAgICAgICAgICBvTm9kZS5zZXRBdHRyaWJ1dGUoJ25jaGlsZHMnLCAwKTsKICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgncGFyZW50JywgcGlkKTsKICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgnVUlEJywgaWQpOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdVTmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgaHRtbHN0ciA9ICI8ZGl2IGlkPSd0aXRsZV8iKyBpZCArIicgY2xhc3M9J3RpdGxlJyAiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ2J0aXRsZScpO1wiICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAndGl0bGUnKTtcIj4iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3RyZWVsaW5lJz4iOwogICAgICAgICAgICAgICAgdmFyIGkgPSAwOwogICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgKGxldmVsLTEpOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGxldmVsID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBpZihjb3VudCA+IDApCiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gaWQ9J2ZvbGRfIisgaWQgKyInIGNsYXNzPSdpY29uJyBvbmNsaWNrPSdGb2xkKHRoaXMpJz4iK2NocmFkZCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gaWQ9J2ZvbGRfIisgaWQgKyInIGNsYXNzPSdpY29uJyBvbmNsaWNrPSdGb2xkKHRoaXMpJz4iK2NocmZvbGQrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGlkPSduZF8iK2lkKyInIGNsYXNzPSdub2RlbmFtZScgdGl0bGU9J+eCueWHu+i/m+WFpeaooeeJiOeuoeeQhiciOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9uY2xpY2s9J1ZpZXdUZW1wbGF0ZXMoIitpZCsiKScgPiIrbmFtZSsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJbPHNwYW4gaWQ9J2NoXyIrIGlkICsiJyBjbGFzcz0nbmNoaWxkcycgPiIrY291bnQrIjwvc3Bhbj5dIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWFkZCcgdGl0bGU9J0FkZCcgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hBZGQoZXZlbnQpJz4iK2NocmFkZCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2V1cGRhdGUnIHRpdGxlPSdSZW5hbWUnICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPSdYRWRpdChldmVudCknPiIrY2hyZWRpdCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPSdYRGVsZXRlKCIraWQrIiwiK3BpZCsiKSc+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvZGl2PiI7CiAgICAgICAgICAgICAgICBvTm9kZS5pbm5lckhUTUwgPSBodG1sc3RyOyAKICAgICAgICAgICAgICAgIG9QYXJlbnQuYXBwZW5kQ2hpbGQob05vZGUpOwogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFVwZGF0ZU5vZGUoaWQsIG5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvTm9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlJytpZCk7CiAgICAgICAgICAgICAgICBpZihvTm9kZSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgnVU5hbWUnLCBuYW1lKTsKICAgICAgICAgICAgICAgICAgICB2YXIgb05hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmRfJytpZCk7CiAgICAgICAgICAgICAgICAgICAgaWYob05hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9OYW1lLmlubmVySFRNTCA9IG5hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RDaGlsZHMocGFyZW50LCB1cmwsIGFyZ3YpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpOwogICAgICAgICAgICAgICAgaWYoeG1sSHR0cCAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsIHVybCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG5vZGUgPSBldmFsKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bm9kZVsnaWQnXSA9PSBwYXJlbnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IHRub2RlWyduY2hpbGRzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWRkTm9kZShwYXJlbnQsIHRub2RlWydjaGlsZHMnXVtpXVsnaWQnXSAqIDEsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG5vZGVbJ2NoaWxkcyddW2ldWyduYW1lJ10sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG5vZGVbJ2NoaWxkcyddW2ldWyduY2hpbGRzJ10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5FZGl0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2Nsb3NlIGZvcm0KICAgICAgICAgICAgZnVuY3Rpb24gQ2xvc2VUaGlzKGVsZW1lbnQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0FkZCBjaGlsZAogICAgICAgICAgICBmdW5jdGlvbiBYQWRkKGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgb3ZlckJGcmFtZShYZGl2KTsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbImVkaXRvcmZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAnbm9kZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsncGlkJ10udmFsdWUgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ1VJRCcpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ25vZGVuYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25vZGVuYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBYRWRpdChlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0eHRmb3JtIik7CiAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WDsKICAgICAgICAgICAgICAgIHZhciB5ID0gZS5jbGllbnRZOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKFhkaXYpOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1siZWRpdG9yZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdub2RlX3VwZGF0ZSc7CiAgICAgICAgICAgICAgICBmb3JtWydwaWQnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgncGFyZW50Jyk7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlaWQnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnVUlEJyk7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlbmFtZSddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlbmFtZSddLnZhbHVlID0gZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdVTmFtZScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEhpZGRlbkVkaXRvcigpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHh0Zm9ybScpOwogICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBFZGl0Tm9kZShmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICIiOwogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBwaWQgPSBmb3JtWydwaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSBmb3JtWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBub2RlbmFtZSA9IGZvcm1bJ25vZGVuYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICBpZihvcCA9PSAnbm9kZV9hZGQnICYmIG5vZGVuYW1lICYmIHBpZCA+PSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9IitvcCsiJm5hbWU9IitlbmNvZGVVUklDb21wb25lbnQobm9kZW5hbWUpKyImcGFyZW50aWQ9IitwaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICdub2RlX3VwZGF0ZScgJiYgbm9kZW5hbWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCkKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPSIrb3ArIiZuYW1lPSIrZW5jb2RlVVJJQ29tcG9uZW50KG5vZGVuYW1lKQogICAgICAgICAgICAgICAgICAgICAgICArIiZub2RlaWQ9Iitub2RlaWQrIiZwYXJlbnRpZD0iK3BpZDsKICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgVXBkYXRlTm9kZShub2RlaWQsIG5vZGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIDsKICAgICAgICAgICAgICAgIC8vYWxlcnQoIm9wOiIrb3ArIm5vZGVpZDoiK25vZGVpZCsicGlkOiIrcGlkKyJub2RlbmFtZToiK25vZGVuYW1lKTsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpOwogICAgICAgICAgICAgICAgaWYoeG1sSHR0cCAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihvcCA9PSAnbm9kZV9hZGQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRub2RlID0gZXZhbCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRub2RlWydpZCddID09IHBpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdG5vZGVbJ25jaGlsZHMnXTsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFkZE5vZGUocGlkLCB0bm9kZVsnY2hpbGRzJ11baV1bJ2lkJ10gKiAxLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRub2RlWydjaGlsZHMnXVtpXVsnbmFtZSddLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRub2RlWydjaGlsZHMnXVtpXVsnbmNoaWxkcyddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICdub2RlX3VwZGF0ZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSB0cmltKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaWQgPiAwICYmIGlkID09IG5vZGVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVwZGF0ZU5vZGUoaWQsIG5vZGVuYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vZGVsZXRlIG5vZGUKICAgICAgICAgICAgZnVuY3Rpb24gWERlbGV0ZShub2RlaWQsIHBhcmVudGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgb05vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9kZSIrbm9kZWlkKTsKICAgICAgICAgICAgICAgIHZhciBuYW1lID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgb05vZGUgIT0gbnVsbCAmJiAobmFtZSA9IG9Ob2RlLmdldEF0dHJpYnV0ZSgnVU5hbWUnKSkKICAgICAgICAgICAgICAgICAgICAmJiBjb25maXJtKCdBcmUgeW91IHN1cmUgZGVsZXRlIG5vZGU6Jytub2RlaWQrJyBuYW1lOicrbmFtZSsnID8nKSAKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1ub2RlX2RlbGV0ZSZub2RlaWQ9Iitub2RlaWQrIiZwYXJlbnRpZD0iK3BhcmVudGlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSB0cmltKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGlkID0gb05vZGUuZ2V0QXR0cmlidXRlKCdwYXJlbnQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb1BhcmVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlJytwaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlkID09IG5vZGVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuY2hpbGRzID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ25jaGlsZHMnKSAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCduY2hpbGRzJywgbmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZUNoaWxkKG9QYXJlbnQsIHBpZCwgaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2NoaWxkID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaF8nK3BpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9jaGlsZC5pbm5lckhUTUwgPSBuY2hpbGRzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnJlbW92ZUNoaWxkKG9Ob2RlKTsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmxpZCA9IGRvY3VtZW50LmZvcm1zWyd0ZW1wbGF0ZWZvcm0nXVsnbm9kZWlkJ10udmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaWQgPT0gdXJsaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9mb2xkIG5vZGUKICAgICAgICAgICAgZnVuY3Rpb24gRm9sZChlbGVtZW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbmNoaWxkcyA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnbmNoaWxkcycpICogMTsKICAgICAgICAgICAgICAgIHZhciB1aWQgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ1VJRCcpICogMTsKICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiLyI7CiAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1ub2RlX2NoaWxkcyZub2RlaWQ9Iit1aWQ7CiAgICAgICAgICAgICAgICBpZihlbGVtZW50LmlubmVySFRNTCA9PSBjaHJhZGQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0ID0gJyc7CiAgICAgICAgICAgICAgICAgICAgTGlzdENoaWxkcyh1aWQsIHVybCwgYXJndik7CiAgICAgICAgICAgICAgICAgICAgaWYobmNoaWxkcyA+IDApZWxlbWVudC5pbm5lckhUTUwgPSBjaHJ0cmVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihlbGVtZW50LmlubmVySFRNTCA9PSBjaHJmb2xkKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIExpc3RDaGlsZHModWlkLCB1cmwsIGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnN0eWxlLmhlaWdodCA9IGVsZW1lbnQucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgaWYobmNoaWxkcyA+IDApIGVsZW1lbnQuaW5uZXJIVE1MID0gY2hyYWRkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpbWl0U3BlZWQoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHNwZWVkID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKHNwZWVkID0gZm9ybVsnc3BlZWQnXS52YWx1ZSkgIT0gJycKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1zcGVlZF9saW1pdCZzcGVlZD0iK3NwZWVkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGFza0luZm8oeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL1Nob3cgVGFzawogICAgICAgICAgICBmdW5jdGlvbiBTaG93VGFza0luZm8odHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdGFza2luZm8gPSBudWxsOwogICAgICAgICAgICAgICAgaWYodHh0ICYmICh0YXNraW5mbyA9IGV2YWwodHh0KSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNwZWVkID0gdGFza2luZm9bJ3NwZWVkX2xpbWl0J107CiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzdHIgPSAiIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPueKtuaAgTombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8YSBocmVmPVwiamF2YXNjcmlwdDpWaWV3VGFzaygndGFza18iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gdGFza2luZm9bJ3N0YXR1cyddKyInKTtcIiBjbGFzcz0ndnRhc2snIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI+Iit0YXNraW5mb1snc3RhdHVzJ10rIjwvYT48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPlVSTOaAu+aVsDombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ3VybF90b3RhbCddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPuS7u+WKoeaAu+aVsDombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ3VybF9udGFza3MnXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7ku7vliqHlrozmiJA6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfdGFza19vayddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPuS7u+WKoemUmeivrzombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ3VybF90YXNrX2Vycm9yJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+5paH5qGj5aSn5bCPOiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+Iit0YXNraW5mb1snZG9jX3RvdGFsX3pzaXplJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiLyIgKyB0YXNraW5mb1snZG9jX3RvdGFsX3NpemUnXSsiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+RE5T6Kej5p6QOiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+Iit0YXNraW5mb1snaG9zdF9jdXJyZW50J107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiLyIgKyB0YXNraW5mb1snaG9zdF90b3RhbCddKyI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7lt7LnlKjml7bpl7Q6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz5bIit0YXNraW5mb1sndF9kYXknXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDtEYXkocykmbmJzcDsmbmJzcDsiK3Rhc2tpbmZvWyd0X2hvdXInXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI6Iit0YXNraW5mb1sndF9taW4nXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI6Iit0YXNraW5mb1sndF9zZWMnXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsrIit0YXNraW5mb1sndF91c2VjJ10rIl0iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPuS4i+i9vemAn+W6pjombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ3NwZWVkJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIChLQi9TKSA8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7pgJ/luqbpmZDliLY6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxmb3JtIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyBjbGFzcz0nbGlzdGZvcm0nICI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9uc3VibWl0PSdMaW1pdFNwZWVkKHRoaXMpJz4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPXRleHQgbmFtZT1zcGVlZCB2YWx1ZT0nIitzcGVlZCsiJz4gKEtCL1MpICI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7PGlucHV0IHR5cGU9c3VibWl0IG5hbWU9J3N1Ym1pdCcgdmFsdWU9J09LJz4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gICLvvIgw5ZKM6LSf5pWw6KGo56S65LiN6ZmQ6YCf77yJPC9mb3JtPjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgb3Rhc2tpbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tpbmZvJyk7CiAgICAgICAgICAgICAgICAgICAgaWYob3Rhc2tpbmZvKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG90YXNraW5mby5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIG90YXNraW5mby5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy92aWV3IFRhc2sKICAgICAgICAgICAgZnVuY3Rpb24gVmlld1Rhc2sob3ApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKCh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPSIrb3A7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Rhc2tJbmZvKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG9uRGl2KGRpdiwgY3NzTmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9IGNzc05hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gb3V0RGl2KGRpdiwgY3NzTmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZGl2LmNsYXNzTmFtZSA9IGNzc05hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUmVzZXREQigpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBvZGIuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgb2RiZiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZpZWxkcycpOwogICAgICAgICAgICAgICAgICAgIG9kYmYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld0RCKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRiID0gZXZhbCh0eHQpOwogICAgICAgICAgICAgICAgaWYoZGIgJiYgZGJbJ3RhYmxlcyddLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmlkID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibmFtZSA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0ndWx0YWInPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgZGJbJ3RhYmxlcyddLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFiaWQgPSBkYlsndGFibGVzJ11baV1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHRhYm5hbWUgPSBkYlsndGFibGVzJ11baV1bJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdsdGFiJyBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICdsdGFiLXNlbGVjdGVkJylcIiAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAnbHRhYicpXCIgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdsdGFibmFtZScgb25jbGljaz0nVmlld1RhYmxlKCIrdGFiaWQrIiknICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiB0aXRsZT0n54K55Ye76L+b5YWl5pWw5o2u6KGo566h55CGJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSB0YWJuYW1lKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2V1cGRhdGUnIHRpdGxlPSdSZW5hbWUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEQlhFZGl0KGV2ZW50LCIrdGFiaWQrIiwgJyIrdGFibmFtZSsiJylcIj4iK2NocmVkaXQrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZVRhYmxlKCIrdGFiaWQrIiwgJyIrdGFibmFtZSsiJylcIj4iK2NocmRlbCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBvZGIuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gQWRkVGFibGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhYm5hbWUgPSBmb3JtWyd0YWJuYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0YWJuYW1lICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXRhYmxlX2FkZCZuYW1lPSIrdGFibmFtZTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RCKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtWyd0YWJuYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgUmVzZXREQigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlVGFibGUodGFiaWQsIHRhYm5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGNvbmZpcm0oIkFyZSB5b3Ugc3VyZSBkZWxldGUgdGFiYmxlOiIrdGFibmFtZSsiID8iKSAKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10YWJsZV9kZWxldGUmdGFibGVpZD0iK3RhYmlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3REIoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdEYXRhYmFzZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICBSZXNldERCKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0xpc3QgVGFibGUgRmllbGRzCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdGaWVsZHModHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgdGFiID0gZXZhbCh0eHQpOwogICAgICAgICAgICAgICAgaWYodGFiKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB0YWJpZCA9IHRhYlsnaWQnXTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibmFtZSA9IHRhYlsnbmFtZSddOwogICAgICAgICAgICAgICAgICAgIHZhciBmaWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBmbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZ0eXBlID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgZmxhZyA9IDA7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciA9ICAiPHVsIGNsYXNzPSd1bHRhYicgPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdmaWVsZC10aXRsZSc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIueCueWHuzxzcGFuIGNsYXNzPSdlYWRkJyB0aXRsZT0nQ2xpY2sgQWRkIE5ldyBGaWVsZCcgIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiREJGWEFkZChldmVudCwgJyIrdGFiaWQrIicpXCI+IitjaHJhZGQrIjwvc3Bhbj7mt7vliqDlrZfmrrUiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2x0YWJuYW1lJz4iK3RhYm5hbWUrIlsiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSduY2hpbGRzJz4iK3RhYlsnbmZpZWxkcyddKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJdPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IHRhYlsnbmZpZWxkcyddOyBpKyspCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBmaWQgPSB0YWJbJ2ZpZWxkcyddW2ldWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBmbmFtZSA9IHRhYlsnZmllbGRzJ11baV1bJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgZnR5cGUgPSB0YWJbJ2ZpZWxkcyddW2ldWyd0eXBlJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSB0YWJbJ2ZpZWxkcyddW2ldWydmbGFnJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0nbGZpZWxkJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW1vdmU9XCJvbkRpdih0aGlzLCAnbGZpZWxkLXNlbGVjdGVkJylcIiAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAnbGZpZWxkJyk7XCIgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdsZm5hbWUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEQkZYRWRpdChldmVudCwgIit0YWJpZCsiLCIrZmlkKyIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJyIrZm5hbWUrIicsICIrZnR5cGUrIiwgIitmbGFnKyIpXCI+IitmbmFtZSsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdldXBkYXRlJyB0aXRsZT0nQ2hhbmdlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiREJGWEVkaXQoZXZlbnQsICIrdGFiaWQrIiwiK2ZpZCsiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiciK2ZuYW1lKyInLCAiK2Z0eXBlKyIsICIrZmxhZysiKVwiPiIrY2hyZWRpdCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiRGVsZXRlRmllbGQoIit0YWJpZCsiLCIrZmlkKyIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJyIrdGFibmFtZSsiJywgJyIrZm5hbWUrIicpXCI+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgb2RiZmllbGRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RiZmllbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgb2RiZmllbGRzLmlubmVySFRNTCA9IGh0bWxzdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9MaXN0L1ZpZXcgRmllbGQKICAgICAgICAgICAgZnVuY3Rpb24gVmlld1RhYmxlKHRhYmlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CgogICAgICAgICAgICAgICAgaWYodGFiaWQgPj0gMCAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10YWJsZV92aWV3JnRhYmxlaWQ9Iit0YWJpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0ZpZWxkcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICAvL1ZpZXcgZGF0YWJhc2UKICAgICAgICAgICAgZnVuY3Rpb24gVmlld0RhdGFiYXNlKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZGF0YWJhc2VfdmlldyI7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0YWJhc2UnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZGIuc2V0QXR0cmlidXRlKCdkYmFzZScsIHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2FkTGlua09wdGlvbnMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0xpc3QgVGFibGVzCiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RUYWJsZXMoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10YWJsZV9saXN0IjsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RCKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gSGlkZGVuREJmb3JtKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZvcm0nKTsKICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgaGlkZUJGcmFtZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gREJYQWRkKGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRiZm9ybSIpOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKFhkaXYpOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sieGRiZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0YWJsZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERCWEVkaXQoZSwgaWQsIG5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRiZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKFhkaXYpOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sieGRiZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0YWJsZV9yZW5hbWUnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gaWQ7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS52YWx1ZSA9IG5hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdERCKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBmb3JtWyduYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICBpZihvcCA9PSAndGFibGVfYWRkJyAmJiBuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9dGFibGVfYWRkJm5hbWU9IituYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGFibGVfcmVuYW1lJyAmJiB0YWJsZWlkID49IDAgJiYgbmFtZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPXRhYmxlX3JlbmFtZSZ0YWJsZWlkPSIrdGFibGVpZCsiJm5hbWU9IituYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGFibGVfZGVsZXRlJyAmJiB0YWJsZWlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD10YWJsZV9kZWxldGUmdGFibGVpZD0iK3RhYmxlaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3REIoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5EQmZvcm0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEQkZYQWRkKGUsIHRhYmlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYmZpZWxkZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKFhkaXYpOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1siZGJmaWVsZGZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAnZmllbGRfYWRkJzsKICAgICAgICAgICAgICAgIGZvcm1bJ3RhYmxlaWQnXS52YWx1ZSA9IHRhYmlkOwogICAgICAgICAgICAgICAgZm9ybVsnZmllbGRpZCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydvbGRuYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ3R5cGUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnZmxhZyddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERCRlhFZGl0KGUsIHRhYmlkLCBmaWVsZGlkLCBmbmFtZSwgZnR5cGUsIGZsYWcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRiZmllbGRmb3JtIik7CiAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDsKICAgICAgICAgICAgICAgIHZhciB5ID0gZS5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIG92ZXJCRnJhbWUoWGRpdik7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJkYmZpZWxkZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdmaWVsZF91cGRhdGUnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gdGFiaWQ7CiAgICAgICAgICAgICAgICBmb3JtWydmaWVsZGlkJ10udmFsdWUgPSBmaWVsZGlkOwogICAgICAgICAgICAgICAgZm9ybVsnb2xkbmFtZSddLnZhbHVlID0gZm5hbWU7CiAgICAgICAgICAgICAgICBmb3JtWyd0eXBlJ10udmFsdWUgPSBmdHlwZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9IGZsYWc7CiAgICAgICAgICAgICAgICBmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBmb3JtWydmdHlwZSddLm9wdGlvbnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnZnR5cGUnXS5vcHRpb25zW2ldLnZhbHVlID09IGZ0eXBlKQogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydmdHlwZSddLm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2Z0eXBlJ10ub3B0aW9uc1tpXS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoZmxhZyAmIDEpIGZvcm1bJ2lzX2luZGV4J10uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBpZihmbGFnICYgMikgZm9ybVsnaXNfbnVsbCddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10udmFsdWUgPSBmbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5EQkZpZWxkZm9ybSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmaWVsZGZvcm0nKTsKICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgaGlkZUJGcmFtZSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdEZpZWxkKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZpZWxkaWQgPSBmb3JtWydmaWVsZGlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZm5hbWUgPSBmb3JtWyduYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZnR5cGUgPSBmb3JtWydmdHlwZSddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG9sZG5hbWUgPSBmb3JtWydvbGRuYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgb2xkdHlwZSA9IGZvcm1bJ3R5cGUnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBvbGRmbGFnID0gZm9ybVsnZmxhZyddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgaWYob3AgPT0gJ2ZpZWxkX2FkZCcgJiYgdGFibGVpZCA+PSAwICYmIGZuYW1lICYmIGZ0eXBlID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPWZpZWxkX2FkZCZ0YWJsZWlkPSIrdGFibGVpZCsiJm5hbWU9IitmbmFtZSsiJnR5cGU9IitmdHlwZTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICBpZihmbGFnID4gMCkgYXJndiArPSAiJmZsYWc9IitmbGFnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnZmllbGRfdXBkYXRlJyAmJiB0YWJsZWlkID49IDAgJiYgZmllbGRpZCA+PSAwKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZihmbmFtZSAmJiBmbmFtZSAhPSBvbGRuYW1lKSBlYXJndiArPSAiJm5hbWU9IitmbmFtZTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICBpZihmdHlwZSAhPSBvbGR0eXBlKSBlYXJndiArPSAiJnR5cGU9IitmdHlwZTsKICAgICAgICAgICAgICAgICAgICBpZihmbGFnICE9IG9sZGZsYWcpIGVhcmd2ICs9ICImZmxhZz0iK2ZsYWc7CiAgICAgICAgICAgICAgICAgICAgaWYoZWFyZ3YpCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9ZmllbGRfdXBkYXRlJnRhYmxlaWQ9Iit0YWJsZWlkKyImZmllbGRpZD0iK2ZpZWxkaWQrZWFyZ3Y7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RmllbGRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuREJGaWVsZGZvcm0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEZWxldGVGaWVsZCh0YWJpZCwgZmllbGRpZCwgdGFibmFtZSwgZmllbGRuYW1lKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihjb25maXJtKCJBcmUgeW91IHN1cmUgZGVsZXRlIFRhYmxlOiIrdGFibmFtZSsiIEZpZWxkOiIrZmllbGRuYW1lKyI/IikgCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZmllbGRfZGVsZXRlJnRhYmxlaWQ9Iit0YWJpZCsiJmZpZWxkaWQ9IitmaWVsZGlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RmllbGRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2RlbGV0ZSBkaXYKICAgICAgICAgICAgZnVuY3Rpb24gZGl2cmVtb3ZlKGVsZW1lbnQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBkaXZoaWRkZW4oZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoZWxlbWVudCAmJiBlbGVtZW50LmlubmVySFRNTCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaGlkZUJGcmFtZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAvL21vdmluZyBkaXYKICAgICAgICAgICAgZnVuY3Rpb24gZGl2bW92ZShlLCBvKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvLm9uc2VsZWN0c3RhcnQgPSBmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKGZhbHNlKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBvLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlID0gZXx8d2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgICAgIHZhciB4ID0gcGFyc2VJbnQoZS5jbGllbnRYIC0gby5wYXJlbnROb2RlLm9mZnNldExlZnQpOwogICAgICAgICAgICAgICAgICAgIHZhciB5ID0gcGFyc2VJbnQoZS5jbGllbnRZIC0gby5wYXJlbnROb2RlLm9mZnNldFRvcCk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSBmdW5jdGlvbihlKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZT1lfHx3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ucGFyZW50Tm9kZS5zdHlsZS5sZWZ0PShlLmNsaWVudFgteCkrInB4IjsKICAgICAgICAgICAgICAgICAgICAgICAgby5wYXJlbnROb2RlLnN0eWxlLnRvcD0oZS5jbGllbnRZLXkpKyJweCI7CiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJCRnJhbWUoby5wYXJlbnROb2RlKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9ubW91c2V1cD1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5vbm1vdXNlbW92ZT1udWxsOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBSZXNldFRlbXBsYXRlZm9ybSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInRlbXBsYXRlZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlID0gLTE7CiAgICAgICAgICAgICAgICBmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSAnJwogICAgICAgICAgICAgICAgZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmsnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua21hcCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydtYXAnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19tZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbGlzdCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfdGFibGUnXS5vcHRpb25zWzBdLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfZmllbGQnXS5vcHRpb25zWzBdLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbm9kZSddLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhUUmVzZXQoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfdmlldycpOwogICAgICAgICAgICAgICAgaWYob2Rpdikgb2Rpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInRlbXBsYXRlZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkJ10udmFsdWUgPSAtMTsKICAgICAgICAgICAgICAgIGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZSA9IC0xOwogICAgICAgICAgICAgICAgZm9ybVsnY29kZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSAnJwogICAgICAgICAgICAgICAgZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ3VybCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmttYXAnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbWFwJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ21ldGhvZCddLnZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbWV0aG9kJ11bMF0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX2xpc3QnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX3RhYmxlJ10ub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19maWVsZCddLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbm9kZSddLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsZm9ybSddOwogICAgICAgICAgICAgICAgZm9ybVsnbWV0aG9kJ11bMF0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWFRBZGQobm9kZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgWGRpdiA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieHRlbXBsYXRlZm9ybSIpOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICBYVFJlc2V0KCk7CiAgICAgICAgICAgICAgICB2YXIgeGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICB4Zm9ybVsnbm9kZWlkJ10udmFsdWUgPSBub2RlaWQ7CiAgICAgICAgICAgICAgICB2YXIgdXJsZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ1cmxmb3JtIl07CiAgICAgICAgICAgICAgICB1cmxmb3JtWydtZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ3VybCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICB1cmxmb3JtWyd1cmwnXS52YWx1ZSA9ICdodHRwOi8vJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBYVEVkaXQoZm9ybWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBYVFJlc2V0KCk7CiAgICAgICAgICAgICAgICB2YXIgeGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zW2Zvcm1pZF07CiAgICAgICAgICAgICAgICB4Zm9ybVsnb3AnXS52YWx1ZSA9ICd0ZW1wbGF0ZV91cGRhdGUnOwogICAgICAgICAgICAgICAgeGZvcm1bJ25vZGVpZCddLnZhbHVlID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsndGFibGVpZCddLnZhbHVlID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZSA9IGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydwYXR0ZXJuJ10udmFsdWUgPSBmb3JtWydwYXR0ZXJuJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnZmxhZyddLnZhbHVlID0gZm9ybVsnZmxhZyddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ25maWVsZHMnXS52YWx1ZSA9IGZvcm1bJ25maWVsZHMnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWyd1cmwnXS52YWx1ZSA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ2xpbmsnXS52YWx1ZSA9IGZvcm1bJ2xpbmsnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rbWFwJ10udmFsdWUgPSBmb3JtWydsaW5rbWFwJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbWFwJ10udmFsdWUgPSBmb3JtWydtYXAnXS52YWx1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiAxKQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiAyKQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmKHhmb3JtWydmbGFnJ10udmFsdWUgJiA0KQogICAgICAgICAgICAgICAgICAgIHhmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbWV0aG9kJ10udmFsdWUgPSAwOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnbWV0aG9kJ10udmFsdWUgPT0gMSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4Zm9ybVsnbWV0aG9kJ10udmFsdWUgPSAxOwogICAgICAgICAgICAgICAgICAgIHhmb3JtWydmbGFnJ10udmFsdWUgfD0gMTY7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgc3RybGlua21hcCA9IGZvcm1bJ2xpbmttYXAnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHN0cmxpbmttYXAgJiYgKGxpbmttYXAgPSBldmFsKHN0cmxpbmttYXApKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwWydmbGFnJ10gJiAxNikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rX21ldGhvZCddWzFdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwWydmbGFnJ10gJiA2NCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhmb3JtWydsaW5rX2xpc3QnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgZWRpdiA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd4dGVtcGxhdGVmb3JtJykpKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKChlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlZGl2JykpKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciB1cmxmb3JtID0gZG9jdW1lbnQuZm9ybXNbInVybGZvcm0iXTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ21ldGhvZCddWzBdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnZmxhZyddLnZhbHVlICYgMTYpCiAgICAgICAgICAgICAgICAgICAgdXJsZm9ybVsnbWV0aG9kJ11bMV0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICB1cmxmb3JtWyd1cmwnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgaWYoZm9ybVsndXJsJ10udmFsdWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdXJsZm9ybVsndXJsJ10udmFsdWUgPSBmb3JtWyd1cmwnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBMb2FkVVJMKHVybGZvcm0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhURGVsZXRlKG5vZGVpZCwgdGVtcGxhdGVpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG1zZyA9ICJBcmUgeW91IHN1cmUgZGVsZXRlIHRlbXBsYXRlWyIrdGVtcGxhdGVpZCsiXSBmcm9tIG5vZGVbIitub2RlaWQrIl0gPyI7CiAgICAgICAgICAgICAgICBpZihjb25maXJtKG1zZykgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGVtcGxhdGVfZGVsZXRlJm5vZGVpZD0iK25vZGVpZCsiJnRlbXBsYXRlaWQ9Iit0ZW1wbGF0ZWlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0hpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1RlbXBsYXRlcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gSGlkZGVuVGVtcGxhdGUoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGUtY29uZmlnJykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZS10ZW1wbGF0ZScpKSkKICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICBpZigoZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV92aWV3JykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlX2NvZGVfb3AnKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBpZigoZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlZGl2JykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgaWYoKGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd4dGVtcGxhdGVmb3JtJykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgWFRSZXNldCgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gY2hhbmdlVGFibGUoZm9ybSwgZnNlbGVjdGlkLCBlbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHN0cmRiID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBkYmFzZSA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciB0YWJpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIGZpZWxkc29wdGlvbnMgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBzZWxlY3QgPSBmb3JtW2ZzZWxlY3RpZF07CiAgICAgICAgICAgICAgICBpZihzZWxlY3QpIHNlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFiYXNlJykpIAogICAgICAgICAgICAgICAgICAgICYmIChzdHJkYiA9IG9kaXYuZ2V0QXR0cmlidXRlKCdkYmFzZScpKSAmJiAoZGJhc2UgPSBldmFsKHN0cmRiKSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoKHRhYmlkID0gZWwub3B0aW9uc1tlbC5zZWxlY3RlZEluZGV4XS52YWx1ZSkgPj0gMCAKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGZpZWxkcyA9IGRiYXNlWyd0YWJsZXMnXVt0YWJpZF1bJ2ZpZWxkcyddKQogICAgICAgICAgICAgICAgICAgICAgICAmJiBzZWxlY3QpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZmllbGRzKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Qub3B0aW9uc1tpKytdID0gbmV3IE9wdGlvbihmaWVsZHNbeF1bJ25hbWUnXSwgeCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChmaWVsZHNvcHRpb25zKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc2VsZWN0VVJMKGZvcm0sIGJveCwgaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgYm94ICYmIGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoYm94LmNoZWNrZWQgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2lzX3VuaXFlXycraWRdLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2lzX2xpc3RfJytpZF0uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfZmlsZV8nK2lkXS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydub2RlaWRfJytpZF0uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfdW5pcWVfJytpZF0uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydpc19saXN0XycraWRdLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfZmlsZV8nK2lkXS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ25vZGVpZF8nK2lkXS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQ29uZmlnVGVtcGxhdGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGFyciA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgY29kZSA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChwYXR0ZXJuID0gZm9ybVsncGF0dGVybiddLnZhbHVlKSAmJiAoY29kZSA9IGZvcm1bJ2NvZGUnXS52YWx1ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGNvZGUucmVwbGFjZSgvXHJ8XG4vbWlnLCcnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSBmb3JtWydsaW5rX3RhYmxlJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlaWQgPSBmb3JtWyd0ZW1wbGF0ZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSBmb3JtWydtZXRob2QnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgb3AgPSBmb3JtWydvcCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBjb25kaXRpb24gPSAibSI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX3B1YmxpYyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIHZhciBpc19pZ25vcmVjYXNlID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX2dsb2JhbCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3B1YmxpYyddLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpc19wdWJsaWMgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2lnbm9yZWNhc2UgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gKz0gImkiOyAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2dsb2JhbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciByZWcgPSBuZXcgIFJlZ0V4cChwYXR0ZXJuLCBjb25kaXRpb24pOwogICAgICAgICAgICAgICAgICAgIGlmKChhcnIgPSByZWcuZXhlYyhjb2RlKSkgJiYgYXJyLmxlbmd0aCA+IDEpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChmb3JtWydtYXAnXS52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ21hcCddLnZhbHVlKSBtYXAgPSBldmFsKGZvcm1bJ21hcCddLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnbmZpZWxkcyddLnZhbHVlID0gYXJyLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzb3B0aW9ucyA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzb3B0aW9ucyA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZigob2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRhYmFzZScpKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmRiID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2RiYXNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGJhc2UgPSBldmFsKHN0cmRiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRiYXNlICYmIGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXSAmJiB0YWJsZWlkID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdWydmaWVsZHMnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkc29wdGlvbnMgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHNvcHRpb25zICs9IGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ11beF1bJ25hbWUnXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUnK25vZGVpZCkpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyY2hpbGRzID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2NoaWxkcycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHNvcHRpb25zICs9ICI8b3B0aW9uIHZhbHVlPSciK3grIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRzb3B0aW9ucyArPSBjaGlsZHNbeF0rIiA8L29wdGlvbj5cbiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRlbXBsYXRlaWQgPj0gMCkgb3AgPSAidGVtcGxhdGVfdXBkYXRlIjsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICI8ZGl2IGNsYXNzPSd0ZW1wbGF0ZS1iYXInIG9ubW91c2Vkb3duPSciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJkaXZtb3ZlKGV2ZW50LCB0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSdkaXZyZW1vdmUoIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+WDwvc3Bhbj4mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJ0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID7lhbPpl608L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICB2YXIgIGJsb2NrID0gIjxkaXYgaWQ9J3RlbXBsYXRlLWNvbmZpZy1ibG9jayc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8Zm9ybSBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgY2xhc3M9J2xpc3Rmb3JtJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIm9uc3VibWl0PSdFZGl0VGVtcGxhdGUodGhpcywgdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbm9kZWlkJyB2YWx1ZT0nIitub2RlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSciK29wKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21ldGhvZCcgdmFsdWU9JyIrbWV0aG9kKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPSciK3RhYmxlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndGVtcGxhdGVpZCcgdmFsdWU9JyIrdGVtcGxhdGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSduZmllbGRzJyB2YWx1ZT0nIithcnIubGVuZ3RoKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICJVUkw6PGlucHV0IHR5cGU9dGV4dCBuYW1lPSd1cmwnIHNpemU9ODAgdmFsdWU9JyIrdXJsKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAi5qih54mIOjx0ZXh0YXJlYSBuYW1lPSdwYXR0ZXJuJyBjb2xzPTc2IHJvd3M9ND4iIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICtwYXR0ZXJuKyI8L3RleHRhcmVhPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19wdWJsaWMnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19wdWJsaWMpIGJsb2NrICs9ICJjaGVja2VkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5YWs5YWx5pWw5o2uIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19nbG9iYWwnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19nbG9iYWwpIGJsb2NrICs9ICJjaGVja2VkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+6YeN5aSN5Yy56YWN5aSa5p2hIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX2lnbm9yZWNhc2UnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc19pZ25vcmVjYXNlKSBibG9jayArPSAiY2hlY2tlZCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuW/veeVpeWkp+Wwj+WGmSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMTsgaSA8IGFyci5sZW5ndGg7aSsrKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkgPCAxMCkgYmxvY2sgKz0gJzAnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gaSsiOiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHRleHRhcmVhIG5hbWU9J3JfIitpKyInIGNvbHM9NzYgcm93cz0xIHJlYWRvbmx5L2Rpc2FibGVkPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBhcnJbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC90ZXh0YXJlYT48YnI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfoh6rliqjmi7zmjqXkuLrlrozmiJDpk77mjqUnPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfdXJsXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBvbmNsaWNrPSdzZWxlY3RVUkwodGhpcy5mb3JtLHRoaXMsIitpKyIpJz7pk77mjqU8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n6ZO+5o6l5qCH6K+G5LiA5p2h5a6M5pW05L+h5oGv55qE57uT5p2fJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX3VuaXFlXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcFtpLTFdWydmbGFnJ10gJiAzMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgZGlzYWJsZWQ9dHJ1ZSAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7moIfor4bmgKfpk77mjqU8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfliJfooajpobXlsIbkvJrkvJjlhYjkuIvovb3lubbkuJTkvJrlrprmnJ/mm7TmlrAnPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfbGlzdF8iK2krIiciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIG1hcFtpLTFdWydmbGFnJ10gJiAxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXBbaS0xXVsnZmxhZyddICYgNjQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiIGRpc2FibGVkPXRydWUgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5YiX6KGo6aG1PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n5LiL6L295a2Y5YKo5Li65paH5Lu25q+U5aaCOuWbvueJhyxtcDPnrYknPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfZmlsZV8iK2krIiciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIG1hcFtpLTFdWydmbGFnJ10gJiAxKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXBbaS0xXVsnZmxhZyddICYgMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgZGlzYWJsZWQ9dHJ1ZSAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7mlofku7Y8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfljrvmjolodG1s5qCH562+5ZCO55qE5paH5pys5YaF5a65Jz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX25lZWRfY2xlYXJodG1sXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDQpIGJsb2NrICs9ICIgY2hlY2tlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7ljrtIVE1MPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiB0aXRsZT0n5Y675o6J55aR5Ly85bm/5ZGK55qE6YOo5YiG5YaF5a6577yM6K+l5Yqf6IO96LCo5oWO5L2/55SoJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX25lZWRfYW50aXNwYW1fIitpKyInIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmxhZyddICYgOCkgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuWOu+W5v+WRijwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNlbGVjdCBuYW1lPSdmaWVsZGlkXyIraSsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7lr7nlupTlrZfmrrU8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIHRhYmxlaWQgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBkYmFzZVsndGFibGVzJ11bdGFibGVpZF1bJ2ZpZWxkcyddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZpZWxkaWQnXSA9PSB4KSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgc2VsZWN0ZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj4iK2RiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ11beF1bJ25hbWUnXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyI8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBmaWVsZHNvcHRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc2VsZWN0PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNlbGVjdCBuYW1lPSdub2RlaWRfIitpKyInICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgKG1hcFtpLTFdWydmbGFnJ10gJiAxKSkgYmxvY2sgKz0gIiAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBibG9jayArPSAiIGRpc2FibGVkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuWFs+iBlOiKgueCuTwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gY2hpbGRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ25vZGVpZCddID09IHgpIGJsb2NrICs9ICIgc2VsZWN0ZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj4iKyBjaGlsZHNbeF0rIiA8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBjaGlsZHNvcHRpb25zOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc2VsZWN0PiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J09LJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvZm9ybT48L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLWNvbmZpZycpKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gc3RyICsgYmxvY2s7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaWQgPSAndGVtcGxhdGUtY29uZmlnJzsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdndpZHRoID0gNzAwOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbmZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4bGVmdCA9IHBhcnNlSW50KG9ib2R5Lm9mZnNldFdpZHRoKSAtIGRpdndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IG9ib2R5Lm9mZnNldExlZnQgKyh4bGVmdC8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSAyMCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0geSsncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZGl2d2lkdGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuaWQgPSAndGVtcGxhdGUtY29uZmlnLWZyYW1lJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LndyaXRlKGJsb2NrKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFRlc3RUZW1wbGF0ZShmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9ICIiOwogICAgICAgICAgICAgICAgdmFyIGxpbmsgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBjb2RlID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBjb25kaXRpb24gPSAibSI7CiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSAwOwogICAgICAgICAgICAgICAgdmFyIGlzX2dsb2JhbD0gMDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKHBhdHRlcm4gPSBmb3JtWydwYXR0ZXJuJ10udmFsdWUpCiAgICAgICAgICAgICAgICAgICAgJiYgKGNvZGUgPSBmb3JtWydjb2RlJ10udmFsdWUpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHBhdHRlcm4gPSBwYXR0ZXJuLnJlcGxhY2UoL1xyfFxuL21pZywnJyk7CiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGNvZGUucmVwbGFjZSgvXHJ8XG4vbWlnLCcnKTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uICs9ICJpIjsgCiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2dsb2JhbCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbiArPSAiZyI7IAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHBhdHRlcm4pOwogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoY29uZGl0aW9uKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3ICBSZWdFeHAocGF0dGVybiwgY29uZGl0aW9uKTsKICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGlmKGlzX2dsb2JhbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKChhcnIgPSByZWcuZXhlYyhjb2RlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGFyci5sZW5ndGggPiAxKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyclswXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzW2NvdW50KytdID0gYXJyOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChhcnIgPSByZWcuZXhlYyhjb2RlKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBhcnIubGVuZ3RoID4gMSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc1tjb3VudCsrXSA9IGFycjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihjb3VudCA+IDApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gIjxkaXYgaWQ9J3RlbXBsYXRlLXRlc3QtaGVhZGVyJyBvbm1vdXNlZG93bj0nIjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJkaXZtb3ZlKGV2ZW50LCB0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPlg8L3NwYW4+Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPuWFs+mXrTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO01hdGNoIFJlc3VsdCBDb3VudDoiK2NvdW50KyI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxkaXYgaWQ9J3RlbXBsYXRlLW1hdGNoZXMnID4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSBmb3JtWydsaW5rJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGNvdW50OyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmspIHVybCA9IGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuPnJlc3VsdDoiK2krIjxocj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGogPSAxOyBqIDwgbWF0Y2hlc1tpXS5sZW5ndGg7IGorKykgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaiA8IDEwKSBzdHIgKz0gIjAiOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gaisiOjx0ZXh0YXJlYSBjb2xzPTc2IHJvd3M9MT4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICttYXRjaGVzW2ldW2pdKyI8L3RleHRhcmVhPjxicj4iOyAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnID0gbmV3IFJlZ0V4cCgiPCIraisiPiIsICJpZyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShyZWcsIG1hdGNoZXNbaV1bal0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIlVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9NDggdmFsdWU9JyIrdXJsKyInPjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLXRlc3QnKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IHN0cjsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9ICd0ZW1wbGF0ZS10ZXN0JzsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdndpZHRoID0gNzAwOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbmZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4bGVmdCA9IHBhcnNlSW50KG9ib2R5Lm9mZnNldFdpZHRoKSAtIGRpdndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IG9ib2R5Lm9mZnNldExlZnQgKyh4bGVmdC8yKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSAyMCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0geSsncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZGl2d2lkdGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAvKgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuaWQgPSAndGVtcGxhdGUtdmlld2VyJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJsb2NrID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGNvdW50OyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmspIHVybCA9IGxpbms7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNwYW4gY2xhc3M9J2N0eHRfYmxvY2snPlJlc3VsdDoiK2krIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaiA9IDE7IGogPCBtYXRjaGVzW2ldLmxlbmd0aDsgaisrKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihqIDwgMTApIGJsb2NrICs9ICIwIjsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gaisiOjx0ZXh0YXJlYSBjb2xzPTc2IHJvd3M9MT4iIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbWF0Y2hlc1tpXVtqXSsiPC90ZXh0YXJlYT48YnI+IjsgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGluaykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZyA9IG5ldyBSZWdFeHAoIjwiK2orIj4iLCAiaWciKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UocmVnLCBtYXRjaGVzW2ldW2pdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih1cmwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIlVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9NDggdmFsdWU9JyIrdXJsKyInPjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50Lm9wZW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC53cml0ZShibG9jayk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBTaG93VGVtcGxhdGVzKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGFyciA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLXRlbXBsYXRlJyk7CiAgICAgICAgICAgICAgICBpZihlZGl2KSBlZGl2LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgaWYodHh0ICYmIGVkaXYgJiYgKGFyciA9IGV2YWwodHh0KSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh0eHQpOwogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gYXJyWydpZCddOwogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1waWQgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBmbGFnID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBzdHJtYXAgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5maWVsZHMgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RybGlua21hcCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gYXJyWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydub2RlaWQnXS52YWx1ZSA9IG5vZGVpZDsKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICAiPHVsIGNsYXNzPSd1bHRhYicgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0ndGVtcGxhdGUtaGVhZGVyJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICLovpPlhaVVUkzmtYvor5XmqKHniYgiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICLnhLblkI7mt7vliqDliLAmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IG5hbWUgKyAiWyIgKyBhcnJbJ250ZW1wbGF0ZXMnXSArICJdIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGFyclsnbnRlbXBsYXRlcyddOyBpKyspCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gYXJyWyd0ZW1wbGF0ZXMnXVtpXTsKICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9IGJhc2U2NHN0cmRlY29kZSh0ZW1wWydwYXR0ZXJuJ10pOwogICAgICAgICAgICAgICAgICAgICAgICBmbGFnID0gdGVtcFsnZmxhZ3MnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGlkID0gdGVtcFsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVpZCA9IHRlbXBbJ3RhYmxlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgbWFwID0gdGVtcFsnbWFwJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmttYXAgPSB0ZW1wWydsaW5rbWFwJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cm1hcCA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RybWFwID0gIntbIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIG1hcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJtYXAgKz0gIntmaWVsZGlkOiIrbWFwW3hdWydmaWVsZGlkJ10rICIsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJub2RlaWQ6IittYXBbeF1bJ25vZGVpZCddKyAiLCIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmxhZzoiK21hcFt4XVsnZmxhZyddKyAifSI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCA8IChtYXAubGVuZ3RoIC0gMSkpIHN0cm1hcCArPSAiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJtYXAgKz0gIl19IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdHJsaW5rbWFwID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmxpbmttYXAgPSAiKHsiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmllbGRpZDonIitsaW5rbWFwWydmaWVsZGlkJ10rIicsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIm5vZGVpZDonIitsaW5rbWFwWydub2RlaWQnXSsiJywiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiZmxhZzonIitsaW5rbWFwWydmbGFnJ10rIiciIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsifSkiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHRlbXBbJ3VybCddOwogICAgICAgICAgICAgICAgICAgICAgICBsaW5rID0gdGVtcFsnbGluayddOwogICAgICAgICAgICAgICAgICAgICAgICBpZihpJTIpIGNzc25hbWUgPSAnbHRlbXBsYXRlJzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBjc3NuYW1lID0gJ2x0ZW1wbGF0ZS1obCc7CiAgICAgICAgICAgICAgICAgICAgICAgIG5maWVsZHMgPSB0ZW1wWyduZmllbGRzJ10rMTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGZvcm0gYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCknIGNsYXNzPSdsaXN0Zm9ybScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG5hbWU9J3hmb3JtIit0ZW1waWQrIicgb25zdWJtaXQ9J1hURWRpdCh0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSciK2Nzc25hbWUrIicgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjx0ZXh0YXJlYSBuYW1lPSdwYXR0ZXJuJyBjb2xzPTgwIHJvd3M9MSByZWFkb25seS9kaXNhYmxlZCA+IiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICtwYXR0ZXJuKyI8L3RleHRhcmVhPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdub2RlaWQnIHZhbHVlPSciK25vZGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndGVtcGxhdGVpZCcgdmFsdWU9JyIrdGVtcGlkKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdmbGFnJyB2YWx1ZT0nIitmbGFnKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0YWJsZWlkJyB2YWx1ZT0nIit0YWJsZWlkKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSduZmllbGRzJyB2YWx1ZT0nIituZmllbGRzKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdtYXAnIHZhbHVlPSciK3N0cm1hcCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbGluaycgdmFsdWU9JyIrbGluaysiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbGlua21hcCcgdmFsdWU9XCIiK3N0cmxpbmttYXArIlwiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd1cmwnIHZhbHVlPSciK3VybCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXVwZGF0ZScgdGl0bGU9J0NoYW5nZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIlhURWRpdCgneGZvcm0iK3RlbXBpZCsiJylcIiA+IitjaHJlZGl0KyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hURGVsZXRlKCIrbm9kZWlkKyIsICIrdGVtcGlkKyIpJz4iK2NocmRlbCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9mb3JtPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICBlZGl2LmlubmVySFRNTCA9IGh0bWxzdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVmlld1RlbXBsYXRlcyhub2RlaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvbGRub2RlaWQgPSBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ25vZGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgaWYob2xkbm9kZWlkICE9IG5vZGVpZCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBIaWRkZW5UZW1wbGF0ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgRm9sZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZF8nK25vZGVpZCkpOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10ZW1wbGF0ZV9saXN0Jm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1RlbXBsYXRlcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWFRBZGQobm9kZWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2VkaXQgTGluawogICAgICAgICAgICBmdW5jdGlvbiBFZGl0TGluayhmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbGluayA9ICIiOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAobGluayA9IGZvcm1bJ2xpbmsnXS52YWx1ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSBmb3JtWydsaW5rX3RhYmxlJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlaWQgPSBmb3JtWyd0ZW1wbGF0ZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBmb3JtWydwYXR0ZXJuJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSBmb3JtWydsaW5rJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBmbGFnID0gODsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDQ7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbWV0aG9kJ10udmFsdWUgPT0gMSkgZmxhZyB8PSAxNjsKICAgICAgICAgICAgICAgICAgICB2YXIgbGlua19mbGFnID0gMDsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydsaW5rX21ldGhvZCddWzFdLmNoZWNrZWQgPT0gdHJ1ZSkgbGlua19mbGFnIHw9IDE2OwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2xpbmtfbGlzdCddLmNoZWNrZWQgPT0gdHJ1ZSkgbGlua19mbGFnIHw9IDY0OwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gIlsiICsgZm9ybVsnbGlua19maWVsZCddLnZhbHVlICsgJywnCiAgICAgICAgICAgICAgICAgICAgICAgICsgZm9ybVsnbGlua19ub2RlJ10udmFsdWUgKyAnLCcKICAgICAgICAgICAgICAgICAgICAgICAgKyBsaW5rX2ZsYWcgKyAnXSc7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChsaW5rbWFwKTsKICAgICAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAibm9kZWlkPSIrbm9kZWlkKyImdGFibGVpZD0iK3RhYmxlaWQrIiZmbGFnPSIrZmxhZwogICAgICAgICAgICAgICAgICAgICAgICArIiZsaW5rbWFwPSIrZW5jb2RlVVJJQ29tcG9uZW50KGxpbmttYXApCiAgICAgICAgICAgICAgICAgICAgICAgICsiJmxpbms9IitlbmNvZGVVUklDb21wb25lbnQobGluaykKICAgICAgICAgICAgICAgICAgICAgICAgKyImcGF0dGVybj0iK2VuY29kZVVSSUNvbXBvbmVudChwYXR0ZXJuKTsKICAgICAgICAgICAgICAgICAgICBpZih1cmwpIGFyZ3YgKz0gIiZ1cmw9IitlbmNvZGVVUklDb21wb25lbnQodXJsKTsKICAgICAgICAgICAgICAgICAgICBpZihvcCA9PSAndGVtcGxhdGVfYWRkJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZvcD10ZW1wbGF0ZV9hZGQiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICd0ZW1wbGF0ZV91cGRhdGUnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJm9wPXRlbXBsYXRlX3VwZGF0ZSZ0ZW1wbGF0ZWlkPSIrdGVtcGxhdGVpZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9wID09ICd0ZW1wbGF0ZV9hZGQnKSBSZXNldFRlbXBsYXRlZm9ybSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIEhpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dUZW1wbGF0ZXMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vZWRpdCB0ZW1wbGF0ZQogICAgICAgICAgICBmdW5jdGlvbiBFZGl0VGVtcGxhdGUoZm9ybSwgZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSBmb3JtWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZWlkID0gZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSBmb3JtWyd0YWJsZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9IGZvcm1bJ3BhdHRlcm4nXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB1cmwgPSBmb3JtWyd1cmwnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBtZXRob2QgPSBmb3JtWydtZXRob2QnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBmbGFnID0gMDsKICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3B1YmxpYyddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDI7CiAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDQ7CiAgICAgICAgICAgICAgICBpZihtZXRob2QgPT0gMSkgZmxhZyB8PSAxNjsKICAgICAgICAgICAgICAgIHZhciBuZmllbGRzID0gZm9ybVsnbmZpZWxkcyddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZpZWxkaWQgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGlzX3VybCA9IDA7CiAgICAgICAgICAgICAgICB2YXIgaXNfZmlsZSA9IDA7CiAgICAgICAgICAgICAgICB2YXIgaXNfbmVlZF9jbGVhcmh0bWwgPSAwOwogICAgICAgICAgICAgICAgdmFyIGlzX25lZWRfYW50aXNwYW0gPSAwOwogICAgICAgICAgICAgICAgdmFyIGNoaWxkX25vZGVpZCA9IDA7CiAgICAgICAgICAgICAgICB2YXIgY2hpbGRfZmxhZyA9IDA7CiAgICAgICAgICAgICAgICB2YXIgbWFwID0gInsiOwogICAgICAgICAgICAgICAgZm9yKGkgPSAxOyBpIDwgbmZpZWxkczsgaSsrKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZpZWxkaWQgPSAgZm9ybVsnZmllbGRpZF8nK2ldLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyA9IDA7CiAgICAgICAgICAgICAgICAgICAgbm9kZV9pZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3VybF8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfdW5pcWVfJytpXS5jaGVja2VkID09IHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gMzI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2ZpbGVfJytpXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2xpc3RfJytpXS5jaGVja2VkID09IHRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gNjQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfaWQgPSBmb3JtWydub2RlaWRfJytpXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfbmVlZF9jbGVhcmh0bWxfJytpXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgfD0gNDsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19uZWVkX2FudGlzcGFtXycraV0uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDg7CiAgICAgICAgICAgICAgICAgICAgbWFwICs9ICJbIitmaWVsZGlkKyIsIitub2RlX2lkKyIsIitub2RlX2ZsYWcrIl0iOwogICAgICAgICAgICAgICAgICAgIGlmKGkgPCAobmZpZWxkcyAtIDEpKSBtYXAgKz0gIjsiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWFwICs9ICJ9IjsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm5vZGVpZD0iK25vZGVpZCsiJnRhYmxlaWQ9Iit0YWJsZWlkKyImZmxhZz0iIAogICAgICAgICAgICAgICAgICAgICtmbGFnKyImbWFwPSIrZW5jb2RlVVJJQ29tcG9uZW50KG1hcCkKICAgICAgICAgICAgICAgICAgICArIiZwYXR0ZXJuPSIrZW5jb2RlVVJJQ29tcG9uZW50KHBhdHRlcm4pOwogICAgICAgICAgICAgICAgaWYodXJsKSBhcmd2ICs9ICImdXJsPSIrZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7CiAgICAgICAgICAgICAgICBpZihvcCA9PSAndGVtcGxhdGVfYWRkJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImb3A9dGVtcGxhdGVfYWRkIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYob3AgPT0gJ3RlbXBsYXRlX3VwZGF0ZScpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJm9wPXRlbXBsYXRlX3VwZGF0ZSZ0ZW1wbGF0ZWlkPSIrdGVtcGxhdGVpZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXZyZW1vdmUoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3AgPT0gJ3RlbXBsYXRlX2FkZCcpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXNldFRlbXBsYXRlZm9ybSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhpZGRlblRlbXBsYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1RlbXBsYXRlcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9kYXRhYmFzZQogICAgICAgICAgICBmdW5jdGlvbiBzZWxlY3RWaWV3KGRpdiwgZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGVsaXN0ID0gbmV3IEFycmF5KCd0YXNraW5mbycsJ2RhdGFiYXNlJywgJ3RlbXBsYXRlJywgCiAgICAgICAgICAgICAgICAgICAgJ3VybGJsb2NrJywgJ2RhdGEnLCAnZG5zJywgJ3Byb3h5JywgJ3VzZXInKTsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIG9saSA9IG51bGwsIG9iID0gbnVsbCwgb2RpdiA9IG51bGw7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKCk7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBlbGlzdC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZigob2xpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RhYicraSkpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYob2xpID09IGVsZW1lbnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGkuY2xhc3NOYW1lID0gJ3RhYi1zZWxlY3RlZCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGkuY2xhc3NOYW1lID0gJyc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGRpdiA9PSBlbGlzdFtpXSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxpc3RbaV0pOwogICAgICAgICAgICAgICAgICAgICAgICBvYi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGlzdFtpXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9kaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxpc3RbaV0gPT0gJ3Rhc2tpbmZvJykgCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9UaW1lcikgd2luZG93LmNsZWFySW50ZXJ2YWwob1RpbWVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9UaW1lciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihlbGlzdFtpXSA9PSAnZGF0YWJhc2UnKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGl2Zm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZvcm0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRpdmZvcm0pIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RiZmllbGRmb3JtJykpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGVsaXN0W2ldID09ICd0ZW1wbGF0ZScpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R4dGZvcm0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRpdmZvcm0pIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLXRlc3QnKSkpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlLWNvbmZpZycpKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2Zm9ybS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZWxpc3RbaV0gPT0gJ3VybGJsb2NrJykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdmZvcm0gPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybGxpc3QtZm9ybScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGl2Zm9ybSkgZGl2Zm9ybS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGRpdmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjb3JkLXZpZXcnKSkpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGRpdiA9PSAndGFza2luZm8nKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoJ09LJyk7CiAgICAgICAgICAgICAgICAgICAgbG9hZFRhc2tJbmZvKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAnZGF0YWJhc2UnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBvZGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJzZWxlY3QnKTsKICAgICAgICAgICAgICAgICAgICBpZihvZGIuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFRhYmxlcygpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICd0ZW1wbGF0ZScpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRyZWVib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RyZWVib2R5Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYodHJlZWJvZHkuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgQWRkTm9kZSgtMSwwLCJSb290IiwwKTsKICAgICAgICAgICAgICAgICAgICAgICAgRm9sZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZm9sZF8wJykpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICd1cmxibG9jaycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybGJsb2NrID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybGJsb2NrJyk7CiAgICAgICAgICAgICAgICAgICAgaWYodXJsYmxvY2spCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB1cmxibG9jay5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmxsaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3QuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3VybGJsb2NrZm9ybSddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFBOb2RlcygwKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICdkYXRhJykKICAgICAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAnZG5zJykKICAgICAgICAgICAgICAgIC8vJiYgb2IuaW5uZXJIVE1MID09ICcnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0RE5TTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIExpc3RETlMoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICdwcm94eScpCiAgICAgICAgICAgICAgICAvLyYmIG9iLmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFByb3h5TGlzdCgpOwogICAgICAgICAgICAgICAgICAgIExpc3RQcm94eSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihkaXYgPT0gJ3VzZXInKQogICAgICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBsb2FkVGFza0luZm8oKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBWaWV3VGFzaygndGFza192aWV3Jyk7CiAgICAgICAgICAgICAgICBvVGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoIlZpZXdUYXNrKCd0YXNrX3ZpZXcnKSIsIDEwMDAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBHZXRDb250ZW50KHVybCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ0dFVCcsIHVybCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgLy94bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIC8veG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChudWxsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5EQkZpZWxkZm9ybSgpOwogICAgICAgICAgICB9CgkgICAgICAgIGZ1bmN0aW9uIGdldEZyYW1lRG9jdW1lbnQoaWQpCgkgICAgICAgIHsKCSAgICAgICAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CgkgICAgICAgICAgICB2YXIgRG9jID0gbnVsbDsKCSAgICAgICAgICAgIGlmKGlmcmFtZSkKCSAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICBpZihpZnJhbWUuZG9jdW1lbnQpCgkgICAgICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgICAgICBEb2MgPSBpZnJhbWUuZG9jdW1lbnQ7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYoaWZyYW1lLmNvbnRlbnREb2N1bWVudCkgLy8gRm9yIE5TNgoJICAgICAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICAgICAgRG9jID0gaWZyYW1lLmNvbnRlbnREb2N1bWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZihpZnJhbWUuY29udGVudFdpbmRvdykKCSAgICAgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgICAgIERvYyA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpZihEb2MpCgkgICAgICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgICAgICBpZihEb2MuZGVzaWduTW9kZSkgRG9jLmRlc2lnbk1vZGUgPSAnT24nOwoJICAgICAgICAgICAgICAgICAgICBpZihEb2MuY29udGVudEVkaXRhYmxlKSBEb2MuY29udGVudEVkaXRhYmxlID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXR1cm4gRG9jOwoJICAgICAgICB9CgkgICAgICAgIGZ1bmN0aW9uIGdldFNlbGVjdENvbnRlbnQoaWQpCgkgICAgICAgIHsKCSAgICAgICAgICAgIHZhciBEb2MgPSBnZXRGcmFtZURvY3VtZW50KGlkKTsKCSAgICAgICAgICAgIGlmKERvYykKCSAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihEb2MuZ2V0U2VsZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICAgICAgYWxlcnQoRG9jLmdldFNlbGVjdGlvbigpLnBhcmVudE5vZGUuaW5uZXJIVE1MKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihEb2Muc2VsZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoRG9jLnNlbGVjdGlvbi5wYXJlbnROb2RlLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdTZWxlY3QoZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgICAgICBpZihlbGVtZW50LmlubmVySFRNTCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChlbGVtZW50LnBhcmVudE5vZGUuaW5uZXJIVE1MKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMb2FkTGlua09wdGlvbnMoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgdmFyIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGxpbmttYXAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9zZWxlY3QgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGRiYXNlID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAobm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWUpID4gMCApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbGlua21hcCddLnZhbHVlKSBsaW5rbWFwID0gZXZhbChmb3JtWydsaW5rbWFwJ10udmFsdWUpOwogICAgICAgICAgICAgICAgICAgIGZsYWcgPSBmb3JtWydmbGFnJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdGFibGVpZCA9IGZvcm1bJ3RhYmxlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBpZigob2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRhYmFzZScpKQogICAgICAgICAgICAgICAgICAgICAgICAmJiAoc3RyZGIgPSBvZGl2LmdldEF0dHJpYnV0ZSgnZGJhc2UnKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChkYmFzZSA9IGV2YWwoc3RyZGIpKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3QgPSBmb3JtWydsaW5rX3RhYmxlJ107CiAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBpID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gZGJhc2VbJ3RhYmxlcyddKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZSA9IGRiYXNlWyd0YWJsZXMnXVt4XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXSA9IG5ldyBPcHRpb24odGFibGVbJ25hbWUnXSwgeCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwICYmIHggPT0gdGFibGVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXAgJiYgdGFibGVpZCAgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkcyA9IGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0ID0gZm9ybVsnbGlua19maWVsZCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGZpZWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0gPSBuZXcgT3B0aW9uKGZpZWxkc1t4XVsnbmFtZSddLCB4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwICYmIGZsYWcgPj0gMCAmJiAoZmxhZyAmIDgpICYmIHggPT0gbGlua21hcFsnZmllbGRpZCddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciBzdHJjaGlsZHMgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUnK25vZGVpZCkpCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChzdHJjaGlsZHMgPSBvZGl2LmdldEF0dHJpYnV0ZSgnY2hpbGRzJykpIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAoY2hpbGRzID0gZXZhbChzdHJjaGlsZHMpKSApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoZm9ybVsnbGlua21hcCddLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdCA9IGZvcm1bJ2xpbmtfbm9kZSddOwogICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2hpbGRzKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0gPSBuZXcgT3B0aW9uKGNoaWxkc1t4XSwgeCk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXAgJiYgeCA9PSBsaW5rbWFwWydub2RlaWQnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsraTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgkJICAgIGZ1bmN0aW9uIExvYWRVUkwoZm9ybSkKCQkgICAgewoJCSAgICAgICAgdmFyIHVybCA9IGZvcm1bJ3VybCddLnZhbHVlOwoJCSAgICAgICAgaWYodXJsKQoJCSAgICAgICAgewoJCSAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKCQkgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKCQkgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0VVJMID0gJy9wcm94eS8nK3VybDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbWV0aG9kJ11bMV0uY2hlY2tlZCA9PSB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9zID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigocG9zID0gdXJsLmluZGV4T2YoJz8nKSkgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0VVJMID0gJy9wcm94eS8nK3VybC5zdWJzdHJpbmcoMCwgcG9zLTEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSB1cmwuc3Vic3RyaW5nKHBvcyArIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVUkwgPSAnL3Byb3h5LycrdXJsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsIHJlcXVlc3RVUkwsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVSTCA9ICcvcHJveHkvJyt1cmw7CgkJICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ0dFVCcsIHJlcXVlc3RVUkwsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJndiA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQoJCSAgICAgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCgkJICAgICAgICAgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQoJCSAgICAgICAgICAgICAgICAgICAgICAgIHsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9IHhtbEh0dHAucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWRpdiA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV9jb2RlX29wJykpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXYuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfdmlldycpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50KSBlbGVtZW50LmlubmVySFRNTCA9ICIiOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuc2V0QXR0cmlidXRlKCJpZCIsICdlZGl0b3ItZnJhbWUnKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZSk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBudWxsOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZG9jID0gZ2V0RnJhbWVEb2N1bWVudCgnZWRpdG9yLWZyYW1lJykpKQoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9IHN0cjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0ci5tYXRjaCgvPGJhc2UgLio/aHJlZj0uKj8+L2kpID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2V1cmwgPSB1cmw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChwb3MgPSB1cmwubGFzdEluZGV4T2YoJy8nKSkgPiA2KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZXVybCA9IHVybC5zdWJzdHJpbmcoMCwgcG9zKzEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmFzZWhyZWYgPSAiPGhlYWQ+PGJhc2UgaHJlZj0nIitiYXNldXJsKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciA9IHN0ci5yZXBsYWNlKC88aGVhZD4vaSwgYmFzZWhyZWYpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLm9wZW4oKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy53cml0ZShodG1sc3RyKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5jbG9zZSgpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBsYXRlZGl2JykpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRpdi5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ2NvZGUnXS52YWx1ZSA9IHN0cjsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmZvcm1zWyd0ZW1wbGF0ZWZvcm0nXVsndXJsJ10udmFsdWUgPSB1cmw7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ21ldGhvZCddLnZhbHVlID0gbWV0aG9kOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmZvcm1zWyd0ZW1wbGF0ZWZvcm0nXVsnY29kZSddLnZhbHVlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSB4bWxIdHRwLmdldEFsbFJlc3BvbnNlSGVhZGVycygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJfd2FpdCgpOwoJCSAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRfd2FpdCgpOwoJCSAgICAgICAgICAgIH0KCQkgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBWaWV3RGF0YWJhc2UoKTsKCQkgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldERpdihpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICAgICAgICAgICAgICAgIGlmKGRpdikgZGl2LmlubmVySFRNTCA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0VVJMTGlzdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3VybGJsb2NrZm9ybSddOwogICAgICAgICAgICAgICAgaWYoZm9ybSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldERpdigndXJsLWxpc3QnKTsKICAgICAgICAgICAgICAgICAgICBmb3JtWydsZXZlbCddLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ3VybCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsndXJsJ10udmFsdWUgPSAnaHR0cDovLyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGlzdFBOb2Rlcyhub2RlaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3VybGJsb2NrZm9ybSddOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiBub2RlaWQgPj0gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICIiOwogICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9bm9kZV9icm90aGVyJm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPW5vZGVfY2hpbGRzJm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1Jlc2V0VVJMTGlzdCgpOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bm9kZSA9IGV2YWwoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3NlbGVjdCA9IGZvcm1bJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihvc2VsZWN0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gMCwgeCA9IDEsIHRpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG5hbWUgPSAiLi4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodG5vZGVbJ2lkJ10gPiAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1t4KytdPW5ldyBPcHRpb24odG5hbWUsIHRub2RlWydpZCddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IHRub2RlWyduY2hpbGRzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWQgPSB0bm9kZVsnY2hpbGRzJ11baV1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG5hbWUgPSB0bm9kZVsnY2hpbGRzJ11baV1bJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPT0gdGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbeF0gPSBuZXcgT3B0aW9uKHRuYW1lLCB0aWQsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW3hdID0gbmV3IE9wdGlvbih0bmFtZSwgdGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK3g7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG1vdmVDaGlsZE5vZGVzKGZvcm0sIG5vZGVpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9saXN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBvY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG9saXN0ID0gZm9ybVsnbm9kZWlkJ10pICYmIChvY2hpbGRzID0gZm9ybVsnY2hpbGRzJ10pKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9saXN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICB4ID0gMTsKICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDE7IGkgPCBvY2hpbGRzLm9wdGlvbnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0bmFtZSA9IG9jaGlsZHMub3B0aW9uc1tpXS50ZXh0OwogICAgICAgICAgICAgICAgICAgICAgICB0aWQgPSBvY2hpbGRzLm9wdGlvbnNbaV0udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRuYW1lID09ICcqJykgdG5hbWUgPSAnLi4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZWlkID09IHRpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGlzdC5vcHRpb25zW3grK10gPSBuZXcgT3B0aW9uKHRuYW1lLCB0aWQsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGlzdC5vcHRpb25zW3grK10gPSBuZXcgT3B0aW9uKHRuYW1lLCB0aWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG9jaGlsZHMub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3ROb2RlVVJMcyhmb3JtLCBvbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG5vZGVpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgb3NlbGVjdCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAwOwogICAgICAgICAgICAgICAgdmFyIG90ZXh0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG9zZWxlY3QgPSBmb3JtW29uYW1lXSkgJiYgKGluZGV4ID0gb3NlbGVjdC5zZWxlY3RlZEluZGV4KSA+IDAgCiAgICAgICAgICAgICAgICAgICAgJiYgKG5vZGVpZCA9IG9zZWxlY3Qub3B0aW9uc1tpbmRleF0udmFsdWUpID49IDAgCiAgICAgICAgICAgICAgICAgICAgJiYgKG90ZXh0ID0gb3NlbGVjdC5vcHRpb25zW2luZGV4XS50ZXh0KSAhPSAnKicpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYob25hbWUgPT0gJ2NoaWxkcycpIG1vdmVDaGlsZE5vZGVzKGZvcm0sIG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSBmb3JtWydsZXZlbCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIFJlc2V0VVJMTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBMaXN0VVJMcygnbGlzdCcsIG5vZGVpZCwgbGV2ZWwsIDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdDaGlsZHNVUkwodXJsbm9kZWlkLCBsZXZlbCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKHVybG5vZGVpZCA+PSAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0VVJMTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXVybG5vZGVfY2hpbGRzJnVybG5vZGVpZD0iK3VybG5vZGVpZCsiJnBhZ2U9IitwYWdlOwogICAgICAgICAgICAgICAgICAgIGlmKGxldmVsID49IDApIGFyZ3YgKz0gIiZsZXZlbD0iK2xldmVsOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93Tm9kZVVSTHMoeG1sSHR0cC5yZXNwb25zZVRleHQsIHBhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgZnVuY3Rpb24gTGlzdFVSTHModHlwZSwgbm9kZWlkLCBsZXZlbCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+PSAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0VVJMTGlzdCgpOwogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaWYodHlwZSA9PSAnbGlzdCcpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPXVybG5vZGVfbGlzdCZub2RlaWQ9Iitub2RlaWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9dXJsbm9kZV9jaGlsZHMmdXJsbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImcGFnZT0iK3BhZ2U7CiAgICAgICAgICAgICAgICAgICAgaWYobGV2ZWwgPj0gMCkgYXJndiArPSAiJmxldmVsPSIrbGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgcGFnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdSZWNvcmRzKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG5yZWNvcmRzID0gMDsKICAgICAgICAgICAgICAgIHZhciByZXMgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHJlY29yZHMgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHggPSAwOwogICAgICAgICAgICAgICAgaWYodHh0ICYmIChyZXMgPSBldmFsKHR4dCkpICE9IG51bGwgJiYgKHJlY29yZHMgPSByZXNbJ3JlY29yZHMnXSkgCiAgICAgICAgICAgICAgICAgICAgJiYgKG5yZWNvcmRzID0gcmVzWyducmVjb3JkcyddKSA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICI8ZGl2IGlkPSdyZWNvcmQtaGVhZGVyJyBvbm1vdXNlZG93bj0nIjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJkaXZtb3ZlKGV2ZW50LCB0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPlg8L3NwYW4+Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPuWFs+mXrTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO+e7k+aenDoiK25yZWNvcmRzKyI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxkaXYgaWQ9J3JlY29yZC1yZXMnID4iOwogICAgICAgICAgICAgICAgICAgIGZvcih4IGluIHJlY29yZHMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdyZWNvcmQtdGl0bGUnPiIrcmVjb3Jkc1t4XVsnbmFtZSddKyI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gPiIKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8dGV4dGFyZWEgY29scz05MCByb3dzPTQgPiIrYmFzZTY0c3RyZGVjb2RlKHJlY29yZHNbeF1bJ2RhdGEnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsiPC90ZXh0YXJlYT48YnI+IjsgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGlmKChlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29yZC12aWV3JykpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gc3RyOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaWQgPSAncmVjb3JkLXZpZXcnOwogICAgICAgICAgICAgICAgICAgIHZhciBkaXZ3aWR0aCA9IDc1MDsKICAgICAgICAgICAgICAgICAgICB2YXIgb2JvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbmZyYW1lJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHhsZWZ0ID0gcGFyc2VJbnQob2JvZHkub2Zmc2V0V2lkdGgpIC0gZGl2d2lkdGg7CiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBvYm9keS5vZmZzZXRMZWZ0ICsoeGxlZnQvMik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSAyMCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHgrJ3B4JzsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnRvcCA9IHkrJ3B4JzsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gZGl2d2lkdGggKyAncHgnOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICAgICAgb3ZlckJGcmFtZShlbGVtZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3UmVjb3JkKHJlY29yZGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYocmVjb3JkaWQgPiAwICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXJlY29yZF92aWV3JnJlY29yZGlkPSIrcmVjb3JkaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdSZWNvcmRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLyogU2hvdyBOb2RlIFVSTHMgKi8KICAgICAgICAgICAgZnVuY3Rpb24gU2hvd05vZGVVUkxzKHR4dCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sndXJsYmxvY2tmb3JtJ107CiAgICAgICAgICAgICAgICB2YXIgdXJsbGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZm9ybSAmJiAodXJsbGlzdCA9IGV2YWwodHh0KSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFVSTExpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgdmFyIHVybGl0ZW0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSAtMTsKICAgICAgICAgICAgICAgICAgICB2YXIgdG5hbWUgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbmNoaWxkcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybG5vZGVpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciByZWNvcmRpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBvY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsIHggPSAxOwogICAgICAgICAgICAgICAgICAgIGlmKChvY2hpbGRzID0gZm9ybVsnY2hpbGRzJ10pKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZWlkID0gdXJsbGlzdFsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaWQgPSB1cmxsaXN0WydwYXJlbnQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9ub2RlID0gZm9ybVsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQocGlkKyI6Iitub2RlaWQrIjoiK29ub2RlLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYob25vZGUub3B0aW9uc1tvbm9kZS5zZWxlY3RlZEluZGV4XS50ZXh0ID09ICcuLicgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBvbm9kZS5vcHRpb25zW29ub2RlLnNlbGVjdGVkSW5kZXhdLnZhbHVlICE9IG5vZGVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdFBOb2Rlcyhub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLCB4ID0gMSwgeiA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIG9jaGlsZHMub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydudG5vZGVzJ10gPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwKW9jaGlsZHMub3B0aW9uc1t4KytdID0gbmV3IE9wdGlvbignKicsIG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2xpc3RjaGlsZHMgPSBkb2N1bWVudC5mb3Jtc1sndXJsbGlzdC1hZGQtZm9ybSddWydub2RlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9saXN0Y2hpbGRzKSBvbGlzdGNoaWxkcy5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSBpbiB1cmxsaXN0Wyd0bm9kZXMnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlaWQgPSB1cmxsaXN0Wyd0bm9kZXMnXVtpXVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bmFtZSA9IHVybGxpc3RbJ3Rub2RlcyddW2ldWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmNoaWxkcyA9IHVybGxpc3RbJ3Rub2RlcyddW2ldWyduY2hpbGRzJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2NoaWxkcy5vcHRpb25zW3grK10gPSBuZXcgT3B0aW9uKHRuYW1lLCBub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9saXN0Y2hpbGRzKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpc3RjaGlsZHMub3B0aW9uc1t6KytdID0gbmV3IE9wdGlvbih0bmFtZSwgbm9kZWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICI8dWwgY2xhc3M9J3VybC11bCc+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IDAsIHRvID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgcGh0bWxzdHIgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgcHBpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAibGlzdCI7CiAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSBmb3JtWydsZXZlbCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIG5vZGVpZCA9IHVybGxpc3RbJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgIGZyb20gPSBwYXJzZUludChwYWdlKSAtIDEwOwogICAgICAgICAgICAgICAgICAgIGlmKGZyb20gPCAxKSBmcm9tID0gMTsKICAgICAgICAgICAgICAgICAgICB0byA9IGZyb20gKyAyMDsKICAgICAgICAgICAgICAgICAgICBpZih0byA+IHVybGxpc3RbJ3BhZ2VzJ10pIHRvID0gcGFyc2VJbnQodXJsbGlzdFsncGFnZXMnXSkgKyAxOwogICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8bGkgY2xhc3M9J3VybGxpLWhlYWRlcic+ICI7CiAgICAgICAgICAgICAgICAgICAgaWYodXJsbGlzdFsnaXNfY2hpbGRzJ10gPiAwKSB0eXBlID0gImNoaWxkcyI7CiAgICAgICAgICAgICAgICAgICAgZWxzZSB0eXBlID0gImxpc3QiOwogICAgICAgICAgICAgICAgICAgIGlmKChwcGlkID0gdXJsbGlzdFsncHBpZCddKSA+IDApIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIls8YSBocmVmPSdqYXZhc2NyaXB0OjsnIGNsYXNzPSdlYWRkJyBvbmNsaWNrPVwiTGlzdFVSTHMoJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICt0eXBlKyInLCIrcHBpZCsiLCAiK2xldmVsKyIsIDEpO1wiPuS4iuS4gOWxgjwvYT5dJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIlVSTOaAu+aVsO+8miIrdXJsbGlzdFsndG90YWwnXTsKICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydwYWdlcyddID4gMSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICIg5YWxIit1cmxsaXN0WydwYWdlcyddKyLpobUiOwogICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZnJvbSA+IDIwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiPGEgY2xhc3M9J3VybC1saS1wYWdlJyBocmVmPSdqYXZhc2NyaXB0OjsnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiIG9uY2xpY2s9XCJMaXN0VVJMcygnIit0eXBlKyInLCAiK25vZGVpZCsiLCciCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK2xldmVsKyInLCcxJyk7XCI+MTwvYT4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOy4uLiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSBmcm9tOyBpIDwgdG87IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpID09IHBhZ2UpIHBodG1sc3RyICs9IGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8YSBjbGFzcz0ndXJsLWxpLXBhZ2UnIGhyZWY9J2phdmFzY3JpcHQ6OycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAib25jbGljaz1cIkxpc3RVUkxzKCciK3R5cGUrIicsICIrbm9kZWlkKyIsJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK2xldmVsKyInLCciK2krIicpO1wiPiIraSsiPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodG8gPCAodXJsbGlzdFsncGFnZXMnXSAtIDIwKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHVybGxpc3RbJ3BhZ2VzJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Li4uJm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8YSBjbGFzcz0ndXJsLWxpLXBhZ2UnIGhyZWY9J2phdmFzY3JpcHQ6OycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICJvbmNsaWNrPVwiTGlzdFVSTHMoJyIrdHlwZSsiJywgIitub2RlaWQgKyIsJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbGV2ZWwrIicsJyIraSsiJyk7XCI+IitpKyI8L2E+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIGlmKHBodG1sc3RyICE9ICIiKWh0bWxzdHIgKz0gcGh0bWxzdHIgKyAiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChwaHRtbHN0cik7CiAgICAgICAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gdXJsbGlzdFsndXJsbm9kZXMnXSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsaXRlbSA9IHVybGxpc3RbJ3VybG5vZGVzJ11beF07CiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVpZCA9IHVybGl0ZW1bJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgICAgICB1cmxpZCA9IHVybGl0ZW1bJ3VybGlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsID0gdXJsaXRlbVsnbGV2ZWwnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsbm9kZWlkID0gdXJsaXRlbVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkaWQgPSB1cmxpdGVtWydyZWNvcmRpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBuY2hpbGRzID0gdXJsaXRlbVsnbmNoaWxkcyddOwogICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmxpdGVtWyd1cmwnXTsKICAgICAgICAgICAgICAgICAgICAgICAgY3NzID0gJ3VybC1saSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybGl0ZW1bJ3N0YXR1cyddIDwgMCkgY3NzID0gJ3VybC1saS13YXJuJzsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSciK2NzcysiJyBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsJyIrY3NzKyInKVwiICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICd1cmwtbGktc2VsZWN0ZWQnKVwiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IGkrIjombmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8YSBocmVmPSciK3VybCsiJyB0YXJnZXQ9J19ibGFuayc+Iit1cmwrIjwvYT4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihuY2hpbGRzID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiWzxzcGFuIGNsYXNzPSdldmlldycgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9uY2xpY2s9XCJWaWV3Q2hpbGRzVVJMKCIrdXJsbm9kZWlkKyIsMCwxKVwiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IG5jaGlsZHMrIjwvc3Bhbj5dIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c2VsZWN0IG5hbWU9J2xldmVsJyBvbmNoYW5nZT1cIlVwZGF0ZU5vZGVVUkwoIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBub2RlaWQrIiwiK3VybG5vZGVpZCsiLCAiK3VybGlkKyIsIHRoaXMsICIrcGFnZSsiKVwiPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7kvJjlhYjnuqc8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8b3B0aW9uIHZhbHVlPScwJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihsZXZlbCA9PSAwKSBodG1sc3RyICs9ICJzZWxlY3RlZD10cnVlIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPuaZrumAmjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxvcHRpb24gdmFsdWU9JzEnIjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobGV2ZWwgPT0gMSkgaHRtbHN0ciArPSAic2VsZWN0ZWQ9dHJ1ZSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIj7ntKfmgKU8L29wdGlvbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NlbGVjdD4iOwogICAgICAgICAgICAgICAgICAgICAgICBpZihyZWNvcmRpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXZpZXcnIHRpdGxlPSdWaWV3JyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIlZpZXdSZWNvcmQoIityZWNvcmRpZCsiKVwiPiIrY2hydmlldysiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodXJsbGlzdFsnbnRub2RlcyddID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlYWRkJyB0aXRsZT0nQWRkJyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIlhBZGROb2RlVVJMKGV2ZW50LCAiK3VybG5vZGVpZCsiKVwiPiIrY2hyYWRkKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZU5vZGVVUkwoIitub2RlaWQrIiwgIit1cmxub2RlaWQrIiwiK3VybGlkKyIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJyIrdXJsKyInLCciK3BhZ2UrIicpXCI+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3RbJ3BhZ2VzJ10gPiAxKSBodG1sc3RyICs9ICI8aHI+IjsKICAgICAgICAgICAgICAgICAgICBpZihwaHRtbHN0ciAhPSAiIilodG1sc3RyICs9IHBodG1sc3RyOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYoZGl2KSBkaXYuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEhpZGRlblVSTExpc3RGb3JtKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmxsaXN0LWZvcm0nKTsKICAgICAgICAgICAgICAgIGlmKGRpdikgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBoaWRlQkZyYW1lKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gQWRkTm9kZVVSTChmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgcGFyZW50aWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG5vZGVpZCA9IGZvcm1bJ25vZGVpZCddLnZhbHVlKSA+IDAgCiAgICAgICAgICAgICAgICAgICAgJiYgKHVybCA9IGZvcm1bJ3VybCddLnZhbHVlKQogICAgICAgICAgICAgICAgICAgICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXVybG5vZGVfYWRkJm5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJnVybD0iK2VuY29kZVVSSUNvbXBvbmVudCh1cmwpOwogICAgICAgICAgICAgICAgICAgIGlmKChwYXJlbnRpZCA9IGZvcm1bJ3BhcmVudGlkJ10udmFsdWUpID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZwYXJlbnRpZD0iK3BhcmVudGlkOwogICAgICAgICAgICAgICAgICAgIGlmKChsZXZlbCA9IGZvcm1bJ2xldmVsJ10udmFsdWUpID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZsZXZlbD0iK2xldmVsOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5VUkxMaXN0Rm9ybSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWEFkZE5vZGVVUkwoZSwgcGFyZW50aWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInVybGxpc3QtZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ1cmxsaXN0LWFkZC1mb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydwYXJlbnRpZCddLnZhbHVlID0gcGFyZW50aWQ7CiAgICAgICAgICAgICAgICBmb3JtWyd1cmwnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsndXJsJ10udmFsdWUgPSAnaHR0cDovLyc7CiAgICAgICAgICAgICAgICBvdmVyQkZyYW1lKFhkaXYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBVcGRhdGVOb2RlVVJMKG5vZGVpZCwgdXJsbm9kZWlkLCB1cmxpZCwgb3NlbGVjdCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IChvc2VsZWN0KSA/IG9zZWxlY3Quc2VsZWN0ZWRJbmRleCA6IDA7CiAgICAgICAgICAgICAgICB2YXIgbGV2ZWwgPSAoaW5kZXggPj0gMCkgPyBvc2VsZWN0Lm9wdGlvbnNbaW5kZXhdLnZhbHVlIDogLTE7CiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IChpbmRleCA+PSAwKT8gb3NlbGVjdC5vcHRpb25zW2luZGV4XS50ZXh0IDogIiI7CiAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIHVybG5vZGVpZCA+IDAgJiYgbGV2ZWwgPj0gMAogICAgICAgICAgICAgICAgICAgICYmIGNvbmZpcm0oIuaCqOehruiupOS/ruaUueS8mOWFiOe6p+S4ulsiK3RleHQrIl0/IikKICAgICAgICAgICAgICAgICAgICAmJih4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXVybG5vZGVfdXBkYXRlJm5vZGVpZD0iK25vZGVpZCsiJnVybG5vZGVpZD0iIAogICAgICAgICAgICAgICAgICAgICAgICArdXJsbm9kZWlkKyImdXJsaWQ9Iit1cmxpZCsiJmxldmVsPSIrbGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgcGFnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlTm9kZVVSTChub2RlaWQsIHVybG5vZGVpZCwgdXJsaWQsIHVybCwgcGFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgdXJsbm9kZWlkID4gMCAKICAgICAgICAgICAgICAgICAgICAmJiBjb25maXJtKCLmgqjnoa7orqTliKDpmaRVUkxbIit1cmwrIl0gPyIpCiAgICAgICAgICAgICAgICAgICAgJiYoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXVybG5vZGVfZGVsZXRlJm5vZGVpZD0iK25vZGVpZCsiJnVybG5vZGVpZD0iCiAgICAgICAgICAgICAgICAgICAgK3VybG5vZGVpZCsiJnVybGlkPSIrdXJsaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dOb2RlVVJMcyh4bWxIdHRwLnJlc3BvbnNlVGV4dCwgcGFnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIFJlc2V0RGl2KCd1cmwtbGlzdCcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUmVzZXRETlNMaXN0KCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1snZG5zLWFkZC1mb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFNob3dETlModHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rucy1saXN0Jyk7CiAgICAgICAgICAgICAgICB2YXIgb2JqZG5zbGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZG5zbGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZGl2ICYmIChvYmpkbnNsaXN0ID0gZXZhbCh0eHQpKSAhPSBudWxsIAogICAgICAgICAgICAgICAgICAgICYmIChkbnNsaXN0ID0gb2JqZG5zbGlzdFsnZG5zbGlzdCddKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldEROU0xpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0nZG5zLXVsJz4iOwogICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGRuc2xpc3QpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBob3N0aWQgPSBkbnNsaXN0W3hdWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gIGRuc2xpc3RbeF1bJ2hvc3QnXTsKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gZG5zbGlzdFt4XVsnc3RhdHVzJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0nZG5zLWxpJyBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsICdkbnMtbGknKVwiICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlbW92ZT1cIm9uRGl2KHRoaXMsICdkbnMtbGktc2VsZWN0ZWQnKVwiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IGhvc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0YXR1cyA+IDApIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdzdGF0dXNfZXJyJz7mnInmlYg8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3N0YXR1c19vayc+5aSx5pWIPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiRGVsZXRlRE5TKCIraG9zdGlkKyIsICciK2hvc3QrIicpXCI+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEFkZEROUyhmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9ICIiOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKGhvc3QgPSBmb3JtWydob3N0J10udmFsdWUpIAogICAgICAgICAgICAgICAgICAgICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPWRuc19hZGQmaG9zdD0iK2hvc3Q7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd0ROUyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlRE5TKGhvc3RpZCwgaG9zdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGhvc3RpZCA+PSAwICYmIGhvc3QKICAgICAgICAgICAgICAgICAgICAmJiBjb25maXJtKCLmgqjnoa7orqTliKDpmaRETlNbIitob3N0KyJdID8iKQogICAgICAgICAgICAgICAgICAgICYmKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZG5zX2RlbGV0ZSZob3N0aWQ9Iitob3N0aWQrIiZob3N0PSIraG9zdDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd0ROUyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGlzdEROUygpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1kbnNfbGlzdCI7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dETlMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0UHJveHlMaXN0KCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sncHJveHktYWRkLWZvcm0nXTsKICAgICAgICAgICAgICAgIGlmKGZvcm0pCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsnaG9zdCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsnaG9zdCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gU2hvd1Byb3h5KHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm94eS1saXN0Jyk7CiAgICAgICAgICAgICAgICB2YXIgcHJveHlsaXN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiBkaXYgJiYgKHByb3h5bGlzdCA9IGV2YWwodHh0KSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFByb3h5TGlzdCgpOyAKICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdGlkID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3QgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzdHIgPSAiPHVsIGNsYXNzPSdwcm94eS11bCc+IjsKICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBwcm94eWxpc3QpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBob3N0aWQgPSBwcm94eWxpc3RbeF1bJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSAgcHJveHlsaXN0W3hdWydob3N0J107CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IHByb3h5bGlzdFt4XVsnc3RhdHVzJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0ncHJveHktbGknIG9ubW91c2VvdXQ9XCJvdXREaXYodGhpcywgJ3Byb3h5LWxpJylcIiAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW1vdmU9XCJvbkRpdih0aGlzLCAncHJveHktbGktc2VsZWN0ZWQnKVwiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IGhvc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN0YXR1cyA+IDApIGh0bWxzdHIgKz0gIuacieaViCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgIGh0bWxzdHIgKz0gIuWunuaViCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiRGVsZXRlUHJveHkoIitob3N0aWQrIiwgJyIraG9zdCsiJylcIj4iK2NocmRlbCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEFkZFByb3h5KGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBob3N0ID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoZm9ybSA9PSBudWxsIHx8IChob3N0PWZvcm1bJ2hvc3QnXS52YWx1ZSkgPT0gIiIgfHwgaG9zdC5pbmRleE9mKCc6JykgPD0gMCkgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ+S7o+eQhuacjeWKoeWZqOagvOW8j+S4ujoyMDIuMTA2LjAuMjA6ODg4OCcpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKGhvc3QgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cHJveHlfYWRkJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dQcm94eSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRGVsZXRlUHJveHkoaG9zdGlkLCBob3N0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoaG9zdGlkID49IDAgJiYgaG9zdAogICAgICAgICAgICAgICAgICAgICYmIGNvbmZpcm0oIuaCqOehruiupOWIoOmZpOS7o+eQhlsiK2hvc3QrIl0gPyIpCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cHJveHlfZGVsZXRlJmhvc3RpZD0iK2hvc3RpZCsiJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93UHJveHkoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RQcm94eSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1wcm94eV9saXN0IjsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Byb3h5KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgIDwvc2NyaXB0PgogICAgPC9oZWFkPgogICAgPCEtLSA8Ym9keSBvbmxvYWQ9J2phdmFzY3JpcHQ6bG9hZEluaXQoKTsnPiAtLT4KPGJvZHkgb25sb2FkPSdqYXZhc2NyaXB0OmxvYWRUYXNrSW5mbygpOyc+CiAgPGRpdiBpZD0nbWFpbmZyYW1lJz4KICAgIDxkaXYgaWQ9J2l0YWInPgogICAgICAgIDx1bD4KICAgICAgICA8bGkgY2xhc3M9J3RhYi1zZWxlY3RlZCcgaWQ9J3RhYjAnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ3Rhc2tpbmZvJyxldmVudCkiID7kuIvovb3ku7vliqE8L2xpPgogICAgICAgIDxsaSBpZD0ndGFiMScgb25jbGljaz0ic2VsZWN0VmlldygnZGF0YWJhc2UnLGV2ZW50KSIgPuaVsOaNruW6k+mFjee9rjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWIyJyBvbmNsaWNrPSJzZWxlY3RWaWV3KCd0ZW1wbGF0ZScsIGV2ZW50KSIgPuaooeeJiOmFjee9rjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWIzJyBvbmNsaWNrPSJzZWxlY3RWaWV3KCd1cmxibG9jaycsIGV2ZW50KSIgPlVSTOeuoeeQhjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWI0JyBvbmNsaWNrPSJzZWxlY3RWaWV3KCdkYXRhJywgZXZlbnQpIiA+5pWw5o2u566h55CGPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjUnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ2RucycsIGV2ZW50KSIgPkROU+euoeeQhjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWI2JyBvbmNsaWNrPSJzZWxlY3RWaWV3KCdwcm94eScsIGV2ZW50KSIgPuS7o+eQhuiuvue9rjwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWI3JyBvbmNsaWNrPSJzZWxlY3RWaWV3KCd1c2VyJywgZXZlbnQpIiA+55So5oi3566h55CGPC9saT4KICAgICAgICA8L3VsPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd0YXNraW5mbyc+PC9kaXY+CiAgICA8ZGl2IGlkPSdkYXRhYmFzZSc+CiAgICAgICAgPHRhYmxlIHdpZHRoPTEwMCUgaGVpZ2h0PTEwMCUgY2VsbHNwYWNpbmc9MCBib3JkZXI9MCB2YWxpZ249dG9wIGFsaWduPWxlZnQgPgogICAgICAgIDx0cj4KICAgICAgICA8dGQgY2xhc3M9J2RibGlzdCcgdmFsaWduPXRvcCB3aWR0aD0yMCUgaGVpZ2h0PTEwMCUgPgogICAgICAgICAgICA8dGFibGUgY2VsbHNwYWNpbmc9MCBib3JkZXI9MCB2YWxpZ249dG9wIGFsaWduPWxlZnQgd2lkdGg9MTAwJSA+CiAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgIDx0ZCB2YWxpZ249dG9wIGNsYXNzPSdkYnRpdGxlJyB3aWR0aD0xMDAlID4KICAgICAgICAgICAgICAgIOeCueWHuzxzcGFuIGNsYXNzPSdlYWRkJyB0aXRsZT0nQWRkJyBvbmNsaWNrPSdEQlhBZGQoZXZlbnQpJz4g4pyaIDwvc3Bhbj7mt7vliqDmlbDmja7ooag8L2Rpdj4KICAgICAgICAgICAgICAgIDwvdGQ+CiAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICAgIDx0ZCB2YWxpZ249dG9wIHdpZHRoPTEwMCUgPgogICAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9J2Ric2VsZWN0Jz48L2Rpdj4KICAgICAgICAgICAgICAgIDwvdGQ+CiAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICAgIDwvdGFibGU+CiAgICAgICAgPC90ZD4KICAgICAgICA8dGQgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IGNsYXNzPSdkYmZpZWxkcycgY2VsbHNwYWNpbmc9MCBib3JkZXI9MCA+CiAgICAgICAgICAgIDxkaXYgaWQ9J2RiZmllbGRzJz48L2Rpdj4KICAgICAgICA8L3RkPgogICAgICAgIDwvdHI+CiAgICAgICAgPC90YWJsZT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0ndGVtcGxhdGUnPgogICAgPHRhYmxlIGNlbGxzcGFjaW5nPTAgYm9yZGVyPTAgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IGhlaWdodD0xMDAlIGNsYXNzPSd0ZW1wbGF0ZS10YWInID4KICAgICAgICA8dHI+CiAgICAgICAgPHRkIHZhbGlnbj10b3AgYWxpZ249bGVmdCBoZWlnaHQ9MTAwJSBjbGFzcz0ndHJlZXRhYic+CiAgICAgICAgICAgIDxkaXYgaWQ9J3RyZWUtdGl0bGUnPuaKk+WPluagkeeUqOS6juaMh+WvvOeIrOiZq+eahOeIrOWPlui3r+W+hDwvZGl2PgogICAgICAgICAgICA8ZGl2IGlkPSd0cmVlYm9keScgbGV2ZWw9JzAnPjwvZGl2PgogICAgICAgIDwvdGQ+CiAgICAgICAgPHRkIHZhbGlnbj10b3AgYWxpZ249bGVmdCA+CiAgICAgICAgICAgICAgPGRpdiBpZD0ndGVtcGxhdGUtdGl0bGUnPuaooeeJiOeUqOS6juaKveWPluiHquW3semcgOimgeeahOaVsOaNrjwvZGl2PgogICAgICAgICAgICAgIDxkaXYgaWQ9J25vZGUtdGVtcGxhdGUnPjwvZGl2PgogICAgICAgICAgICAgIDxkaXYgaWQ9J3h0ZW1wbGF0ZWZvcm0nPgogICAgICAgICAgICAgICAgPGRpdiBpZD11cmxmb3JtID4KICAgICAgICAgICAgICAgIDxmb3JtIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApOycgbmFtZT0ndXJsZm9ybScgb25zdWJtaXQ9J3JldHVybiBMb2FkVVJMKHRoaXMpOyc+CiAgICAgICAgICAgICAgICBVUkw6PGlucHV0IHR5cGU9dGV4dCBzaXplPSc2NCcgbmFtZT0ndXJsJz4KICAgICAgICAgICAgICAgICZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT0nbWV0aG9kJyB2YWx1ZT0nMCcgY2hlY2tlZD5HRVQKICAgICAgICAgICAgICAgICZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT0nbWV0aG9kJyB2YWx1ZT0nMSc+UE9TVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J0xvYWQnPgogICAgICAgICAgICAgICAgPC9mb3JtPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSdzb3VyY2VfY29kZV9vcCc+CiAgICAgICAgICAgICAgICAgIDxkaXYgaWQ9J3NvdXJjZV92aWV3Jz48L2Rpdj4KICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nc291cmNlX29wJz48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBpZD0ndGVtcGxhdGVkaXYnPgogICAgICAgICAgICAgICAgPGZvcm0gbmFtZT0idGVtcGxhdGVmb3JtIiBhY3Rpb249ImphdmFzY3JpcHQ6dm9pZCgwKSIgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0ndGVtcGxhdGVfYWRkJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbm9kZWlkJyB2YWx1ZT0nLTEnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0ZW1wbGF0ZWlkJyB2YWx1ZT0nLTEnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0YWJsZWlkJyB2YWx1ZT0nLTEnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdmbGFnJyB2YWx1ZT0nMCcgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25maWVsZHMnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21hcCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2xpbmttYXAnIHZhbHVlPScnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd1cmwnIHZhbHVlPScnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdtZXRob2QnIHZhbHVlPScnID4KICAgICAgICAgICAgICAgIOS7o+eggTo8dGV4dGFyZWEgbmFtZT0nY29kZScgcm93cz04ICBjb2xzPTEyMD48L3RleHRhcmVhPiAKICAgICAgICAgICAgICAgIDxicj4KICAgICAgICAgICAgICAgIOaooeeJiDo8dGV4dGFyZWEgbmFtZT0ncGF0dGVybicgcm93cz00ICBjb2xzPTEyMD48L3RleHRhcmVhPgogICAgICAgICAgICAgICAgPGJyPgogICAgICAgICAgICAgICAgPHNwYW4gYWxpZ249Y2VudGVyPgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19wdWJsaWMnID7lhazlhbHlrZfmrrUKICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfZ2xvYmFsJyA+6YeN5aSN5Yy56YWN5aSa5p2hCiAgICAgICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX2lnbm9yZWNhc2UnID7lv73nlaXlpKflsI/lhpkKICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdsaW5rX3RhYmxlJyBvbmNoYW5nZT0iY2hhbmdlVGFibGUodGhpcy5mb3JtLCAnbGlua19maWVsZCcsIHRoaXMpIj4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5pWw5o2u6KGoPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2J1dHRvbicgdmFsdWU9J+aooeadv+a1i+ivlScgb25jbGljaz0iVGVzdFRlbXBsYXRlKHRoaXMuZm9ybSkiPgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0n56Gu6K6k5qih5p2/JyBvbmNsaWNrPSJDb25maWdUZW1wbGF0ZSh0aGlzLmZvcm0pIj4KICAgICAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RlbXBsYXRlLWJhcic+55So5LqO5ou85o6l6ZqQ6JeP55qE6ZO+5o6l5ZKMQWpheOWGheWuueWdl+WcsOWdgDwvZGl2PgogICAgICAgICAgICAgICAgVVJM6KeE5YiZOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0nbGluaycgdmFsdWU9Jycgc2l6ZT00OD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2J1dHRvbicgdmFsdWU9J+a1i+ivlScgb25jbGljaz0iVGVzdFRlbXBsYXRlKHRoaXMuZm9ybSkiPgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0n56Gu6K6kJyBvbmNsaWNrPSJFZGl0TGluayh0aGlzLmZvcm0pOyI+CiAgICAgICAgICAgICAgICA8YnI+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdsaW5rX21ldGhvZCcgdmFsdWU9JzAnIGNoZWNrZWQ+R0VUCiAgICAgICAgICAgICAgICAmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPXJhZGlvIG5hbWU9J2xpbmtfbWV0aG9kJyB2YWx1ZT0nMSc+UE9TVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8c3BhbiB0aXRsZT0n5YiX6KGo6aG15Lya5a6a5pyf5pu05pawJz48aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdsaW5rX2xpc3QnID7liJfooajpobU8L3NwYW4+CiAgICAgICAgICAgICAgICAmbmJzcDsKICAgICAgICAgICAgICAgIDxzZWxlY3QgbmFtZT0nbGlua19maWVsZCcgPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7lrZfmrrU8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xpbmtfbm9kZScgPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7lrZDoioLngrk8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgPC9zcGFuPgogICAgICAgICAgICAgICAgPC9mb3JtPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvdGQ+CiAgICAgICAgPC90cj4KICAgICAgIDwvdGFibGU+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3VybGJsb2NrJz4KICAgIDxkaXYgaWQ9J3VybC1oZWFkZXInPgogICAgPGZvcm0gbmFtZT0ndXJsYmxvY2tmb3JtJyBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyAKICAgICAgICAgICAgb25zdWJtaXQ9J3JldHVybiBBZGROb2RlVVJMKHRoaXMpJyA+CiAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AndmFsdWU9J3VybF9hZGQnID4KICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdwYXJlbnRpZCd2YWx1ZT0nMCcgPgogICAgPHNlbGVjdCBuYW1lPSdub2RlaWQnIG9uY2hhbmdlPSdMaXN0Tm9kZVVSTHModGhpcy5mb3JtLCAibm9kZWlkIiknPgogICAgPG9wdGlvbiB2YWx1ZT0nLTEnPumAieaLqeiKgueCuTwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0nMCcgc2VsZWN0ZWQ+Um9vdDwvb3B0aW9uPgogICAgPC9zZWxlY3Q+CiAgICAmbmJzcDsmbmJzcDsKICAgIDxzZWxlY3QgbmFtZT0nY2hpbGRzJyBvbmNoYW5nZT0nTGlzdE5vZGVVUkxzKHRoaXMuZm9ybSwgImNoaWxkcyIpJz4KICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7pgInmi6nlrZDoioLngrk8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8c2VsZWN0IG5hbWU9J21ldGhvZCc+CiAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+6K+35rGC5pa55rOVPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScwJyA+R0VUPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScxJyA+UE9TVDwvb3B0aW9uPgogICAgPC9zZWxlY3Q+CiAgICAmbmJzcDsmbmJzcDsKICAgIDxzZWxlY3QgbmFtZT0nbGV2ZWwnID4KICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7kvJjlhYjnuqc8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9JzAnID7mma7pgJo8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9JzEnID7ntKfmgKU8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8aW5wdXQgdHlwZT10ZXh0IG5hbWU9dXJsIHNpemU9NDggdmFsdWU9J2h0dHA6Ly8nID4KICAgICZuYnNwOyZuYnNwOwogICAgPGlucHV0IHR5cGU9c3VibWl0IG5hbWU9J3N1Ym1pdCcgdmFsdWU9J0FkZCc+CiAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3VybC1saXN0Jz48L2Rpdj4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZGF0YSc+PC9kaXY+CiAgICA8ZGl2IGlkPSdkbnMnPgogICAgPGRpdiBpZD0nZG5zLWhlYWRlcic+CiAgICA8Zm9ybSBuYW1lPSdkbnMtYWRkLWZvcm0nIGNsYXNzPSdsaXN0Zm9ybScgYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCknIAogICAgICAgICAgICBvbnN1Ym1pdD0ncmV0dXJuIEFkZEROUyh0aGlzKSc+CiAgICDmt7vliqBETlM6PGlucHV0IHR5cGU9dGV4dCBuYW1lPSdob3N0JyBzaXplPTQ4IHZhbHVlPScnID4KICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nb2snPgogICAgPC9mb3JtPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSdkbnMtbGlzdCc+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3Byb3h5Jz4KICAgIDxkaXYgaWQ9J3Byb3h5LWhlYWRlcic+CiAgICA8Zm9ybSBuYW1lPSdwcm94eS1hZGQtZm9ybScgYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCknIG9uc3VibWl0PSdyZXR1cm4gQWRkUHJveHkodGhpcyknPgogICAg5re75Yqg5Luj55CGOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0naG9zdCcgc2l6ZT00OCB2YWx1ZT0nJyA+CiAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJz4KICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0ncHJveHktbGlzdCc+PC9kaXY+CgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1c2VyJz4KCiAgICA8L2Rpdj4KPC9kaXY+CiAgICA8ZGl2IGlkPSd0eHRmb3JtJz4KICAgICAgICA8Zm9ybSBuYW1lPSJlZGl0b3Jmb3JtIiBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiAKICAgICAgICAgICAgb25zdWJtaXQ9InJldHVybiBFZGl0Tm9kZSh0aGlzKTsiPiAKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NldHh0JyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiID7lhbPpl608L3NwYW4+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdvcCcgdmFsdWU9J25vZGVfYWRkJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdub2RlaWQnIHZhbHVlPScwJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdwaWQnIHZhbHVlPScwJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSdub2RlbmFtZScgY2xhc3M9J3R4dGlucHV0JyBzaXplPTI0PgogICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJyBjbGFzcz0nc3VibWl0JyA+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSI+eDwvc3Bhbj4KICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J2RiZm9ybSc+CiAgICAgICAgPGZvcm0gbmFtZT0ieGRiZm9ybSIgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249ImphdmFzY3JpcHQ6dm9pZCgwKSIgCiAgICAgICAgICAgIG9uc3VibWl0PSJyZXR1cm4gRWRpdERCKHRoaXMpOyI+IAogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSIgPuWFs+mXrTwvc3Bhbj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0ndGFibGVfYWRkJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0YWJsZWlkJyB2YWx1ZT0nMCcgPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0ndGV4dCcgbmFtZT0nbmFtZScgY2xhc3M9J3R4dGlucHV0JyBzaXplPTI0PgogICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJyBjbGFzcz0nc3VibWl0JyA+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSI+eDwvc3Bhbj4KICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J2RiZmllbGRmb3JtJz4KICAgICAgICA8Zm9ybSBuYW1lPSJkYmZpZWxkZm9ybSIgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249ImphdmFzY3JpcHQ6dm9pZCgwKSIgCiAgICAgICAgICAgIG9uc3VibWl0PSJyZXR1cm4gRWRpdEZpZWxkKHRoaXMpOyI+IAogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSIgPuWFs+mXrTwvc3Bhbj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0ndGFibGVfYWRkJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0YWJsZWlkJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdmaWVsZGlkJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdvbGRuYW1lJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0eXBlJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdmbGFnJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgIOWtl+auteWQjTo8aW5wdXQgdHlwZT0ndGV4dCcgbmFtZT0nbmFtZScgY2xhc3M9J3R4dGlucHV0JyBzaXplPTI0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAg57G75Z6LOjxzZWxlY3QgbmFtZT0nZnR5cGUnID4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzEnPklOVDwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMic+RG91YmxlPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSc0JyBzZWxlY3RlZD5UZXh0PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSc4Jz5CbG9iPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfaW5kZXgnIHZhbHVlPTEgPuaYr+WQpue0ouW8lQogICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19udWxsJyB2YWx1ZT00ID7mmK/lkKbkuLrnqboKICAgICAgICAgICAgPGlucHV0IHR5cGU9c3VibWl0IHZhbHVlPSdvaycgY2xhc3M9J3N1Ym1pdCcgPgogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiPng8L3NwYW4+CiAgICAgICAgPC9mb3JtPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1cmxsaXN0LWZvcm0nPgogICAgICAgIDxmb3JtIG5hbWU9InVybGxpc3QtYWRkLWZvcm0iIGNsYXNzPSdsaXN0Zm9ybScgYWN0aW9uPSJqYXZhc2NyaXB0OnZvaWQoMCkiIAogICAgICAgICAgICBvbnN1Ym1pdD0icmV0dXJuIEFkZE5vZGVVUkwodGhpcyk7Ij4gCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIiA+5YWz6ZetPC9zcGFuPgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0ndXJsX2FkZCcgPgogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ncGFyZW50aWQnIHZhbHVlPScwJyA+CiAgICAgICAgICAgIDxzZWxlY3QgbmFtZT0nbWV0aG9kJz4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7or7fmsYLmlrnms5U8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzAnID5HRVQ8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzEnID5QT1NUPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdsZXZlbCcgPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuS8mOWFiOe6pzwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMCcgPuaZrumAmjwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMScgPue0p+aApTwvb3B0aW9uPgogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzZWxlY3QgbmFtZT0nbm9kZWlkJyA+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+6YCJ5oup5a2Q6IqC54K5PC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIj54PC9zcGFuPgogICAgICAgICAgICA8aHI+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICBVUkw6PGlucHV0IHR5cGU9dGV4dCBuYW1lPXVybCBzaXplPTQ4IHZhbHVlPSdodHRwOi8vJyA+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgbmFtZT0nc3VibWl0JyB2YWx1ZT0nQWRkJz48YnI+CiAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgaHR0cDovL2FiYy5jb20vbGlzdC9bMS00ODc2XS5odG1sICZuYnNwOyZuYnNwO2h0dHA6Ly9hYmMuY29tLzAwbGlzdC9bMS00ODc2XXsyfS5odG1sPGJyPgogICAgICAgICAgICBodHRwOi8vYWJjLmNvbS9hYmNsaXN0L1thLXpdLmh0bWwgJm5ic3A7Jm5ic3A7aHR0cDovL2FiYy5jb20vYWFhbGlzdC9bYS16XXszfS5odG1sCiAgICAgICAgPC9mb3JtPgogICAgPC9kaXY+CiAgICA8aWZyYW1lIGlkPSdiZnJhbWUnIGZyYW1lYm9yZGVyPTAgPjwvaWZyYW1lPgogICAgPC9ib2R5Pgo8L2h0bWw+Cg==";
#endif
