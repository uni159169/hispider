#ifndef _BASE64_HTML_H
#define _BASE64_HTML_H
static const char *html_code_base64 = "PGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPgogICAgPGhlYWQ+CiAgICA8dGl0bGU+SGl0YXNrIE1vbml0b3I8L3RpdGxlPgogICAgPG1ldGEgaHR0cC1lcXVpdj0iQ29udGVudC1UeXBlIiBjb250ZW50PSJ0ZXh0L2h0bWw7IGNoYXJzZXQ9VVRGLTgiPgogICAgPHN0eWxlPgogICAgICAgIGJvZHkuSUVfTTcsIGJvZHkuSUVfTTgsIGJvZHkuV2luNntmb250LWZhbWlseToiU2Vnb2UgVUkiLCBUYWhvbWEsIFZlcmRhbmEsIEFyaWFsO30KICAgICAgICBib2R5LlNhZmFyaXttaW4td2lkdGg6OTg3cHg7fQogICAgICAgIGJvZHkuU0ZfaVBob25ley13ZWJraXQtdGV4dC1zaXplLWFkanVzdDpub25lO30KICAgICAgICBib2R5CiAgICAgICAgewogICAgICAgICAgICBtYXJnaW46MDtmb250LWZhbWlseTpUYWhvbWEsIFZlcmRhbmEsIEFyaWFsOwogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7CiAgICAgICAgICAgIGNvbG9yOiMzMzM7CiAgICAgICAgICAgIGZvbnQtc2l6ZToxMnB0OwogICAgICAgICAgICB3aWR0aDoxMDAlOwogICAgICAgICAgICBoZWlnaHQ6MTAwJTsKICAgICAgICB9CiAgICAgICAgICAgICNtYWluZnJhbWUKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7CiAgICAgICAgICAgICAgICB3aWR0aDoxMDAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OjEwMCU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2l0YWIge3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjttYXJnaW46MDtwYWRkaW5nOjA7CiAgICAgICAgICAgICAgICBoZWlnaHQ6NDBweDsgd2lkdGg6MTAwJTt0b3A6MHB4O2xlZnQ6MHB4O2ZvbnQtc2l6ZToxNnB0O2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgI2l0YWIgdWx7bWFyZ2luOjA7cGFkZGluZzowO2xpc3Qtc3R5bGU6bm9uZTtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgI2l0YWIgbGl7ZmxvYXQ6bGVmdDtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDt3aWR0aDoxNTBweDsgaGVpZ2h0OjQwcHg7CiAgICAgICAgICAgICAgICBib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNjY2M7Zm9udC13ZWlnaHQ6Ym9sZGVyO3BhZGRpbmc6M3B4IDhweCAzcHggOHB4O30KICAgICAgICAgICAgI2l0YWIgLnRhYi1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y29sb3I6IzJGNUZBMTtib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNjY2M7CiAgICAgICAgICAgICAgICBmb250LXdlaWdodDpib2xkZXI7cGFkZGluZzozcHggOHB4IDNweCA4cHg7d2lkdGg6MTIwcHg7aGVpZ2h0OjQwcHg7fQogICAgICAgICAgICAjdGFza2luZm97cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OyBjb2xvcjojMkY1RkExO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNzsgcGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC5rdGFza3tmb250LXNpemU6MTJwdDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgLnZ0YXNre2ZvbnQtc2l6ZToxMnB0O2ZvbnQtd2VpZ2h0OmJvbGQ7fQogICAgICAgICAgICAjZGF0YWJhc2V7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO30KICAgICAgICAgICAgLmRibGlzdHtwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjBweDsgYmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2hlaWdodDoxMDAlO30KICAgICAgICAgICAgLmRidGl0bGV7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjMGMwYzA7IGhlaWdodDozMHB4O30KICAgICAgICAgICAgI2Ric2VsZWN0e3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjb2xvcjojMkY1RkExO3dpZHRoOjEwMCU7fQogICAgICAgICAgICAjZGJmaWVsZHMgLmRiZmllbGRze3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgLmZpZWxkLXRpdGxle2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojYzBjMGMwO2hlaWdodDozMHB4O3dpZHRoOjEwMCU7fQogICAgICAgICAgICAudWx0YWJ7bGlzdC1zdHlsZTpub25lO3BhZGRpbmc6MDttYXJnaW46MDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmx0YWJuYW1le2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMnB0O30KICAgICAgICAgICAgLmx0YWJ7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2N1cnNvcjogcG9pbnRlcjt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmx0YWItc2VsZWN0ZWR7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2N1cnNvcjogcG9pbnRlcjt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmxmbmFtZXtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAubGZpZWxke2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAubGZpZWxkLXNlbGVjdGVke2JhY2tncm91bmQtY29sb3I6I0QwRTlGNztjdXJzb3I6IHBvaW50ZXI7fQogICAgICAgICAgICAjZGJmaWVsZGZvcm17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6NzIwcHg7aGVpZ2h0OjUwcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmctdG9wOjEwcHg7cGFkZGluZy1sZWZ0OjZweDtmb250LXNpemU6MTJwdDsKICAgICAgICAgICAgICAgIGNvbG9yOiMyRjVGQTE7b3ZlcmZsb3c6YXV0bztkaXNwbGF5Om5vbmU7fQogICAgICAgICAgICAjdGVtcGxhdGV7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDtoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLnRlbXBsYXRlLXRhYntoZWlnaHQ6MTAwJTt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLnRyZWV0YWJ7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2hlaWdodDoxMDAlO21hcmdpbjphdXRvO292ZXJmbG93OmF1dG99CiAgICAgICAgICAgICN0cmVlLXRpdGxle2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojYzBjMGMwO2ZvbnQtc2l6ZToxM3B0OwogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6Ym9sZDtoZWlnaHQ6MzBweDt3aWR0aDoxMDAlO30KICAgICAgICAgICAgI3RyZWVib2R5e3Bvc2l0aW9uOnJlbGF0aXZlO2NvbG9yOiMwMDAwMDA7d2lkdGg6MTAwJTtvdmVyZmxvdzphdXRvfQogICAgICAgICAgICAudHJlZWxpbmV7cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjBweDtmb250LXNpemU6MTJwdDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgLnRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzt3aWR0aDoxMDAlO30KICAgICAgICAgICAgLmJ0aXRsZXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiNjMGMwYzA7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS10aXRsZXtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2MwYzBjMDtmb250LXNpemU6MTNwdDsKICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OmJvbGQ7aGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgICNub2RlLXRlbXBsYXRle3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgI2ZmZmZmZjtwYWRkaW5nOjBweDtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgLnRlbXBsYXRlLWhlYWRlcntiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLmx0ZW1wbGF0ZXtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgI3R4dGZvcm17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MzUwcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MTBweDtvdmVyZmxvdzphdXRvO2Rpc3BsYXk6bm9uZTt9CiAgICAgICAgICAgICNkYmZvcm17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MzgwcHg7YmFja2dyb3VuZC1jb2xvcjojZmZmZmZmOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MTBweDtvdmVyZmxvdzphdXRvO2Rpc3BsYXk6bm9uZTt9CiAgICAgICAgICAgICN4dGVtcGxhdGVmb3Jte3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6I2ZmZmZmZjtkaXNwbGF5Om5vbmU7d2lkdGg6MTAwJTsKICAgICAgICAgICAgICAgIGJvcmRlcjowcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtmb250LXNpemU6MTJwdDtjb2xvcjojMkY1RkExO30KICAgICAgICAgICAgI3VybGZvcm17cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O30KICAgICAgICAgICAgI3NvdXJjZV9jb2RlX29we2Rpc3BsYXk6bm9uZTt9CiAgICAgICAgICAgICN0ZW1wbGF0ZWRpdntkaXNwbGF5Om5vbmU7cG9zaXRpb246cmVsYXRpdmU7fQogICAgICAgICAgICAudGVtcGxhdGUtYmFye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MzBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxM3B0O2ZvbnQtd2VpZ2h0OmJvbGQ7Y29sb3I6c2lsdmVyO30KICAgICAgICAgICAgI2VkaXRvci1mcmFtZXtoZWlnaHQ6MjAwcHg7d2lkdGg6MTAwJTtib3JkZXI6MXB4IHNvbGlkICMwMDAwMDA7fQogICAgICAgICAgICAjdGVtcGxhdGUtY29uZmlne3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsKICAgICAgICAgICAgICAgIGJvcmRlcjoycHggc29saWQgIzAwMDAwMDtwYWRkaW5nOjBweDtmb250LXNpemU6MTJwdDtjb2xvcjojMkY1RkExO2hlaWdodDo1NTBweDt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS1jb25maWctYmxvY2t7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTtoZWlnaHQ6NTIwcHg7b3ZlcmZsb3c6YXV0bzt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS10ZXN0e3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsgYm9yZGVyOjJweCBzb2xpZCAjMDAwMDAwOwogICAgICAgICAgICAgICAgcGFkZGluZzowcHg7aGVpZ2h0OjU1MHB4O2ZvbnQtc2l6ZToxMnB0O2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAjdGVtcGxhdGUtbWF0Y2hlc3twb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6NTIwcHg7b3ZlcmZsb3c6YXV0bzt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS10ZXN0LWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7aGVpZ2h0OjMwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTRwdDtjb2xvcjpyZWQ7Zm9udC13ZWlnaHQ6Ym9sZDt9CiAgICAgICAgICAgICN0ZW1wbGF0ZS12aWV3ZXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OwogICAgICAgICAgICAgICAgYm9yZGVyOjBweCBzb2xpZCAjMDAwMDAwO3dpZHRoOjEwMCU7aGVpZ2h0OjUwMHB4OwogICAgICAgICAgICAgICAgZm9udC1zaXplOjEycHQ7Y29sb3I6IzJGNUZBMTt9CiAgICAgICAgICAgIC5jdHh0X2Jsb2Nre3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6c2lsdmVyO2JvcmRlcjoxcHggc29saWQgIzAwMDAwMDt9CiAgICAgICAgICAgIC5jbG9zZWJ1dHRvbntmb250LXNpemU6MTRwdDtmb250LXdlaWdodDpib2xkO2NvbG9yOnJlZDsKICAgICAgICAgICAgICAgIGN1cnNvcjpwb2ludGVyO2Rpc3BsYXk6aW5saW5lO3RleHQtYWxpZ246cmlnaHQ7fQogICAgICAgICAgICAuY2xvc2V0eHR7Y3Vyc29yOnBvaW50ZXI7Zm9udC1zaXplOjEwcHQ7Y29sb3I6I2NjY2NjYzt0ZXh0LWFsaWduOnJpZ2h0O30KICAgICAgICAgICAgI3VybGJsb2Nre3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtkaXNwbGF5Om5vbmU7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt9CiAgICAgICAgICAgICN1cmwtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtjb2xvcjojY2NjY2NjOwogICAgICAgICAgICAgICAgaGVpZ2h0OjMwcHg7d2lkdGg6MTAwJTtib3JkZXI6MXB4IHNvbGlkICNGRkZGRkY7fQogICAgICAgICAgICAudXJsLXVse2xpc3Qtc3R5bGU6bm9uZTtwYWRkaW5nOjA7bWFyZ2luOjA7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC51cmwtbGl7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLnVybC1saS13YXJue2JhY2tncm91bmQtY29sb3I6I0ZGODAwMDtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC51cmwtbGktc2VsZWN0ZWR7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLnVybGxpLWhlYWRlcntsaXN0LXN0eWxlOm5vbmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2ZvbnQtd2VpZ2h0OmJvbGQ7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTRwdDtjb2xvcjojYzBjMGMwO30KICAgICAgICAgICAgLnVybC1saS1wYWdle2NvbG9yOiNjY2NjNzA7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6MTNwdDt9CiAgICAgICAgICAgICN1cmxsaXN0LWZvcm17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6NzIwcHg7aGVpZ2h0OjE1MHB4O2JhY2tncm91bmQtY29sb3I6I2ZmZmZmZjsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nLXRvcDoxMHB4O3BhZGRpbmctbGVmdDo2cHg7Zm9udC1zaXplOjEycHQ7CiAgICAgICAgICAgICAgICBjb2xvcjojMkY1RkExO292ZXJmbG93OmF1dG87ZGlzcGxheTpub25lO30KICAgICAgICAgICAgI3JlY29yZC12aWV3e3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0QwRTlGNzsgYm9yZGVyOjJweCBzb2xpZCAjMDAwMDAwOwogICAgICAgICAgICAgICAgcGFkZGluZzowcHg7aGVpZ2h0OjU1MHB4O2ZvbnQtc2l6ZToxMnB0O2NvbG9yOiMyRjVGQTE7fQogICAgICAgICAgICAjcmVjb3JkLXJlc3twb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6NTIwcHg7b3ZlcmZsb3c6YXV0bzt9CiAgICAgICAgICAgICNyZWNvcmQtaGVhZGVye3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtY29sb3I6IzJGNUZBMTtoZWlnaHQ6MzBweDsKICAgICAgICAgICAgICAgIGZvbnQtc2l6ZToxNHB0O2NvbG9yOnJlZDtmb250LXdlaWdodDpib2xkO30KICAgICAgICAgICAgLnJlY29yZC10aXRsZXtwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7aGVpZ2h0OjIwcHg7CiAgICAgICAgICAgICAgICBmb250LXNpemU6MTRwdDtjb2xvcjojY2NjY2NjO2ZvbnQtd2VpZ2h0OmJvbGQ7d2lkdGg6MTAwJTt0ZXh0LWFsaWduOmNlbnRlcn0KICAgICAgICAgICAgI2RhdGF7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRjRGQkZGO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNztwYWRkaW5nOjBweDtsZWZ0OjBweDt0b3A6NDZweDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO30KICAgICAgICAgICAgI2Ruc3twb3NpdGlvbjphYnNvbHV0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7ZGlzcGxheTpub25lOwogICAgICAgICAgICAgICAgYm9yZGVyOjFweCBzb2xpZCAjODFCRUY3O3BhZGRpbmc6MHB4O2xlZnQ6MHB4O3RvcDo0NnB4O3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7fQogICAgICAgICAgICAjZG5zLWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTtiYWNrZ3JvdW5kLWNvbG9yOiMyRjVGQTE7Y29sb3I6I2NjY2NjYzsKICAgICAgICAgICAgICAgIGhlaWdodDozMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjFweCBzb2xpZCAjRkZGRkZGO30KICAgICAgICAgICAgI2Rucy1saXN0e3Bvc2l0aW9uOnJlbGF0aXZlO30KICAgICAgICAgICAgLmRucy11bHtsaXN0LXN0eWxlOm5vbmU7cGFkZGluZzowO21hcmdpbjowO30KICAgICAgICAgICAgLmRucy1saXtiYWNrZ3JvdW5kLWNvbG9yOiNEMEU5Rjc7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLmRucy1saS1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgI3Byb3h5e3Bvc2l0aW9uOmFic29sdXRlO2JhY2tncm91bmQtY29sb3I6I0Y0RkJGRjtkaXNwbGF5Om5vbmU7CiAgICAgICAgICAgICAgICBib3JkZXI6MXB4IHNvbGlkICM4MUJFRjc7cGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTt9CiAgICAgICAgICAgICNwcm94eS1oZWFkZXJ7cG9zaXRpb246cmVsYXRpdmU7YmFja2dyb3VuZC1jb2xvcjojMkY1RkExO2NvbG9yOiNjY2NjY2M7CiAgICAgICAgICAgICAgICBoZWlnaHQ6MzBweDt3aWR0aDoxMDAlO2JvcmRlcjoxcHggc29saWQgI0ZGRkZGRjt9CiAgICAgICAgICAgICNwcm94eS1saXN0e3Bvc2l0aW9uOnJlbGF0aXZlO30KICAgICAgICAgICAgLnByb3h5LXVse2xpc3Qtc3R5bGU6bm9uZTtwYWRkaW5nOjA7bWFyZ2luOjA7fQogICAgICAgICAgICAucHJveHktbGl7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3O2N1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC5wcm94eS1saS1zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOiNGNEZCRkY7Y3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgI3VzZXJ7cG9zaXRpb246YWJzb2x1dGU7YmFja2dyb3VuZC1jb2xvcjojRDBFOUY3OyBjb2xvcjojMkY1RkExO2Rpc3BsYXk6bm9uZTsKICAgICAgICAgICAgICAgIGJvcmRlcjoxcHggc29saWQgIzgxQkVGNzsgcGFkZGluZzowcHg7bGVmdDowcHg7dG9wOjQ2cHg7aGVpZ2h0OjEwMCU7d2lkdGg6MTAwJTt9CiAgICAgICAgICAgIC5saXN0Zm9ybXttYXJnaW46MHB4O2Rpc3BsYXk6IGlubGluZTt9CiAgICAgICAgICAgIC5ub2Rle292ZXJmbG93OmhpZGRlbjtjb2xvcjpibGFjaztmb250LXNpemU6MTJwdDt9CiAgICAgICAgICAgIC5ub2RlbmFtZXtjb2xvcjpibGFjaztmb250LXNpemU6MTJwdDtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5lYWRke2NvbG9yOiM1RkI0MDQ7Zm9udC1zaXplOjEzcHQ7Zm9udC13ZWlnaHQ6Ym9sZGVyO2N1cnNvcjpwb2ludGVyO30KICAgICAgICAgICAgLmV1cGRhdGV7Y29sb3I6I0ZGODAwMDtmb250LXNpemU6MTNwdDtmb250LXdlaWdodDpib2xkZXI7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAuZWRlbGV0ZXtjb2xvcjojQjQwNDVGO2ZvbnQtc2l6ZToxM3B0O2ZvbnQtd2VpZ2h0OmJvbGRlcjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5ldmlld3tjb2xvcjojMDAwMGZmO2ZvbnQtc2l6ZToxM3B0O2ZvbnQtd2VpZ2h0OmJvbGRlcjtjdXJzb3I6cG9pbnRlcjt9CiAgICAgICAgICAgIC5pY29ue2Rpc3BsYXk6aW5saW5lO2NvbG9yOiNGRjgwMDA7Zm9udC1zaXplOjEzcHQ7dGV4dC1hbGlnbjpjZW50ZXI7Y3Vyc29yOnBvaW50ZXI7fQogICAgICAgICAgICAubmNoaWxkc3tkaXNwbGF5OmlubGluZTtjb2xvcjpyZWQ7Zm9udC1zaXplOjEycHQ7fQogICAgICAgIDwvc3R5bGU+CiAgICA8c2NyaXB0IGxhbmd1YWdlPSdqYXZhc2NyaXB0Jz4KICAgICAgICAgICAgdmFyIGNocmFkZCA9ICfinJonLCBjaHJmb2xkID0gJ+KWuicsIGNocnRyZWUgPSAn4pa8JywgY2hyZWRpdD0n4pyOJywgY2hyZGVsPSfinJgnLCBjaHJ2aWV3ID0gJ+KYnCAnOwogICAgICAgICAgICB2YXIgb1RpbWVyID0gbnVsbDsKICAgICAgICAgICAgdmFyIGJhc2U2NEVuY29kZUNoYXJzID0gCiAgICAgICAgICAgICAgICAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgICAgICAgICAgIHZhciBiYXNlNjREZWNvZGVDaGFycyA9IG5ldyBBcnJheSgKICAgICAgICAgICAgICAgIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsCiAgICAgICAgICAgICAgICAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIDYyLCAtMSwgLTEsIC0xLCA2MywKICAgICAgICAgICAgICAgIDUyLCA1MywgNTQsIDU1LCA1NiwgNTcsIDU4LCA1OSwgNjAsIDYxLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLAogICAgICAgICAgICAgICAgLTEsICAwLCAgMSwgIDIsICAzLCAgNCwgIDUsICA2LCAgNywgIDgsICA5LCAxMCwgMTEsIDEyLCAxMywgMTQsCiAgICAgICAgICAgICAgICAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjUsIC0xLCAtMSwgLTEsIC0xLCAtMSwKICAgICAgICAgICAgICAgIC0xLCAyNiwgMjcsIDI4LCAyOSwgMzAsIDMxLCAzMiwgMzMsIDM0LCAzNSwgMzYsIDM3LCAzOCwgMzksIDQwLAogICAgICAgICAgICAgICAgNDEsIDQyLCA0MywgNDQsIDQ1LCA0NiwgNDcsIDQ4LCA0OSwgNTAsIDUxLCAtMSwgLTEsIC0xLCAtMSwgLTEpOwogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRlbmNvZGUoc3RyKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG91dCwgaSwgbGVuOwogICAgICAgICAgICAgICAgdmFyIGMxLCBjMiwgYzM7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYzEgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICBpZihpID09IGxlbikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoYzEgPj4gMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKGMxICYgMHgzKSA8PCA0KTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9ICI9PSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgaWYoaSA9PSBsZW4pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KGMxID4+IDIpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KChjMiAmIDB4RikgPDwgMik7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSAiPSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjMyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMSA+PiAyKTsKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gYmFzZTY0RW5jb2RlQ2hhcnMuY2hhckF0KCgoYzEgJiAweDMpPDwgNCkgfCAoKGMyICYgMHhGMCkgPj4gNCkpOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBiYXNlNjRFbmNvZGVDaGFycy5jaGFyQXQoKChjMiAmIDB4RikgPDwgMikgfCAoKGMzICYgMHhDMCkgPj42KSk7CiAgICAgICAgICAgICAgICAgICAgb3V0ICs9IGJhc2U2NEVuY29kZUNoYXJzLmNoYXJBdChjMyAmIDB4M0YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG91dDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYXNlNjRkZWNvZGUoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYzEsIGMyLCBjMywgYzQ7CiAgICAgICAgICAgICAgICB2YXIgaSwgbGVuLCBvdXQ7CgogICAgICAgICAgICAgICAgbGVuID0gc3RyLmxlbmd0aDsKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgLyogYzEgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGMxID0gYmFzZTY0RGVjb2RlQ2hhcnNbc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmZdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMSA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzEgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIC8qIGMyICovCiAgICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgICAgICBjMiA9IGJhc2U2NERlY29kZUNoYXJzW3N0ci5jaGFyQ29kZUF0KGkrKykgJiAweGZmXTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzIgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGMyID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoYzEgPDwgMikgfCAoKGMyICYgMHgzMCkgPj4gNCkpOwoKICAgICAgICAgICAgICAgICAgICAvKiBjMyAqLwogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgYzMgPSBzdHIuY2hhckNvZGVBdChpKyspICYgMHhmZjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gNjEpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGMzID0gYmFzZTY0RGVjb2RlQ2hhcnNbYzNdOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUoaSA8IGxlbiAmJiBjMyA9PSAtMSk7CiAgICAgICAgICAgICAgICAgICAgaWYoYzMgPT0gLTEpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzIgJiAwWEYpIDw8IDQpIHwgKChjMyAmIDB4M0MpID4+IDIpKTsKCiAgICAgICAgICAgICAgICAgICAgLyogYzQgKi8KICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGM0ID0gc3RyLmNoYXJDb2RlQXQoaSsrKSAmIDB4ZmY7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IDYxKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgICAgICAgICAgICAgICAgICBjNCA9IGJhc2U2NERlY29kZUNoYXJzW2M0XTsKICAgICAgICAgICAgICAgICAgICB9IHdoaWxlKGkgPCBsZW4gJiYgYzQgPT0gLTEpOwogICAgICAgICAgICAgICAgICAgIGlmKGM0ID09IC0xKQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzMgJiAweDAzKSA8PCA2KSB8IGM0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmMTZ0bzgoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICBvdXQgPSAiIjsKICAgICAgICAgICAgICAgIGxlbiA9IHN0ci5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgICAgIGMgPSBzdHIuY2hhckNvZGVBdChpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoKGMgPj0gMHgwMDAxKSAmJiAoYyA8PSAweDAwN0YpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBzdHIuY2hhckF0KGkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGMgPiAweDA3RkYpIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhFMCB8ICgoYyA+PiAxMikgJiAweDBGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDYpICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDgwIHwgKChjID4+ICAwKSAmIDB4M0YpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHhDMCB8ICgoYyA+PiAgNikgJiAweDFGKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gIDApICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gdXRmOHRvMTYoc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb3V0LCBpLCBsZW4sIGM7CiAgICAgICAgICAgICAgICB2YXIgY2hhcjIsIGNoYXIzOwogICAgICAgICAgICAgICAgb3V0ID0gIiI7CiAgICAgICAgICAgICAgICBsZW4gPSBzdHIubGVuZ3RoOwogICAgICAgICAgICAgICAgaSA9IDA7CiAgICAgICAgICAgICAgICB3aGlsZShpIDwgbGVuKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKGMgPj4gNCkKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogY2FzZSAyOiBjYXNlIDM6IGNhc2UgNDogY2FzZSA1OiBjYXNlIDY6IGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMHh4eHh4eHgKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IHN0ci5jaGFyQXQoaS0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6IGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDExMHggeHh4eCAgIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYyAmIDB4MUYpIDw8IDYpIHwgKGNoYXIyICYgMHgzRikpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTExMCB4eHh4ICAxMHh4IHh4eHggIDEweHggeHh4eAogICAgICAgICAgICAgICAgICAgICAgICBjaGFyMiA9IHN0ci5jaGFyQ29kZUF0KGkrKyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIzID0gc3RyLmNoYXJDb2RlQXQoaSsrKTsKICAgICAgICAgICAgICAgICAgICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjICYgMHgwRikgPDwgMTIpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMiAmIDB4M0YpIDw8IDYpIHwKICAgICAgICAgICAgICAgICAgICAgICAgKChjaGFyMyAmIDB4M0YpIDw8IDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnRfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ3dhaXQnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG92ZXJfd2FpdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2F1dG8nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGJhc2U2NHN0cmRlY29kZShzdHIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXRmOHRvMTYoYmFzZTY0ZGVjb2RlKHN0cikpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIHRyaW0oc3RyKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoLyheXHMrfFxzKyQpLywgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodChvYmopCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9iai5jbGFzc05hbWUgPSAiYnRpdGxlIjsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBiYWNrY3NzKG9iaikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb2JqLmNsYXNzTmFtZSA9ICJ0aXRsZSI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gcmVtb3ZlRWxlbWVudChfZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIF9wYXJlbnRFbGVtZW50ID0gX2VsZW1lbnQucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgIGlmKF9wYXJlbnRFbGVtZW50KXsKICAgICAgICAgICAgICAgICAgICBfcGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChfZWxlbWVudCk7ICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBDcmVhdGVYTUxIVFRQKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbGh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgeG1saHR0cE9iaiA9IFsiTVNYTUwyLlhtbEh0dHAuNS4wIiwiTVNYTUwyLlhtbEh0dHAuNC4wIiwiTVNYTUwyLlhtbEh0dHAuMy4wIiwiTVNYTUwyLlhtbEh0dHAiLCJNaWNyb3NvZnQuWG1sSHR0cCJdOwogICAgICAgICAgICAgICAgaWYod2luZG93LlhNTEh0dHBSZXF1ZXN0KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbGh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYod2luZG93LkFjdGl2ZVhPYmplY3QpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZm9yKGk9MDtpPHhtbGh0dHBPYmoubGVuZ3RoO2krKykgICAgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0cnl7eG1saHR0cCA9IG5ldyBBY3RpdmVYT2JqZWN0KHhtbGh0dHBPYmpbaV0pO2JyZWFrO30KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2goZSl7eG1saHR0cCA9IG51bGw7fQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ0NhbiBub3QgY3JlYXRlIFhNTEhUVFAgT2JqZWN0Jyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4geG1saHR0cDsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZWJ1aWxkQ2hpbGQob1BhcmVudCwgcGlkLCBpZCwgbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYob1BhcmVudCAmJiBwYXJzZUludChpZCkgPiAwICYmIG5hbWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGNoaWxkcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSBuYW1lOwogICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyA9ICIoeyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0geCsiOiciK2NoaWxkc1t4XSsiJywiOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyArPSBwaWQrIjonIitwTmFtZSsiJ30pIjsKICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnY2hpbGRzJywgc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiByZW1vdmVDaGlsZChvUGFyZW50LCBwaWQsIGlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihvUGFyZW50ICYmIHBhcnNlSW50KGlkKSA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHMgPSBldmFsKHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyY2hpbGRzID0gIih7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4ICE9IHBpZCAmJiBjaGlsZHNbeF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyArPSB4KyI6JyIrY2hpbGRzW3hdKyInLCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0gcGlkKyI6JyIrcE5hbWUrIid9KSI7CiAgICAgICAgICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCdjaGlsZHMnLCBzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGROb2RlKHBpZCwgaWQsIG5hbWUsIGNvdW50KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibm9kZSIraWQpICE9IG51bGwpIHJldHVybjsKICAgICAgICAgICAgICAgIC8vYWxlcnQoInBpZDoiK3BpZCsiaWQ6IitpZCsibmFtZToiK25hbWUpOwogICAgICAgICAgICAgICAgdmFyIG9QYXJlbnQgPSBudWxsOwogICAgICAgICAgICAgICAgaWYocGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgb1BhcmVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJub2RlIitwaWQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9QYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJlZWJvZHknKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vYWxlcnQocGlkKyc6JytpZCsnOicrbmFtZSk7CiAgICAgICAgICAgICAgICBpZihvUGFyZW50ID09IG51bGwpIHJldHVybjsKICAgICAgICAgICAgICAgIHZhciBvTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gb1BhcmVudC5nZXRBdHRyaWJ1dGUoJ2xldmVsJykgKiAxOwogICAgICAgICAgICAgICAgdmFyIG5jaGlsZHMgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnbmNoaWxkcycpICogMTsKICAgICAgICAgICAgICAgIG9QYXJlbnQuc2V0QXR0cmlidXRlKCduY2hpbGRzJywgbmNoaWxkcyArIDEpOwogICAgICAgICAgICAgICAgaWYocGlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCdjaGlsZHMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcE5hbWUgPSBvUGFyZW50LmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZihzdHJjaGlsZHMpIGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGNoaWxkcyA9IG5ldyBBcnJheSgpOwogICAgICAgICAgICAgICAgICAgIGNoaWxkc1tpZF0gPSBuYW1lOwogICAgICAgICAgICAgICAgICAgIHN0cmNoaWxkcyA9ICIoeyI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gY2hpbGRzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeCAhPSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0geCsiOiciK2NoaWxkc1t4XSsiJywiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzdHJjaGlsZHMgKz0gcGlkKyI6JyIrcE5hbWUrIid9KSI7CiAgICAgICAgICAgICAgICAgICAgb1BhcmVudC5zZXRBdHRyaWJ1dGUoJ2NoaWxkcycsIHN0cmNoaWxkcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgb2ZvbGQgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoKG9mb2xkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRfJytwaWQpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihuY2hpbGRzID09IDApIG9mb2xkLmlubmVySFRNTCA9IGNocnRyZWU7IAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIG9uY2hpbGRzID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKChvbmNoaWxkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaF8nK3BpZCkpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9uY2hpbGRzLmlubmVySFRNTCA9IG5jaGlsZHMrMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG9Ob2RlLmlkID0gIm5vZGUiICsgaWQ7CiAgICAgICAgICAgICAgICBvTm9kZS5jbGFzc05hbWUgPSAnbm9kZSc7CiAgICAgICAgICAgICAgICBvTm9kZS5zZXRBdHRyaWJ1dGUoJ2xldmVsJywgbGV2ZWwgKyAxKTsKICAgICAgICAgICAgICAgIG9Ob2RlLnNldEF0dHJpYnV0ZSgnbmNoaWxkcycsIDApOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdwYXJlbnQnLCBwaWQpOwogICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdVSUQnLCBpZCk7CiAgICAgICAgICAgICAgICBvTm9kZS5zZXRBdHRyaWJ1dGUoJ1VOYW1lJywgbmFtZSk7CiAgICAgICAgICAgICAgICBodG1sc3RyID0gIjxkaXYgaWQ9J3RpdGxlXyIrIGlkICsiJyBjbGFzcz0ndGl0bGUnICI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW1vdmU9XCJvbkRpdih0aGlzLCAnYnRpdGxlJyk7XCIgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsICd0aXRsZScpO1wiPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndHJlZWxpbmUnPiI7CiAgICAgICAgICAgICAgICB2YXIgaSA9IDA7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCAobGV2ZWwtMSk7IGkrKykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYobGV2ZWwgPiAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGlmKGNvdW50ID4gMCkKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBpZD0nZm9sZF8iKyBpZCArIicgY2xhc3M9J2ljb24nIG9uY2xpY2s9J0ZvbGQodGhpcyknPiIrY2hyYWRkKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBpZD0nZm9sZF8iKyBpZCArIicgY2xhc3M9J2ljb24nIG9uY2xpY2s9J0ZvbGQodGhpcyknPiIrY2hyZm9sZCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gaWQ9J25kXyIraWQrIicgY2xhc3M9J25vZGVuYW1lJyB0aXRsZT0n54K55Ye76L+b5YWl5qih54mI566h55CGJyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25jbGljaz0nVmlld1RlbXBsYXRlcygiK2lkKyIpJyA+IituYW1lKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIls8c3BhbiBpZD0nY2hfIisgaWQgKyInIGNsYXNzPSduY2hpbGRzJyA+Iitjb3VudCsiPC9zcGFuPl0iOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlYWRkJyB0aXRsZT0nQWRkJyAiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz0nWEFkZChldmVudCknPiIrY2hyYWRkKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXVwZGF0ZScgdGl0bGU9J1JlbmFtZScgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hFZGl0KGV2ZW50KSc+IitjaHJlZGl0KyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9J1hEZWxldGUoIitpZCsiLCIrcGlkKyIpJz4iK2NocmRlbCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9kaXY+IjsKICAgICAgICAgICAgICAgIG9Ob2RlLmlubmVySFRNTCA9IGh0bWxzdHI7IAogICAgICAgICAgICAgICAgb1BhcmVudC5hcHBlbmRDaGlsZChvTm9kZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVXBkYXRlTm9kZShpZCwgbmFtZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUnK2lkKTsKICAgICAgICAgICAgICAgIGlmKG9Ob2RlICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgb05vZGUuc2V0QXR0cmlidXRlKCdVTmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgICAgIHZhciBvTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZF8nK2lkKTsKICAgICAgICAgICAgICAgICAgICBpZihvTmFtZSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb05hbWUuaW5uZXJIVE1MID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuRWRpdG9yKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTGlzdENoaWxkcyhwYXJlbnQsIHVybCwgYXJndikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCk7CiAgICAgICAgICAgICAgICBpZih4bWxIdHRwICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bm9kZSA9IGV2YWwoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRub2RlWydpZCddID09IHBhcmVudCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgdG5vZGVbJ25jaGlsZHMnXTsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGROb2RlKHBhcmVudCwgdG5vZGVbJ2NoaWxkcyddW2ldWydpZCddICogMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25hbWUnXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25jaGlsZHMnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vY2xvc2UgZm9ybQogICAgICAgICAgICBmdW5jdGlvbiBDbG9zZVRoaXMoZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL0FkZCBjaGlsZAogICAgICAgICAgICBmdW5jdGlvbiBYQWRkKGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1siZWRpdG9yZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdub2RlX2FkZCc7CiAgICAgICAgICAgICAgICBmb3JtWydwaWQnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnVUlEJyk7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlaWQnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhFZGl0KGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR4dGZvcm0iKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYOwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFk7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbImVkaXRvcmZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ29wJ10udmFsdWUgPSAnbm9kZV91cGRhdGUnOwogICAgICAgICAgICAgICAgZm9ybVsncGlkJ10udmFsdWUgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3BhcmVudCcpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkJ10udmFsdWUgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ1VJRCcpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbm9kZW5hbWUnXS52YWx1ZSA9IGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnVU5hbWUnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5FZGl0b3IoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R4dGZvcm0nKTsKICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdE5vZGUoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgcGlkID0gZm9ybVsncGlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbm9kZW5hbWUgPSBmb3JtWydub2RlbmFtZSddLnZhbHVlOwogICAgICAgICAgICAgICAgaWYob3AgPT0gJ25vZGVfYWRkJyAmJiBub2RlbmFtZSAmJiBwaWQgPj0gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPSIrb3ArIiZuYW1lPSIrZW5jb2RlVVJJQ29tcG9uZW50KG5vZGVuYW1lKSsiJnBhcmVudGlkPSIrcGlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnbm9kZV91cGRhdGUnICYmIG5vZGVuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDApCiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD0iK29wKyImbmFtZT0iK2VuY29kZVVSSUNvbXBvbmVudChub2RlbmFtZSkKICAgICAgICAgICAgICAgICAgICAgICAgKyImbm9kZWlkPSIrbm9kZWlkKyImcGFyZW50aWQ9IitwaWQ7CiAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFVwZGF0ZU5vZGUobm9kZWlkLCBub2RlbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5FZGl0b3IoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiA7CiAgICAgICAgICAgICAgICAvL2FsZXJ0KCJvcDoiK29wKyJub2RlaWQ6Iitub2RlaWQrInBpZDoiK3BpZCsibm9kZW5hbWU6Iitub2RlbmFtZSk7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKTsKICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3AgPT0gJ25vZGVfYWRkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0bm9kZSA9IGV2YWwoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bm9kZVsnaWQnXSA9PSBwaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IHRub2RlWyduY2hpbGRzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBZGROb2RlKHBpZCwgdG5vZGVbJ2NoaWxkcyddW2ldWydpZCddICogMSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25hbWUnXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bm9kZVsnY2hpbGRzJ11baV1bJ25jaGlsZHMnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnbm9kZV91cGRhdGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gdHJpbSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlkID4gMCAmJiBpZCA9PSBub2RlaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVcGRhdGVOb2RlKGlkLCBub2RlbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2RlbGV0ZSBub2RlCiAgICAgICAgICAgIGZ1bmN0aW9uIFhEZWxldGUobm9kZWlkLCBwYXJlbnRpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9Ob2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIm5vZGUiK25vZGVpZCk7CiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIG9Ob2RlICE9IG51bGwgJiYgKG5hbWUgPSBvTm9kZS5nZXRBdHRyaWJ1dGUoJ1VOYW1lJykpCiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgnQXJlIHlvdSBzdXJlIGRlbGV0ZSBub2RlOicrbm9kZWlkKycgbmFtZTonK25hbWUrJyA/JykgCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9bm9kZV9kZWxldGUmbm9kZWlkPSIrbm9kZWlkKyImcGFyZW50aWQ9IitwYXJlbnRpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gdHJpbSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpZCA9IG9Ob2RlLmdldEF0dHJpYnV0ZSgncGFyZW50Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9QYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZScrcGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpZCA9PSBub2RlaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmNoaWxkcyA9IG9QYXJlbnQuZ2V0QXR0cmlidXRlKCduY2hpbGRzJykgLSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvUGFyZW50LnNldEF0dHJpYnV0ZSgnbmNoaWxkcycsIG5jaGlsZHMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVDaGlsZChvUGFyZW50LCBwaWQsIGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9jaGlsZCA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hfJytwaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvY2hpbGQuaW5uZXJIVE1MID0gbmNoaWxkczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb1BhcmVudC5yZW1vdmVDaGlsZChvTm9kZSk7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsaWQgPSBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ25vZGVpZCddLnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlkID09IHVybGlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIaWRkZW5UZW1wbGF0ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkVkaXRvcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vZm9sZCBub2RlCiAgICAgICAgICAgIGZ1bmN0aW9uIEZvbGQoZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG5jaGlsZHMgPSBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ25jaGlsZHMnKSAqIDE7CiAgICAgICAgICAgICAgICB2YXIgdWlkID0gZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdVSUQnKSAqIDE7CiAgICAgICAgICAgICAgICB2YXIgdXJsID0gIi8iOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9bm9kZV9jaGlsZHMmbm9kZWlkPSIrdWlkOwogICAgICAgICAgICAgICAgaWYoZWxlbWVudC5pbm5lckhUTUwgPT0gY2hyYWRkKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnN0eWxlLmhlaWdodCA9ICcnOwogICAgICAgICAgICAgICAgICAgIExpc3RDaGlsZHModWlkLCB1cmwsIGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIGlmKG5jaGlsZHMgPiAwKWVsZW1lbnQuaW5uZXJIVE1MID0gY2hydHJlZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZWxlbWVudC5pbm5lckhUTUwgPT0gY2hyZm9sZCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBMaXN0Q2hpbGRzKHVpZCwgdXJsLCBhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQgPSBlbGVtZW50LnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIGlmKG5jaGlsZHMgPiAwKSBlbGVtZW50LmlubmVySFRNTCA9IGNocmFkZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBIaWRkZW5FZGl0b3IoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMaW1pdFNwZWVkKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBzcGVlZCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChzcGVlZCA9IGZvcm1bJ3NwZWVkJ10udmFsdWUpICE9ICcnCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9c3BlZWRfbGltaXQmc3BlZWQ9IitzcGVlZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Rhc2tJbmZvKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9TaG93IFRhc2sKICAgICAgICAgICAgZnVuY3Rpb24gU2hvd1Rhc2tJbmZvKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhc2tpbmZvID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiAodGFza2luZm8gPSBldmFsKHR4dCkpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzcGVlZCA9IHRhc2tpbmZvWydzcGVlZF9saW1pdCddOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7nirbmgIE6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGEgaHJlZj1cImphdmFzY3JpcHQ6Vmlld1Rhc2soJ3Rhc2tfIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IHRhc2tpbmZvWydzdGF0dXMnXSsiJyk7XCIgY2xhc3M9J3Z0YXNrJyI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPiIrdGFza2luZm9bJ3N0YXR1cyddKyI8L2E+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz5VUkzmgLvmlbA6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfdG90YWwnXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7ku7vliqHmgLvmlbA6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfbnRhc2tzJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+5Lu75Yqh5a6M5oiQOiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+Iit0YXNraW5mb1sndXJsX3Rhc2tfb2snXTsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7ku7vliqHplJnor686Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWyd1cmxfdGFza19lcnJvciddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPuaWh+aho+Wkp+WwjzombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ2RvY190b3RhbF96c2l6ZSddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIi8iICsgdGFza2luZm9bJ2RvY190b3RhbF9zaXplJ10rIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0na3Rhc2snPkROU+ino+aekDombmJzcDs8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0ndnRhc2snPiIrdGFza2luZm9bJ2hvc3RfY3VycmVudCddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIi8iICsgdGFza2luZm9bJ2hvc3RfdG90YWwnXSsiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+5bey55So5pe26Ze0OiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+WyIrdGFza2luZm9bJ3RfZGF5J107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7RGF5KHMpJm5ic3A7Jm5ic3A7Iit0YXNraW5mb1sndF9ob3VyJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiOiIrdGFza2luZm9bJ3RfbWluJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiOiIrdGFza2luZm9bJ3Rfc2VjJ107CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7KyIrdGFza2luZm9bJ3RfdXNlYyddKyJdIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2t0YXNrJz7kuIvovb3pgJ/luqY6Jm5ic3A7PC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J3Z0YXNrJz4iK3Rhc2tpbmZvWydzcGVlZCddOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiAoS0IvUykgPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdrdGFzayc+6YCf5bqm6ZmQ5Yi2OiZuYnNwOzwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSd2dGFzayc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8Zm9ybSBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgY2xhc3M9J2xpc3Rmb3JtJyAiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiBvbnN1Ym1pdD0nTGltaXRTcGVlZCh0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT10ZXh0IG5hbWU9c3BlZWQgdmFsdWU9JyIrc3BlZWQrIic+IChLQi9TKSAiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOzxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdPSyc+IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICAi77yIMOWSjOi0n+aVsOihqOekuuS4jemZkOmAn++8iTwvZm9ybT48L3NwYW4+PGhyPiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIG90YXNraW5mbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNraW5mbycpOwogICAgICAgICAgICAgICAgICAgIGlmKG90YXNraW5mbykgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvdGFza2luZm8uc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgICAgICAgICBvdGFza2luZm8uaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vdmlldyBUYXNrCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdUYXNrKG9wKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZigoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD0iK29wOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dUYXNrSW5mbyh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBvbkRpdihkaXYsIGNzc05hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRpdi5jbGFzc05hbWUgPSBjc3NOYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG91dERpdihkaXYsIGNzc05hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRpdi5jbGFzc05hbWUgPSBjc3NOYW1lOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0REIoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2RiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ric2VsZWN0Jyk7CiAgICAgICAgICAgICAgICAgICAgb2RiLmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgdmFyIG9kYmYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmaWVsZHMnKTsKICAgICAgICAgICAgICAgICAgICBvZGJmLmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdEQih0eHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkYiA9IGV2YWwodHh0KTsKICAgICAgICAgICAgICAgIGlmKGRiICYmIGRiWyd0YWJsZXMnXS5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB0YWJpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYm5hbWUgPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICI8dWwgY2xhc3M9J3VsdGFiJz4iOwogICAgICAgICAgICAgICAgICAgIGZvcihpID0gMDsgaSA8IGRiWyd0YWJsZXMnXS5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmlkID0gZGJbJ3RhYmxlcyddW2ldWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICB0YWJuYW1lID0gZGJbJ3RhYmxlcyddW2ldWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0nbHRhYicgb25tb3VzZW1vdmU9XCJvbkRpdih0aGlzLCAnbHRhYi1zZWxlY3RlZCcpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2VvdXQ9XCJvdXREaXYodGhpcywgJ2x0YWInKVwiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nbHRhYm5hbWUnIG9uY2xpY2s9J1ZpZXdUYWJsZSgiK3RhYmlkKyIpJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgdGl0bGU9J+eCueWHu+i/m+WFpeaVsOaNruihqOeuoeeQhicgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gdGFibmFtZSsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdldXBkYXRlJyB0aXRsZT0nUmVuYW1lJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiREJYRWRpdChldmVudCwiK3RhYmlkKyIsICciK3RhYm5hbWUrIicpXCI+IitjaHJlZGl0KyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VkZWxldGUnIHRpdGxlPSdEZWxldGUnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJEZWxldGVUYWJsZSgiK3RhYmlkKyIsICciK3RhYm5hbWUrIicpXCI+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICB2YXIgb2RiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ric2VsZWN0Jyk7CiAgICAgICAgICAgICAgICAgICAgb2RiLmlubmVySFRNTCA9IGh0bWxzdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIEFkZFRhYmxlKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB0YWJuYW1lID0gZm9ybVsndGFibmFtZSddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYodGFibmFtZSAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10YWJsZV9hZGQmbmFtZT0iK3RhYm5hbWU7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdEQih4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsndGFibmFtZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RhdGFiYXNlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIFJlc2V0REIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERlbGV0ZVRhYmxlKHRhYmlkLCB0YWJuYW1lKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihjb25maXJtKCJBcmUgeW91IHN1cmUgZGVsZXRlIHRhYmJsZToiK3RhYm5hbWUrIiA/IikgCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGFibGVfZGVsZXRlJnRhYmxlaWQ9Iit0YWJpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld0RCKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgUmVzZXREQigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9MaXN0IFRhYmxlIEZpZWxkcwogICAgICAgICAgICBmdW5jdGlvbiBWaWV3RmllbGRzKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhYiA9IGV2YWwodHh0KTsKICAgICAgICAgICAgICAgIGlmKHRhYikKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFiaWQgPSB0YWJbJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYm5hbWUgPSB0YWJbJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmlkID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgZm5hbWUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBmdHlwZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgPSAgIjx1bCBjbGFzcz0ndWx0YWInID4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0nZmllbGQtdGl0bGUnPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICLngrnlh7s8c3BhbiBjbGFzcz0nZWFkZCcgdGl0bGU9J0NsaWNrIEFkZCBOZXcgRmllbGQnICI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRCRlhBZGQoZXZlbnQsICciK3RhYmlkKyInKVwiPiIrY2hyYWRkKyI8L3NwYW4+5re75Yqg5a2X5q61IjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdsdGFibmFtZSc+Iit0YWJuYW1lKyJbIjsKICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nbmNoaWxkcyc+Iit0YWJbJ25maWVsZHMnXSsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiXTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCB0YWJbJ25maWVsZHMnXTsgaSsrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlkID0gdGFiWydmaWVsZHMnXVtpXVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgZm5hbWUgPSB0YWJbJ2ZpZWxkcyddW2ldWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGZ0eXBlID0gdGFiWydmaWVsZHMnXVtpXVsndHlwZSddOwogICAgICAgICAgICAgICAgICAgICAgICBmbGFnID0gdGFiWydmaWVsZHMnXVtpXVsnZmxhZyddOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8bGkgY2xhc3M9J2xmaWVsZCcgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ2xmaWVsZC1zZWxlY3RlZCcpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2VvdXQ9XCJvdXREaXYodGhpcywgJ2xmaWVsZCcpO1wiID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nbGZuYW1lJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiREJGWEVkaXQoZXZlbnQsICIrdGFiaWQrIiwiK2ZpZCsiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiciK2ZuYW1lKyInLCAiK2Z0eXBlKyIsICIrZmxhZysiKVwiPiIrZm5hbWUrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZXVwZGF0ZScgdGl0bGU9J0NoYW5nZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRCRlhFZGl0KGV2ZW50LCAiK3RhYmlkKyIsIitmaWQrIiwiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICInIitmbmFtZSsiJywgIitmdHlwZSsiLCAiK2ZsYWcrIilcIj4iK2NocmVkaXQrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZUZpZWxkKCIrdGFiaWQrIiwiK2ZpZCsiLCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiciK3RhYm5hbWUrIicsICciK2ZuYW1lKyInKVwiPiIrY2hyZGVsKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3VsPiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIG9kYmZpZWxkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZpZWxkcycpOwogICAgICAgICAgICAgICAgICAgIG9kYmZpZWxkcy5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vTGlzdC9WaWV3IEZpZWxkCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdUYWJsZSh0YWJpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwoKICAgICAgICAgICAgICAgIGlmKHRhYmlkID49IDAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGFibGVfdmlldyZ0YWJsZWlkPSIrdGFiaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdGaWVsZHMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAgLy9WaWV3IGRhdGFiYXNlCiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdEYXRhYmFzZSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKCh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPWRhdGFiYXNlX3ZpZXciOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2RiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFiYXNlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2RiLnNldEF0dHJpYnV0ZSgnZGJhc2UnLCB4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9hZExpbmtPcHRpb25zKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9MaXN0IFRhYmxlcwogICAgICAgICAgICBmdW5jdGlvbiBMaXN0VGFibGVzKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGFibGVfbGlzdCI7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdEQih4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIEhpZGRlbkRCZm9ybSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmb3JtJyk7CiAgICAgICAgICAgICAgICBkaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERCWEFkZChlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciB4ID0gZS5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwogICAgICAgICAgICAgICAgdmFyIHkgPSBlLmNsaWVudFkgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYmZvcm0iKTsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUubGVmdCA9IHg7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLnRvcCA9IHkgKyAxMDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sieGRiZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICd0YWJsZV9hZGQnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERCWEVkaXQoZSwgaWQsIG5hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRiZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ4ZGJmb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydvcCddLnZhbHVlID0gJ3RhYmxlX3JlbmFtZSc7CiAgICAgICAgICAgICAgICBmb3JtWyd0YWJsZWlkJ10udmFsdWUgPSBpZDsKICAgICAgICAgICAgICAgIGZvcm1bJ25hbWUnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLnZhbHVlID0gbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBFZGl0REIoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoZm9ybSA9PSBudWxsKSByZXR1cm47CiAgICAgICAgICAgICAgICB2YXIgYXJndiA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgb3AgPSBmb3JtWydvcCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSBmb3JtWyd0YWJsZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IGZvcm1bJ25hbWUnXS52YWx1ZTsKICAgICAgICAgICAgICAgIGlmKG9wID09ICd0YWJsZV9hZGQnICYmIG5hbWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD10YWJsZV9hZGQmbmFtZT0iK25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICd0YWJsZV9yZW5hbWUnICYmIHRhYmxlaWQgPj0gMCAmJiBuYW1lKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9dGFibGVfcmVuYW1lJnRhYmxlaWQ9Iit0YWJsZWlkKyImbmFtZT0iK25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICd0YWJsZV9kZWxldGUnICYmIHRhYmxlaWQgPj0gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPXRhYmxlX2RlbGV0ZSZ0YWJsZWlkPSIrdGFibGVpZDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGFyZ3YgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdEQih4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlbkRCZm9ybSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERCRlhBZGQoZSwgdGFiaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgdmFyIFhkaXYgPSAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImRiZmllbGRmb3JtIik7CiAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDsKICAgICAgICAgICAgICAgIHZhciB5ID0gZS5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbImRiZmllbGRmb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydvcCddLnZhbHVlID0gJ2ZpZWxkX2FkZCc7CiAgICAgICAgICAgICAgICBmb3JtWyd0YWJsZWlkJ10udmFsdWUgPSB0YWJpZDsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZpZWxkaWQnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnb2xkbmFtZSddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWyd0eXBlJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnaXNfaW5kZXgnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19udWxsJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEQkZYRWRpdChlLCB0YWJpZCwgZmllbGRpZCwgZm5hbWUsIGZ0eXBlLCBmbGFnKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYmZpZWxkZm9ybSIpOwogICAgICAgICAgICAgICAgdmFyIHggPSBlLmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7CiAgICAgICAgICAgICAgICB2YXIgeSA9IGUuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5sZWZ0ID0geDsKICAgICAgICAgICAgICAgIFhkaXYuc3R5bGUudG9wID0geSArIDEwOwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZSc7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyJkYmZpZWxkZm9ybSJdOwogICAgICAgICAgICAgICAgZm9ybVsnb3AnXS52YWx1ZSA9ICdmaWVsZF91cGRhdGUnOwogICAgICAgICAgICAgICAgZm9ybVsndGFibGVpZCddLnZhbHVlID0gdGFiaWQ7CiAgICAgICAgICAgICAgICBmb3JtWydmaWVsZGlkJ10udmFsdWUgPSBmaWVsZGlkOwogICAgICAgICAgICAgICAgZm9ybVsnb2xkbmFtZSddLnZhbHVlID0gZm5hbWU7CiAgICAgICAgICAgICAgICBmb3JtWyd0eXBlJ10udmFsdWUgPSBmdHlwZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2ZsYWcnXS52YWx1ZSA9IGZsYWc7CiAgICAgICAgICAgICAgICBmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCBmb3JtWydmdHlwZSddLm9wdGlvbnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnZnR5cGUnXS5vcHRpb25zW2ldLnZhbHVlID09IGZ0eXBlKQogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydmdHlwZSddLm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2Z0eXBlJ10ub3B0aW9uc1tpXS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoZmxhZyAmIDEpIGZvcm1bJ2lzX2luZGV4J10uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBpZihmbGFnICYgMikgZm9ybVsnaXNfbnVsbCddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9ybVsnbmFtZSddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWyduYW1lJ10udmFsdWUgPSBmbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5EQkZpZWxkZm9ybSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmaWVsZGZvcm0nKTsKICAgICAgICAgICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gRWRpdEZpZWxkKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGZvcm0gPT0gbnVsbCkgcmV0dXJuOwogICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIG9wID0gZm9ybVsnb3AnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZpZWxkaWQgPSBmb3JtWydmaWVsZGlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZm5hbWUgPSBmb3JtWyduYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZnR5cGUgPSBmb3JtWydmdHlwZSddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIG9sZG5hbWUgPSBmb3JtWydvbGRuYW1lJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgb2xkdHlwZSA9IGZvcm1bJ3R5cGUnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBvbGRmbGFnID0gZm9ybVsnZmxhZyddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgaWYob3AgPT0gJ2ZpZWxkX2FkZCcgJiYgdGFibGVpZCA+PSAwICYmIGZuYW1lICYmIGZ0eXBlID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPWZpZWxkX2FkZCZ0YWJsZWlkPSIrdGFibGVpZCsiJm5hbWU9IitmbmFtZSsiJnR5cGU9IitmdHlwZTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICBpZihmbGFnID4gMCkgYXJndiArPSAiJmZsYWc9IitmbGFnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAnZmllbGRfdXBkYXRlJyAmJiB0YWJsZWlkID49IDAgJiYgZmllbGRpZCA+PSAwKSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZWFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZihmbmFtZSAmJiBmbmFtZSAhPSBvbGRuYW1lKSBlYXJndiArPSAiJm5hbWU9IitmbmFtZTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19pbmRleCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAxOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX251bGwnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMjsKICAgICAgICAgICAgICAgICAgICBpZihmdHlwZSAhPSBvbGR0eXBlKSBlYXJndiArPSAiJnR5cGU9IitmdHlwZTsKICAgICAgICAgICAgICAgICAgICBpZihmbGFnICE9IG9sZGZsYWcpIGVhcmd2ICs9ICImZmxhZz0iK2ZsYWc7CiAgICAgICAgICAgICAgICAgICAgaWYoZWFyZ3YpCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSAib3A9ZmllbGRfdXBkYXRlJnRhYmxlaWQ9Iit0YWJsZWlkKyImZmllbGRpZD0iK2ZpZWxkaWQrZWFyZ3Y7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihhcmd2ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RmllbGRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuREJGaWVsZGZvcm0oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBEZWxldGVGaWVsZCh0YWJpZCwgZmllbGRpZCwgdGFibmFtZSwgZmllbGRuYW1lKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZihjb25maXJtKCJBcmUgeW91IHN1cmUgZGVsZXRlIFRhYmxlOiIrdGFibmFtZSsiIEZpZWxkOiIrZmllbGRuYW1lKyI/IikgCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZmllbGRfZGVsZXRlJnRhYmxlaWQ9Iit0YWJpZCsiJmZpZWxkaWQ9IitmaWVsZGlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RmllbGRzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWV3RGF0YWJhc2UoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL2RlbGV0ZSBkaXYKICAgICAgICAgICAgZnVuY3Rpb24gZGl2cmVtb3ZlKGVsZW1lbnQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBkaXZoaWRkZW4oZWxlbWVudCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoZWxlbWVudCAmJiBlbGVtZW50LmlubmVySFRNTCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vbW92aW5nIGRpdgogICAgICAgICAgICBmdW5jdGlvbiBkaXZtb3ZlKGUsIG8pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG8ub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4oZmFsc2UpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIG8ub25tb3VzZWRvd24gPSBmdW5jdGlvbihlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGUgPSBlfHx3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBwYXJzZUludChlLmNsaWVudFggLSBvLnBhcmVudE5vZGUub2Zmc2V0TGVmdCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBwYXJzZUludChlLmNsaWVudFkgLSBvLnBhcmVudE5vZGUub2Zmc2V0VG9wKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5vbm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGUpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBlPWV8fHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgICAgICAgICAgby5wYXJlbnROb2RlLnN0eWxlLmxlZnQ9KGUuY2xpZW50WC14KSsicHgiOwogICAgICAgICAgICAgICAgICAgICAgICBvLnBhcmVudE5vZGUuc3R5bGUudG9wPShlLmNsaWVudFkteSkrInB4IjsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Lm9ubW91c2V1cD1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5vbm1vdXNlbW92ZT1udWxsOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0VGVtcGxhdGVmb3JtKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydvcCddLnZhbHVlID0gJ3RlbXBsYXRlX2FkZCc7CiAgICAgICAgICAgICAgICBmb3JtWyd0ZW1wbGF0ZWlkJ10udmFsdWUgPSAtMTsKICAgICAgICAgICAgICAgIGZvcm1bJ3BhdHRlcm4nXS52YWx1ZSA9ICcnCiAgICAgICAgICAgICAgICBmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnZmxhZyddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWyduZmllbGRzJ10udmFsdWUgPSAwOwogICAgICAgICAgICAgICAgZm9ybVsnbGluayddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rbWFwJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ21hcCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX21ldGhvZCddWzBdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19saXN0J10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua190YWJsZSddLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19maWVsZCddLm9wdGlvbnNbMF0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19ub2RlJ10ub3B0aW9uc1swXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWFRSZXNldCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvdXJjZV92aWV3Jyk7CiAgICAgICAgICAgICAgICBpZihvZGl2KSBvZGl2LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgdmFyIGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidGVtcGxhdGVmb3JtIl07CiAgICAgICAgICAgICAgICBmb3JtWydvcCddLnZhbHVlID0gJ3RlbXBsYXRlX2FkZCc7CiAgICAgICAgICAgICAgICBmb3JtWydub2RlaWQnXS52YWx1ZSA9IC0xOwogICAgICAgICAgICAgICAgZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlID0gLTE7CiAgICAgICAgICAgICAgICBmb3JtWydjb2RlJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ3BhdHRlcm4nXS52YWx1ZSA9ICcnCiAgICAgICAgICAgICAgICBmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3JtWydpc19pZ25vcmVjYXNlJ10uY2hlY2tlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9ybVsnZmxhZyddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWyduZmllbGRzJ10udmFsdWUgPSAwOwogICAgICAgICAgICAgICAgZm9ybVsndXJsJ10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmsnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua21hcCddLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICBmb3JtWydtYXAnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgZm9ybVsnbWV0aG9kJ10udmFsdWUgPSAwOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19tZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfbGlzdCddLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcm1bJ2xpbmtfdGFibGUnXS5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICBmb3JtWydsaW5rX2ZpZWxkJ10ub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgZm9ybVsnbGlua19ub2RlJ10ub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd1cmxmb3JtJ107CiAgICAgICAgICAgICAgICBmb3JtWydtZXRob2QnXVswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBYVEFkZChub2RlaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBYZGl2ID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ4dGVtcGxhdGVmb3JtIik7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIFhUUmVzZXQoKTsKICAgICAgICAgICAgICAgIHZhciB4Zm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ0ZW1wbGF0ZWZvcm0iXTsKICAgICAgICAgICAgICAgIHhmb3JtWydub2RlaWQnXS52YWx1ZSA9IG5vZGVpZDsKICAgICAgICAgICAgICAgIHZhciB1cmxmb3JtID0gZG9jdW1lbnQuZm9ybXNbInVybGZvcm0iXTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ21ldGhvZCddWzBdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgdXJsZm9ybVsndXJsJ10uZm9jdXMoKTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ3VybCddLnZhbHVlID0gJ2h0dHA6Ly8nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFhURWRpdChmb3JtaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFhUUmVzZXQoKTsKICAgICAgICAgICAgICAgIHZhciB4Zm9ybSA9IGRvY3VtZW50LmZvcm1zWyJ0ZW1wbGF0ZWZvcm0iXTsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbZm9ybWlkXTsKICAgICAgICAgICAgICAgIHhmb3JtWydvcCddLnZhbHVlID0gJ3RlbXBsYXRlX3VwZGF0ZSc7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbm9kZWlkJ10udmFsdWUgPSBmb3JtWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWyd0YWJsZWlkJ10udmFsdWUgPSBmb3JtWyd0YWJsZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsndGVtcGxhdGVpZCddLnZhbHVlID0gZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ3BhdHRlcm4nXS52YWx1ZSA9IGZvcm1bJ3BhdHRlcm4nXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydmbGFnJ10udmFsdWUgPSBmb3JtWydmbGFnJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbmZpZWxkcyddLnZhbHVlID0gZm9ybVsnbmZpZWxkcyddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ3VybCddLnZhbHVlID0gZm9ybVsndXJsJ10udmFsdWU7CiAgICAgICAgICAgICAgICB4Zm9ybVsnbGluayddLnZhbHVlID0gZm9ybVsnbGluayddLnZhbHVlOwogICAgICAgICAgICAgICAgeGZvcm1bJ2xpbmttYXAnXS52YWx1ZSA9IGZvcm1bJ2xpbmttYXAnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydtYXAnXS52YWx1ZSA9IGZvcm1bJ21hcCddLnZhbHVlOwogICAgICAgICAgICAgICAgaWYoeGZvcm1bJ2ZsYWcnXS52YWx1ZSAmIDEpCiAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2lzX3B1YmxpYyddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYoeGZvcm1bJ2ZsYWcnXS52YWx1ZSAmIDIpCiAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2lzX2dsb2JhbCddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYoeGZvcm1bJ2ZsYWcnXS52YWx1ZSAmIDQpCiAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2lzX2lnbm9yZWNhc2UnXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHhmb3JtWydtZXRob2QnXS52YWx1ZSA9IDA7CiAgICAgICAgICAgICAgICBpZihmb3JtWydtZXRob2QnXS52YWx1ZSA9PSAxKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHhmb3JtWydtZXRob2QnXS52YWx1ZSA9IDE7CiAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2ZsYWcnXS52YWx1ZSB8PSAxNjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBzdHJsaW5rbWFwID0gZm9ybVsnbGlua21hcCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIGxpbmttYXAgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoc3RybGlua21hcCAmJiAobGlua21hcCA9IGV2YWwoc3RybGlua21hcCkpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXBbJ2ZsYWcnXSAmIDE2KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2xpbmtfbWV0aG9kJ11bMV0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGxpbmttYXBbJ2ZsYWcnXSAmIDY0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgeGZvcm1bJ2xpbmtfbGlzdCddLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBlZGl2ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKChlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3h0ZW1wbGF0ZWZvcm0nKSkpIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGVkaXYuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoKGVkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGVkaXYnKSkpIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGVkaXYuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIHVybGZvcm0gPSBkb2N1bWVudC5mb3Jtc1sidXJsZm9ybSJdOwogICAgICAgICAgICAgICAgdXJsZm9ybVsnbWV0aG9kJ11bMF0uY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBpZihmb3JtWydmbGFnJ10udmFsdWUgJiAxNikKICAgICAgICAgICAgICAgICAgICB1cmxmb3JtWydtZXRob2QnXVsxXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHVybGZvcm1bJ3VybCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBpZihmb3JtWyd1cmwnXS52YWx1ZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB1cmxmb3JtWyd1cmwnXS52YWx1ZSA9IGZvcm1bJ3VybCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIExvYWRVUkwodXJsZm9ybSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gWFREZWxldGUobm9kZWlkLCB0ZW1wbGF0ZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgbXNnID0gIkFyZSB5b3Ugc3VyZSBkZWxldGUgdGVtcGxhdGVbIit0ZW1wbGF0ZWlkKyJdIGZyb20gbm9kZVsiK25vZGVpZCsiXSA/IjsKICAgICAgICAgICAgICAgIGlmKGNvbmZpcm0obXNnKSAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD10ZW1wbGF0ZV9kZWxldGUmbm9kZWlkPSIrbm9kZWlkKyImdGVtcGxhdGVpZD0iK3RlbXBsYXRlaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vSGlkZGVuVGVtcGxhdGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGVtcGxhdGVzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBIaWRkZW5UZW1wbGF0ZSgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBudWxsOwogICAgICAgICAgICAgICAgaWYoKGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZS1jb25maWcnKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgaWYoKGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlLXRlbXBsYXRlJykpKQogICAgICAgICAgICAgICAgICAgIGRpdi5pbm5lckhUTUwgPSAiIjsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlX3ZpZXcnKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9ICIiOwogICAgICAgICAgICAgICAgaWYoKGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfY29kZV9vcCcpKSkKICAgICAgICAgICAgICAgICAgICBkaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgIGlmKChkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGVkaXYnKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBpZigoZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3h0ZW1wbGF0ZWZvcm0nKSkpCiAgICAgICAgICAgICAgICAgICAgZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICBYVFJlc2V0KCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBjaGFuZ2VUYWJsZShmb3JtLCBmc2VsZWN0aWQsIGVsKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2RpdiA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgc3RyZGIgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGRiYXNlID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBmaWVsZHMgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIHRhYmlkID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgZmllbGRzb3B0aW9ucyA9ICIiOwogICAgICAgICAgICAgICAgdmFyIHNlbGVjdCA9IGZvcm1bZnNlbGVjdGlkXTsKICAgICAgICAgICAgICAgIGlmKHNlbGVjdCkgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0YWJhc2UnKSkgCiAgICAgICAgICAgICAgICAgICAgJiYgKHN0cmRiID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2RiYXNlJykpICYmIChkYmFzZSA9IGV2YWwoc3RyZGIpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZigodGFiaWQgPSBlbC5vcHRpb25zW2VsLnNlbGVjdGVkSW5kZXhdLnZhbHVlKSA+PSAwIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAoZmllbGRzID0gZGJhc2VbJ3RhYmxlcyddW3RhYmlkXVsnZmllbGRzJ10pCiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNlbGVjdCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBmaWVsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdC5vcHRpb25zW2krK10gPSBuZXcgT3B0aW9uKGZpZWxkc1t4XVsnbmFtZSddLCB4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGZpZWxkc29wdGlvbnMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBzZWxlY3RVUkwoZm9ybSwgYm94LCBpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiBib3ggJiYgaWQgPj0gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZihib3guY2hlY2tlZCA9PSB0cnVlKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfdW5pcWVfJytpZF0uZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnaXNfbGlzdF8nK2lkXS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydpc19maWxlXycraWRdLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ25vZGVpZF8nK2lkXS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydpc191bmlxZV8nK2lkXS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1bJ2lzX2xpc3RfJytpZF0uZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWydpc19maWxlXycraWRdLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9ybVsnbm9kZWlkXycraWRdLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBDb25maWdUZW1wbGF0ZShmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBjb2RlID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKHBhdHRlcm4gPSBmb3JtWydwYXR0ZXJuJ10udmFsdWUpICYmIChjb2RlID0gZm9ybVsnY29kZSddLnZhbHVlKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb2RlID0gY29kZS5yZXBsYWNlKC9ccnxcbi9taWcsJycpOwogICAgICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSBmb3JtWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVpZCA9IGZvcm1bJ2xpbmtfdGFibGUnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVpZCA9IGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybVsndXJsJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IGZvcm1bJ21ldGhvZCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmRpdGlvbiA9ICJtIjsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNfcHVibGljID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdmFyIGlzX2lnbm9yZWNhc2UgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNfZ2xvYmFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzX3B1YmxpYyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2lnbm9yZWNhc2UnXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXNfaWdub3JlY2FzZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbiArPSAiaSI7IAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXNfZ2xvYmFsID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZyA9IG5ldyAgUmVnRXhwKHBhdHRlcm4sIGNvbmRpdGlvbik7CiAgICAgICAgICAgICAgICAgICAgaWYoKGFyciA9IHJlZy5leGVjKGNvZGUpKSAmJiBhcnIubGVuZ3RoID4gMSkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGZvcm1bJ21hcCddLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbWFwJ10udmFsdWUpIG1hcCA9IGV2YWwoZm9ybVsnbWFwJ10udmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JtWyduZmllbGRzJ10udmFsdWUgPSBhcnIubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2RpdiA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZHNvcHRpb25zID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZHNvcHRpb25zID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKChvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RhdGFiYXNlJykpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyZGIgPSBvZGl2LmdldEF0dHJpYnV0ZSgnZGJhc2UnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYmFzZSA9IGV2YWwoc3RyZGIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGJhc2UgJiYgZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdICYmIHRhYmxlaWQgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBkYmFzZVsndGFibGVzJ11bdGFibGVpZF1bJ2ZpZWxkcyddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzb3B0aW9ucyArPSAiPG9wdGlvbiB2YWx1ZT0nIit4KyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkc29wdGlvbnMgKz0gZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdWydmaWVsZHMnXVt4XVsnbmFtZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgKG9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbm9kZScrbm9kZWlkKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHJjaGlsZHMgPSBvZGl2LmdldEF0dHJpYnV0ZSgnY2hpbGRzJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hpbGRzID0gZXZhbChzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2hpbGRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkc29wdGlvbnMgKz0gIjxvcHRpb24gdmFsdWU9JyIreCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHNvcHRpb25zICs9IGNoaWxkc1t4XSsiIDwvb3B0aW9uPlxuIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodGVtcGxhdGVpZCA+PSAwKSBvcCA9ICJ0ZW1wbGF0ZV91cGRhdGUiOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyID0gIjxkaXYgY2xhc3M9J3RlbXBsYXRlLWJhcicgb25tb3VzZWRvd249JyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gImRpdm1vdmUoZXZlbnQsIHRoaXMpJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9J2RpdnJlbW92ZSgiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJ0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID5YPC9zcGFuPiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0nZGl2cmVtb3ZlKCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gInRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlKScgPuWFs+mXrTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgICAgIHZhciAgYmxvY2sgPSAiPGRpdiBpZD0ndGVtcGxhdGUtY29uZmlnLWJsb2NrJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxmb3JtIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyBjbGFzcz0nbGlzdGZvcm0nICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAib25zdWJtaXQ9J0VkaXRUZW1wbGF0ZSh0aGlzLCB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdub2RlaWQnIHZhbHVlPSciK25vZGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdvcCcgdmFsdWU9JyIrb3ArIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbWV0aG9kJyB2YWx1ZT0nIittZXRob2QrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndGFibGVpZCcgdmFsdWU9JyIrdGFibGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSd0ZW1wbGF0ZWlkJyB2YWx1ZT0nIit0ZW1wbGF0ZWlkKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25maWVsZHMnIHZhbHVlPSciK2Fyci5sZW5ndGgrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIlVSTDo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9J3VybCcgc2l6ZT04MCB2YWx1ZT0nIit1cmwrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8YnI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICLmqKHniYg6PHRleHRhcmVhIG5hbWU9J3BhdHRlcm4nIGNvbHM9NzYgcm93cz00PiIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK3BhdHRlcm4rIjwvdGV4dGFyZWE+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8YnI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX3B1YmxpYycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzX3B1YmxpYykgYmxvY2sgKz0gImNoZWNrZWQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7lhazlhbHmlbDmja4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX2dsb2JhbCcgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzX2dsb2JhbCkgYmxvY2sgKz0gImNoZWNrZWQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7ph43lpI3ljLnphY3lpJrmnaEiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfaWdub3JlY2FzZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGlzX2lnbm9yZWNhc2UpIGJsb2NrICs9ICJjaGVja2VkIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5b+955Wl5aSn5bCP5YaZIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAxOyBpIDwgYXJyLmxlbmd0aDtpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaSA8IDEwKSBibG9jayArPSAnMCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBpKyI6IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8dGV4dGFyZWEgbmFtZT0ncl8iK2krIicgY29scz03NiByb3dzPTEgcmVhZG9ubHkvZGlzYWJsZWQ+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9IGFycltpXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8L3RleHRhcmVhPjxicj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNwYW4gdGl0bGU9J+iHquWKqOaLvOaOpeS4uuWujOaIkOmTvuaOpSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc191cmxfIitpKyInIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmxhZyddICYgMSkgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiIG9uY2xpY2s9J3NlbGVjdFVSTCh0aGlzLmZvcm0sdGhpcywiK2krIiknPumTvuaOpTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfpk77mjqXmoIfor4bkuIDmnaHlrozmlbTkv6Hmga/nmoTnu5PmnZ8nPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfdW5pcWVfIitpKyInIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmxhZyddICYgMSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwW2ktMV1bJ2ZsYWcnXSAmIDMyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiIGNoZWNrZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBkaXNhYmxlZD10cnVlICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuagh+ivhuaAp+mTvuaOpTwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNwYW4gdGl0bGU9J+WIl+ihqOmhteWwhuS8muS8mOWFiOS4i+i9veW5tuS4lOS8muWumuacn+abtOaWsCc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19saXN0XyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcFtpLTFdWydmbGFnJ10gJiA2NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICIgZGlzYWJsZWQ9dHJ1ZSAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIj7liJfooajpobU8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfkuIvovb3lrZjlgqjkuLrmlofku7bmr5TlpoI65Zu+54mHLG1wM+etiSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19maWxlXyIraSsiJyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgbWFwW2ktMV1bJ2ZsYWcnXSAmIDEpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcFtpLTFdWydmbGFnJ10gJiAyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiIGNoZWNrZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBkaXNhYmxlZD10cnVlICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuaWh+S7tjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPHNwYW4gdGl0bGU9J+WOu+aOiWh0bWzmoIfnrb7lkI7nmoTmlofmnKzlhoXlrrknPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfbmVlZF9jbGVhcmh0bWxfIitpKyInIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmxhZyddICYgNCkgYmxvY2sgKz0gIiBjaGVja2VkICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPuWOu0hUTUw8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxzcGFuIHRpdGxlPSfljrvmjonnlpHkvLzlub/lkYrnmoTpg6jliIblhoXlrrnvvIzor6Xlip/og73osKjmhY7kvb/nlKgnPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfbmVlZF9hbnRpc3BhbV8iK2krIiciOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobWFwICYmIG1hcFtpLTFdWydmbGFnJ10gJiA4KSBibG9jayArPSAiIGNoZWNrZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+5Y675bm/5ZGKPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c2VsZWN0IG5hbWU9J2ZpZWxkaWRfIitpKyInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuWvueW6lOWtl+autTwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihtYXAgJiYgdGFibGVpZCA+PSAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGRiYXNlWyd0YWJsZXMnXVt0YWJsZWlkXVsnZmllbGRzJ10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPG9wdGlvbiB2YWx1ZT0nIit4KyInICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnZmllbGRpZCddID09IHgpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIiBzZWxlY3RlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPiIrZGJhc2VbJ3RhYmxlcyddW3RhYmxlaWRdWydmaWVsZHMnXVt4XVsnbmFtZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIjwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9IGZpZWxkc29wdGlvbnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC9zZWxlY3Q+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c2VsZWN0IG5hbWU9J25vZGVpZF8iK2krIicgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiAobWFwW2ktMV1bJ2ZsYWcnXSAmIDEpKSBibG9jayArPSAiICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGJsb2NrICs9ICIgZGlzYWJsZWQgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5YWz6IGU6IqC54K5PC9vcHRpb24+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPG9wdGlvbiB2YWx1ZT0nIit4KyInICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcCAmJiBtYXBbaS0xXVsnbm9kZWlkJ10gPT0geCkgYmxvY2sgKz0gIiBzZWxlY3RlZCAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPiIrIGNoaWxkc1t4XSsiIDwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9IGNoaWxkc29wdGlvbnM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC9zZWxlY3Q+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gIjxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nT0snID4iOwogICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC9mb3JtPjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGUtY29uZmlnJykpKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBzdHIgKyBibG9jazsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9ICd0ZW1wbGF0ZS1jb25maWcnOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGl2d2lkdGggPSA3MDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhsZWZ0ID0gcGFyc2VJbnQob2JvZHkub2Zmc2V0V2lkdGgpIC0gZGl2d2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gb2JvZHkub2Zmc2V0TGVmdCArKHhsZWZ0LzIpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IDIwICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHgrJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSB5KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBkaXZ3aWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5pZCA9ICd0ZW1wbGF0ZS1jb25maWctZnJhbWUnOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGZyYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5vcGVuKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQud3JpdGUoYmxvY2spOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gVGVzdFRlbXBsYXRlKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gIiI7CiAgICAgICAgICAgICAgICB2YXIgbGluayA9ICIiOwogICAgICAgICAgICAgICAgdmFyIGNvZGUgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBhcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGNvbmRpdGlvbiA9ICJtIjsKICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IDA7CiAgICAgICAgICAgICAgICB2YXIgaXNfZ2xvYmFsPSAwOwogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAocGF0dGVybiA9IGZvcm1bJ3BhdHRlcm4nXS52YWx1ZSkKICAgICAgICAgICAgICAgICAgICAmJiAoY29kZSA9IGZvcm1bJ2NvZGUnXS52YWx1ZSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9IHBhdHRlcm4ucmVwbGFjZSgvXHJ8XG4vbWlnLCcnKTsKICAgICAgICAgICAgICAgICAgICBjb2RlID0gY29kZS5yZXBsYWNlKC9ccnxcbi9taWcsJycpOwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2lnbm9yZWNhc2UnXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb24gKz0gImkiOyAKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19nbG9iYWwnXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXNfZ2xvYmFsID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uICs9ICJnIjsgCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQocGF0dGVybik7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChjb25kaXRpb24pOwogICAgICAgICAgICAgICAgICAgIHZhciByZWcgPSBuZXcgIFJlZ0V4cChwYXR0ZXJuLCBjb25kaXRpb24pOwogICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaGVzID0gbmV3IEFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgaWYoaXNfZ2xvYmFsKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUoKGFyciA9IHJlZy5leGVjKGNvZGUpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgYXJyLmxlbmd0aCA+IDEpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoYXJyWzBdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXNbY291bnQrK10gPSBhcnI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGFyciA9IHJlZy5leGVjKGNvZGUpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGFyci5sZW5ndGggPiAxKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzW2NvdW50KytdID0gYXJyOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGNvdW50ID4gMCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAiPGRpdiBpZD0ndGVtcGxhdGUtdGVzdC1oZWFkZXInIG9ubW91c2Vkb3duPSciOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gImRpdm1vdmUoZXZlbnQsIHRoaXMpJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0nZGl2cmVtb3ZlKCI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+WDwvc3Bhbj4mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0nZGl2cmVtb3ZlKCI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAidGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUpJyA+5YWz6ZetPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7TWF0Y2ggUmVzdWx0IENvdW50OiIrY291bnQrIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPGRpdiBpZD0ndGVtcGxhdGUtbWF0Y2hlcycgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgbGluayA9IGZvcm1bJ2xpbmsnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgY291bnQ7IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGluaykgdXJsID0gbGluazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4+cmVzdWx0OiIraSsiPGhyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaiA9IDE7IGogPCBtYXRjaGVzW2ldLmxlbmd0aDsgaisrKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihqIDwgMTApIHN0ciArPSAiMCI7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSBqKyI6PHRleHRhcmVhIGNvbHM9NzYgcm93cz0xPiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgK21hdGNoZXNbaV1bal0rIjwvdGV4dGFyZWE+PGJyPiI7ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWcgPSBuZXcgUmVnRXhwKCI8IitqKyI+IiwgImlnIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHVybC5yZXBsYWNlKHJlZywgbWF0Y2hlc1tpXVtqXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodXJsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiVVJMOjxpbnB1dCB0eXBlPXRleHQgc2l6ZT00OCB2YWx1ZT0nIit1cmwrIic+PGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjwvZGl2PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVtcGxhdGUtdGVzdCcpKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gc3RyOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlkID0gJ3RlbXBsYXRlLXRlc3QnOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGl2d2lkdGggPSA3MDA7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluZnJhbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhsZWZ0ID0gcGFyc2VJbnQob2JvZHkub2Zmc2V0V2lkdGgpIC0gZGl2d2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gb2JvZHkub2Zmc2V0TGVmdCArKHhsZWZ0LzIpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IDIwICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUubGVmdCA9IHgrJ3B4JzsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSB5KydweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUud2lkdGggPSBkaXZ3aWR0aCArICdweCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5pZCA9ICd0ZW1wbGF0ZS12aWV3ZXInOwogICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGZyYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5mb2N1cygpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmxvY2sgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgY291bnQ7IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGluaykgdXJsID0gbGluazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrICs9ICI8c3BhbiBjbGFzcz0nY3R4dF9ibG9jayc+UmVzdWx0OiIraSsiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihqID0gMTsgaiA8IG1hdGNoZXNbaV0ubGVuZ3RoOyBqKyspIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGogPCAxMCkgYmxvY2sgKz0gIjAiOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSBqKyI6PHRleHRhcmVhIGNvbHM9NzYgcm93cz0xPiIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICttYXRjaGVzW2ldW2pdKyI8L3RleHRhcmVhPjxicj4iOyAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVnID0gbmV3IFJlZ0V4cCgiPCIraisiPiIsICJpZyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShyZWcsIG1hdGNoZXNbaV1bal0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiVVJMOjxpbnB1dCB0eXBlPXRleHQgc2l6ZT00OCB2YWx1ZT0nIit1cmwrIic+PGJyPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9jayArPSAiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQub3BlbigpOwogICAgICAgICAgICAgICAgICAgICAgICBmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50LndyaXRlKGJsb2NrKTsKICAgICAgICAgICAgICAgICAgICAgICAgZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudC5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAqLwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFNob3dUZW1wbGF0ZXModHh0KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBlZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25vZGUtdGVtcGxhdGUnKTsKICAgICAgICAgICAgICAgIGlmKGVkaXYpIGVkaXYuaW5uZXJIVE1MID0gIiI7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZWRpdiAmJiAoYXJyID0gZXZhbCh0eHQpKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHR4dCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSBhcnJbJ2lkJ107CiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBpZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIGZsYWcgPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cm1hcCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgbmZpZWxkcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmttYXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBzdHJsaW5rbWFwID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBhcnJbJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ25vZGVpZCddLnZhbHVlID0gbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gICI8dWwgY2xhc3M9J3VsdGFiJyA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSd0ZW1wbGF0ZS1oZWFkZXInPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIui+k+WFpVVSTOa1i+ivleaooeeJiCI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIueEtuWQjua3u+WKoOWIsCZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gbmFtZSArICJbIiArIGFyclsnbnRlbXBsYXRlcyddICsgIl0iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgYXJyWydudGVtcGxhdGVzJ107IGkrKykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAgPSBhcnJbJ3RlbXBsYXRlcyddW2ldOwogICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gYmFzZTY0c3RyZGVjb2RlKHRlbXBbJ3BhdHRlcm4nXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSB0ZW1wWydmbGFncyddOwogICAgICAgICAgICAgICAgICAgICAgICB0ZW1waWQgPSB0ZW1wWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICB0YWJsZWlkID0gdGVtcFsndGFibGVpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBtYXAgPSB0ZW1wWydtYXAnXTsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua21hcCA9IHRlbXBbJ2xpbmttYXAnXTsKICAgICAgICAgICAgICAgICAgICAgICAgc3RybWFwID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG1hcC5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJtYXAgPSAie1siOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gbWFwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm1hcCArPSAie2ZpZWxkaWQ6IittYXBbeF1bJ2ZpZWxkaWQnXSsgIiwiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArIm5vZGVpZDoiK21hcFt4XVsnbm9kZWlkJ10rICIsIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJmbGFnOiIrbWFwW3hdWydmbGFnJ10rICJ9IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4IDwgKG1hcC5sZW5ndGggLSAxKSkgc3RybWFwICs9ICIsIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cm1hcCArPSAiXX0iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmxpbmttYXAgPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYobGlua21hcCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RybGlua21hcCA9ICIoeyIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJmaWVsZGlkOiciK2xpbmttYXBbJ2ZpZWxkaWQnXSsiJywiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsibm9kZWlkOiciK2xpbmttYXBbJ25vZGVpZCddKyInLCIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJmbGFnOiciK2xpbmttYXBbJ2ZsYWcnXSsiJyIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyJ9KSI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdGVtcFsndXJsJ107CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmsgPSB0ZW1wWydsaW5rJ107CiAgICAgICAgICAgICAgICAgICAgICAgIG5maWVsZHMgPSB0ZW1wWyduZmllbGRzJ10rMTsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGZvcm0gYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCknIGNsYXNzPSdsaXN0Zm9ybScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG5hbWU9J3hmb3JtIit0ZW1waWQrIicgb25zdWJtaXQ9J1hURWRpdCh0aGlzKSc+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGxpIGNsYXNzPSdsdGVtcGxhdGUnID4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8dGV4dGFyZWEgbmFtZT0ncGF0dGVybicgY29scz04MCByb3dzPTEgcmVhZG9ubHkvZGlzYWJsZWQgPiIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArcGF0dGVybisiPC90ZXh0YXJlYT4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbm9kZWlkJyB2YWx1ZT0nIitub2RlaWQrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RlbXBsYXRlaWQnIHZhbHVlPSciK3RlbXBpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nZmxhZycgdmFsdWU9JyIrZmxhZysiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndGFibGVpZCcgdmFsdWU9JyIrdGFibGVpZCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbmZpZWxkcycgdmFsdWU9JyIrbmZpZWxkcysiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbWFwJyB2YWx1ZT0nIitzdHJtYXArIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2xpbmsnIHZhbHVlPSciK2xpbmsrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2xpbmttYXAnIHZhbHVlPVwiIitzdHJsaW5rbWFwKyJcIj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ndXJsJyB2YWx1ZT0nIit1cmwrIic+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2V1cGRhdGUnIHRpdGxlPSdDaGFuZ2UnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJYVEVkaXQoJ3hmb3JtIit0ZW1waWQrIicpXCIgPiIrY2hyZWRpdCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPSdYVERlbGV0ZSgiK25vZGVpZCsiLCAiK3RlbXBpZCsiKSc+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvZm9ybT4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3VsPiI7CiAgICAgICAgICAgICAgICAgICAgZWRpdi5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdUZW1wbGF0ZXMobm9kZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgb2xkbm9kZWlkID0gZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydub2RlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIGlmKG9sZG5vZGVpZCAhPSBub2RlaWQpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgSGlkZGVuVGVtcGxhdGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEZvbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRfJytub2RlaWQpKTsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dGVtcGxhdGVfbGlzdCZub2RlaWQ9Iitub2RlaWQ7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dUZW1wbGF0ZXMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhUQWRkKG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9lZGl0IExpbmsKICAgICAgICAgICAgZnVuY3Rpb24gRWRpdExpbmsoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGxpbmsgPSAiIjsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKGxpbmsgPSBmb3JtWydsaW5rJ10udmFsdWUpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVpZCA9IGZvcm1bJ25vZGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsnbGlua190YWJsZSddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZWlkID0gZm9ybVsndGVtcGxhdGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gZm9ybVsncGF0dGVybiddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gZm9ybVsnbGluayddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSBmb3JtWyd1cmwnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICB2YXIgZmxhZyA9IDg7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfcHVibGljJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDE7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfZ2xvYmFsJ10uY2hlY2tlZCA9PSB0cnVlKSBmbGFnIHw9IDI7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSA0OwogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ21ldGhvZCddLnZhbHVlID09IDEpIGZsYWcgfD0gMTY7CiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmtfZmxhZyA9IDA7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnbGlua19tZXRob2QnXVsxXS5jaGVja2VkID09IHRydWUpIGxpbmtfZmxhZyB8PSAxNjsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydsaW5rX2xpc3QnXS5jaGVja2VkID09IHRydWUpIGxpbmtfZmxhZyB8PSA2NDsKICAgICAgICAgICAgICAgICAgICB2YXIgbGlua21hcCA9ICJbIiArIGZvcm1bJ2xpbmtfZmllbGQnXS52YWx1ZSArICcsJwogICAgICAgICAgICAgICAgICAgICAgICArIGZvcm1bJ2xpbmtfbm9kZSddLnZhbHVlICsgJywnCiAgICAgICAgICAgICAgICAgICAgICAgICsgbGlua19mbGFnICsgJ10nOwogICAgICAgICAgICAgICAgICAgIC8vYWxlcnQobGlua21hcCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm5vZGVpZD0iK25vZGVpZCsiJnRhYmxlaWQ9Iit0YWJsZWlkKyImZmxhZz0iK2ZsYWcKICAgICAgICAgICAgICAgICAgICAgICAgKyImbGlua21hcD0iK2VuY29kZVVSSUNvbXBvbmVudChsaW5rbWFwKQogICAgICAgICAgICAgICAgICAgICAgICArIiZsaW5rPSIrZW5jb2RlVVJJQ29tcG9uZW50KGxpbmspCiAgICAgICAgICAgICAgICAgICAgICAgICsiJnBhdHRlcm49IitlbmNvZGVVUklDb21wb25lbnQocGF0dGVybik7CiAgICAgICAgICAgICAgICAgICAgaWYodXJsKSBhcmd2ICs9ICImdXJsPSIrZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7CiAgICAgICAgICAgICAgICAgICAgaWYob3AgPT0gJ3RlbXBsYXRlX2FkZCcpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImb3A9dGVtcGxhdGVfYWRkIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihvcCA9PSAndGVtcGxhdGVfdXBkYXRlJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZvcD10ZW1wbGF0ZV91cGRhdGUmdGVtcGxhdGVpZD0iK3RlbXBsYXRlaWQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmKGFyZ3YgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihvcCA9PSAndGVtcGxhdGVfYWRkJykgUmVzZXRUZW1wbGF0ZWZvcm0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBIaWRkZW5UZW1wbGF0ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93VGVtcGxhdGVzKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2VkaXQgdGVtcGxhdGUKICAgICAgICAgICAgZnVuY3Rpb24gRWRpdFRlbXBsYXRlKGZvcm0sIGVsZW1lbnQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvcCA9IGZvcm1bJ29wJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGVpZCA9IGZvcm1bJ3RlbXBsYXRlaWQnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciB0YWJsZWlkID0gZm9ybVsndGFibGVpZCddLnZhbHVlOwogICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBmb3JtWydwYXR0ZXJuJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgdXJsID0gZm9ybVsndXJsJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gZm9ybVsnbWV0aG9kJ10udmFsdWU7CiAgICAgICAgICAgICAgICB2YXIgZmxhZyA9IDA7CiAgICAgICAgICAgICAgICBpZihmb3JtWydpc19wdWJsaWMnXS5jaGVja2VkID09IHRydWUpIGZsYWcgfD0gMTsKICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX2dsb2JhbCddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSAyOwogICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfaWdub3JlY2FzZSddLmNoZWNrZWQgPT0gdHJ1ZSkgZmxhZyB8PSA0OwogICAgICAgICAgICAgICAgaWYobWV0aG9kID09IDEpIGZsYWcgfD0gMTY7CiAgICAgICAgICAgICAgICB2YXIgbmZpZWxkcyA9IGZvcm1bJ25maWVsZHMnXS52YWx1ZTsKICAgICAgICAgICAgICAgIHZhciBmaWVsZGlkID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBpc191cmwgPSAwOwogICAgICAgICAgICAgICAgdmFyIGlzX2ZpbGUgPSAwOwogICAgICAgICAgICAgICAgdmFyIGlzX25lZWRfY2xlYXJodG1sID0gMDsKICAgICAgICAgICAgICAgIHZhciBpc19uZWVkX2FudGlzcGFtID0gMDsKICAgICAgICAgICAgICAgIHZhciBjaGlsZF9ub2RlaWQgPSAwOwogICAgICAgICAgICAgICAgdmFyIGNoaWxkX2ZsYWcgPSAwOwogICAgICAgICAgICAgICAgdmFyIG1hcCA9ICJ7IjsKICAgICAgICAgICAgICAgIGZvcihpID0gMTsgaSA8IG5maWVsZHM7IGkrKykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBmaWVsZGlkID0gIGZvcm1bJ2ZpZWxkaWRfJytpXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBub2RlX2ZsYWcgPSAwOwogICAgICAgICAgICAgICAgICAgIG5vZGVfaWQgPSAtMTsKICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc191cmxfJytpXS5jaGVja2VkID09IHRydWUpIAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX3VuaXFlXycraV0uY2hlY2tlZCA9PSB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDMyOwogICAgICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19maWxlXycraV0uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSAyOwogICAgICAgICAgICAgICAgICAgICAgICBpZihmb3JtWydpc19saXN0XycraV0uY2hlY2tlZCA9PSB0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDY0OwogICAgICAgICAgICAgICAgICAgICAgICBub2RlX2lkID0gZm9ybVsnbm9kZWlkXycraV0udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2lzX25lZWRfY2xlYXJodG1sXycraV0uY2hlY2tlZCA9PSB0cnVlKSAKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZV9mbGFnIHw9IDQ7CiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybVsnaXNfbmVlZF9hbnRpc3BhbV8nK2ldLmNoZWNrZWQgPT0gdHJ1ZSkgCiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVfZmxhZyB8PSA4OwogICAgICAgICAgICAgICAgICAgIG1hcCArPSAiWyIrZmllbGRpZCsiLCIrbm9kZV9pZCsiLCIrbm9kZV9mbGFnKyJdIjsKICAgICAgICAgICAgICAgICAgICBpZihpIDwgKG5maWVsZHMgLSAxKSkgbWFwICs9ICI7IjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIG1hcCArPSAifSI7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJub2RlaWQ9Iitub2RlaWQrIiZ0YWJsZWlkPSIrdGFibGVpZCsiJmZsYWc9IiAKICAgICAgICAgICAgICAgICAgICArZmxhZysiJm1hcD0iK2VuY29kZVVSSUNvbXBvbmVudChtYXApCiAgICAgICAgICAgICAgICAgICAgKyImcGF0dGVybj0iK2VuY29kZVVSSUNvbXBvbmVudChwYXR0ZXJuKTsKICAgICAgICAgICAgICAgIGlmKHVybCkgYXJndiArPSAiJnVybD0iK2VuY29kZVVSSUNvbXBvbmVudCh1cmwpOwogICAgICAgICAgICAgICAgaWYob3AgPT0gJ3RlbXBsYXRlX2FkZCcpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJm9wPXRlbXBsYXRlX2FkZCI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKG9wID09ICd0ZW1wbGF0ZV91cGRhdGUnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFyZ3YgKz0gIiZvcD10ZW1wbGF0ZV91cGRhdGUmdGVtcGxhdGVpZD0iK3RlbXBsYXRlaWQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIGlmKGFyZ3YgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChhcmd2KTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGl2cmVtb3ZlKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9wID09ICd0ZW1wbGF0ZV9hZGQnKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzZXRUZW1wbGF0ZWZvcm0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBIaWRkZW5UZW1wbGF0ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dUZW1wbGF0ZXMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vZGF0YWJhc2UKICAgICAgICAgICAgZnVuY3Rpb24gc2VsZWN0VmlldyhkaXYsIGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBlbGlzdCA9IG5ldyBBcnJheSgndGFza2luZm8nLCdkYXRhYmFzZScsICd0ZW1wbGF0ZScsIAogICAgICAgICAgICAgICAgICAgICd1cmxibG9jaycsICdkYXRhJywgJ2RucycsICdwcm94eScsICd1c2VyJyk7CiAgICAgICAgICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7CiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDsKICAgICAgICAgICAgICAgIHZhciBvbGkgPSBudWxsLCBvYiA9IG51bGwsIG9kaXYgPSBudWxsOwogICAgICAgICAgICAgICAgZm9yKGkgPSAwOyBpIDwgZWxpc3QubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoKG9saSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWInK2kpKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9saSA9PSBlbGVtZW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpLmNsYXNzTmFtZSA9ICd0YWItc2VsZWN0ZWQnOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpLmNsYXNzTmFtZSA9ICcnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihkaXYgPT0gZWxpc3RbaV0pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsaXN0W2ldKTsKICAgICAgICAgICAgICAgICAgICAgICAgb2Iuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxpc3RbaV0pOwogICAgICAgICAgICAgICAgICAgICAgICBvZGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsaXN0W2ldID09ICd0YXNraW5mbycpIAogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihvVGltZXIpIHdpbmRvdy5jbGVhckludGVydmFsKG9UaW1lcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvVGltZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoZWxpc3RbaV0gPT0gJ2RhdGFiYXNlJykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpdmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGJmb3JtJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkaXZmb3JtKSBkaXZmb3JtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZGl2Zm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYmZpZWxkZm9ybScpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXZmb3JtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihlbGlzdFtpXSA9PSAndGVtcGxhdGUnKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGl2Zm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0eHRmb3JtJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkaXZmb3JtKSBkaXZmb3JtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZGl2Zm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZS10ZXN0JykpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXZmb3JtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZGl2Zm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZS1jb25maWcnKSkpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGVsaXN0W2ldID09ICd1cmxibG9jaycpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXZmb3JtID0gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmxsaXN0LWZvcm0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRpdmZvcm0pIGRpdmZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKChkaXZmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29yZC12aWV3JykpKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXZmb3JtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihkaXYgPT0gJ3Rhc2tpbmZvJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCdPSycpOwogICAgICAgICAgICAgICAgICAgIGxvYWRUYXNrSW5mbygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihkaXYgPT0gJ2RhdGFiYXNlJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgb2RiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Ric2VsZWN0Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYob2RiLmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIExpc3RUYWJsZXMoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAndGVtcGxhdGUnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB0cmVlYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmVlYm9keScpOwogICAgICAgICAgICAgICAgICAgIGlmKHRyZWVib2R5LmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIEFkZE5vZGUoLTEsMCwiUm9vdCIsMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIEZvbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZvbGRfMCcpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAndXJsYmxvY2snKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciB1cmxibG9jayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmxibG9jaycpOwogICAgICAgICAgICAgICAgICAgIGlmKHVybGJsb2NrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsYmxvY2suc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUnOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsbGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cmwtbGlzdCcpOwogICAgICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0LmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd1cmxibG9ja2Zvcm0nXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpc3RQTm9kZXMoMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAnZGF0YScpCiAgICAgICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihkaXYgPT0gJ2RucycpCiAgICAgICAgICAgICAgICAvLyYmIG9iLmlubmVySFRNTCA9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldEROU0xpc3QoKTsKICAgICAgICAgICAgICAgICAgICBMaXN0RE5TKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGRpdiA9PSAncHJveHknKQogICAgICAgICAgICAgICAgLy8mJiBvYi5pbm5lckhUTUwgPT0gJycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRQcm94eUxpc3QoKTsKICAgICAgICAgICAgICAgICAgICBMaXN0UHJveHkoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoZGl2ID09ICd1c2VyJykKICAgICAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gbG9hZFRhc2tJbmZvKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgVmlld1Rhc2soJ3Rhc2tfdmlldycpOwogICAgICAgICAgICAgICAgb1RpbWVyID0gd2luZG93LnNldEludGVydmFsKCJWaWV3VGFzaygndGFza192aWV3JykiLCAxMDAwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gR2V0Q29udGVudCh1cmwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKGFyZ3YgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIC8veG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAvL3htbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQobnVsbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gSGlkZGVuREJGaWVsZGZvcm0oKTsKICAgICAgICAgICAgfQoJICAgICAgICBmdW5jdGlvbiBnZXRGcmFtZURvY3VtZW50KGlkKQoJICAgICAgICB7CgkgICAgICAgICAgICB2YXIgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwoJICAgICAgICAgICAgdmFyIERvYyA9IG51bGw7CgkgICAgICAgICAgICBpZihpZnJhbWUpCgkgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgaWYoaWZyYW1lLmRvY3VtZW50KQoJICAgICAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICAgICAgRG9jID0gaWZyYW1lLmRvY3VtZW50OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmKGlmcmFtZS5jb250ZW50RG9jdW1lbnQpIC8vIEZvciBOUzYKCSAgICAgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgICAgIERvYyA9IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYoaWZyYW1lLmNvbnRlbnRXaW5kb3cpCgkgICAgICAgICAgICAgICAgewoJICAgICAgICAgICAgICAgICAgICBEb2MgPSBpZnJhbWUuY29udGVudFdpbmRvdy5kb2N1bWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYoRG9jKQoJICAgICAgICAgICAgICAgIHsKCSAgICAgICAgICAgICAgICAgICAgaWYoRG9jLmRlc2lnbk1vZGUpIERvYy5kZXNpZ25Nb2RlID0gJ09uJzsKCSAgICAgICAgICAgICAgICAgICAgaWYoRG9jLmNvbnRlbnRFZGl0YWJsZSkgRG9jLmNvbnRlbnRFZGl0YWJsZSA9IHRydWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIERvYzsKCSAgICAgICAgfQoJICAgICAgICBmdW5jdGlvbiBnZXRTZWxlY3RDb250ZW50KGlkKQoJICAgICAgICB7CgkgICAgICAgICAgICB2YXIgRG9jID0gZ2V0RnJhbWVEb2N1bWVudChpZCk7CgkgICAgICAgICAgICBpZihEb2MpCgkgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoRG9jLmdldFNlbGVjdGlvbikKICAgICAgICAgICAgICAgICAgICB7CgkgICAgICAgICAgICAgICAgICAgIGFsZXJ0KERvYy5nZXRTZWxlY3Rpb24oKS5wYXJlbnROb2RlLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoRG9jLnNlbGVjdGlvbikKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KERvYy5zZWxlY3Rpb24ucGFyZW50Tm9kZS5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3U2VsZWN0KGUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsKICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICAgICAgICAgICAgaWYoZWxlbWVudC5pbm5lckhUTUwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQoZWxlbWVudC5wYXJlbnROb2RlLmlubmVySFRNTCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gTG9hZExpbmtPcHRpb25zKCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIG5vZGVpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIHRhYmxlaWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBmbGFnID0gMDsKICAgICAgICAgICAgICAgIHZhciBvZGl2ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBsaW5rbWFwID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBvc2VsZWN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciBkYmFzZSA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd0ZW1wbGF0ZWZvcm0nXTsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgKG5vZGVpZCA9IGZvcm1bJ25vZGVpZCddLnZhbHVlKSA+IDAgKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ2xpbmttYXAnXS52YWx1ZSkgbGlua21hcCA9IGV2YWwoZm9ybVsnbGlua21hcCddLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICBmbGFnID0gZm9ybVsnZmxhZyddLnZhbHVlOwogICAgICAgICAgICAgICAgICAgIHRhYmxlaWQgPSBmb3JtWyd0YWJsZWlkJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgaWYoKG9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0YWJhc2UnKSkKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKHN0cmRiID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2RiYXNlJykpIAogICAgICAgICAgICAgICAgICAgICAgICAmJiAoZGJhc2UgPSBldmFsKHN0cmRiKSkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0ID0gZm9ybVsnbGlua190YWJsZSddOwogICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih4IGluIGRiYXNlWyd0YWJsZXMnXSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGUgPSBkYmFzZVsndGFibGVzJ11beF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0gPSBuZXcgT3B0aW9uKHRhYmxlWyduYW1lJ10sIHgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGlua21hcCAmJiB4ID09IHRhYmxlaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsraTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwICYmIHRhYmxlaWQgID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZHMgPSBkYmFzZVsndGFibGVzJ11bdGFibGVpZF1bJ2ZpZWxkcyddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdCA9IGZvcm1bJ2xpbmtfZmllbGQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9ucy5sZW5ndGggPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBmaWVsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldID0gbmV3IE9wdGlvbihmaWVsZHNbeF1bJ25hbWUnXSwgeCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobGlua21hcCAmJiBmbGFnID49IDAgJiYgKGZsYWcgJiA4KSAmJiB4ID09IGxpbmttYXBbJ2ZpZWxkaWQnXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1tpXS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsraTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB2YXIgc3RyY2hpbGRzID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCAmJiAob2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdub2RlJytub2RlaWQpKQogICAgICAgICAgICAgICAgICAgICAgICAmJiAoc3RyY2hpbGRzID0gb2Rpdi5nZXRBdHRyaWJ1dGUoJ2NoaWxkcycpKSAKICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGNoaWxkcyA9IGV2YWwoc3RyY2hpbGRzKSkgKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGZvcm1bJ2xpbmttYXAnXS52YWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3QgPSBmb3JtWydsaW5rX25vZGUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGNoaWxkcykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBjaGlsZHMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW2ldID0gbmV3IE9wdGlvbihjaGlsZHNbeF0sIHgpOyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5rbWFwICYmIHggPT0gbGlua21hcFsnbm9kZWlkJ10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbaV0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2k7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChzdHJjaGlsZHMpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoJCSAgICBmdW5jdGlvbiBMb2FkVVJMKGZvcm0pCgkJICAgIHsKCQkgICAgICAgIHZhciB1cmwgPSBmb3JtWyd1cmwnXS52YWx1ZTsKCQkgICAgICAgIGlmKHVybCkKCQkgICAgICAgIHsKCQkgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CgkJICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCgkJICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdFVSTCA9ICcvcHJveHkvJyt1cmw7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGhvZCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvcm1bJ21ldGhvZCddWzFdLmNoZWNrZWQgPT0gdHJ1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2QgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKHBvcyA9IHVybC5pbmRleE9mKCc/JykpID49IDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFVSTCA9ICcvcHJveHkvJyt1cmwuc3Vic3RyaW5nKDAsIHBvcy0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gdXJsLnN1YnN0cmluZyhwb3MgKyAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0VVJMID0gJy9wcm94eS8nK3VybDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCByZXF1ZXN0VVJMLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHsKCQkgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RVUkwgPSAnL3Byb3h5LycrdXJsOwoJCSAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdHRVQnLCByZXF1ZXN0VVJMLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3YgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKCQkgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQoJCSAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKCQkgICAgICAgICAgICAgICAgICAgICAgICB7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSB4bWxIdHRwLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXYgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3VyY2VfY29kZV9vcCcpKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGl2LnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lIjsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc291cmNlX3ZpZXcnKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudCkgZWxlbWVudC5pbm5lckhUTUwgPSAiIjsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgiaWQiLCAnZWRpdG9yLWZyYW1lJyk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZnJhbWUpOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gbnVsbDsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKGRvYyA9IGdldEZyYW1lRG9jdW1lbnQoJ2VkaXRvci1mcmFtZScpKSkKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxzdHIgPSBzdHI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdHIubWF0Y2goLzxiYXNlIC4qP2hyZWY9Lio/Pi9pKSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiYXNldXJsID0gdXJsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigocG9zID0gdXJsLmxhc3RJbmRleE9mKCcvJykpID4gNikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2V1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIHBvcysxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VocmVmID0gIjxoZWFkPjxiYXNlIGhyZWY9JyIrYmFzZXVybCsiJz4iOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgPSBzdHIucmVwbGFjZSgvPGhlYWQ+L2ksIGJhc2VocmVmKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5vcGVuKCk7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2Mud3JpdGUoaHRtbHN0cik7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MuY2xvc2UoKTsKCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigoZWRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wbGF0ZWRpdicpKSkgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXYuc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUiOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydjb2RlJ10udmFsdWUgPSBzdHI7CgkJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ3VybCddLnZhbHVlID0gdXJsOwoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZm9ybXNbJ3RlbXBsYXRlZm9ybSddWydtZXRob2QnXS52YWx1ZSA9IG1ldGhvZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewoJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5mb3Jtc1sndGVtcGxhdGVmb3JtJ11bJ2NvZGUnXS52YWx1ZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID0geG1sSHR0cC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkJICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyX3dhaXQoKTsKCQkgICAgICAgICAgICAgICAgfQoJCSAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0X3dhaXQoKTsKCQkgICAgICAgICAgICB9CgkJICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gVmlld0RhdGFiYXNlKCk7CgkJICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gUmVzZXREaXYoaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICAgICAgICAgICAgICBpZihkaXYpIGRpdi5pbm5lckhUTUwgPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldFVSTExpc3QoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd1cmxibG9ja2Zvcm0nXTsKICAgICAgICAgICAgICAgIGlmKGZvcm0pCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXREaXYoJ3VybC1saXN0Jyk7CiAgICAgICAgICAgICAgICAgICAgZm9ybVsnbGV2ZWwnXS5vcHRpb25zWzBdLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBmb3JtWyd1cmwnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ3VybCddLnZhbHVlID0gJ2h0dHA6Ly8nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RQTm9kZXMobm9kZWlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd1cmxibG9ja2Zvcm0nXTsKICAgICAgICAgICAgICAgIGlmKGZvcm0gJiYgbm9kZWlkID49IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAiIjsKICAgICAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPW5vZGVfYnJvdGhlciZub2RlaWQ9Iitub2RlaWQ7CiAgICAgICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD1ub2RlX2NoaWxkcyZub2RlaWQ9Iitub2RlaWQ7CiAgICAgICAgICAgICAgICAgICAgLy9hbGVydChhcmd2KTsKICAgICAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYoYXJndiAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9SZXNldFVSTExpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG5vZGUgPSBldmFsKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9zZWxlY3QgPSBmb3JtWydub2RlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3NlbGVjdCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IDAsIHggPSAxLCB0aWQgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRuYW1lID0gIi4uIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRub2RlWydpZCddID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc2VsZWN0Lm9wdGlvbnNbeCsrXT1uZXcgT3B0aW9uKHRuYW1lLCB0bm9kZVsnaWQnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IDA7IGkgPCB0bm9kZVsnbmNoaWxkcyddOyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlkID0gdG5vZGVbJ2NoaWxkcyddW2ldWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRuYW1lID0gdG5vZGVbJ2NoaWxkcyddW2ldWyduYW1lJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYobm9kZWlkID09IHRpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NlbGVjdC5vcHRpb25zW3hdID0gbmV3IE9wdGlvbih0bmFtZSwgdGlkLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zZWxlY3Qub3B0aW9uc1t4XSA9IG5ldyBPcHRpb24odG5hbWUsIHRpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyt4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBtb3ZlQ2hpbGROb2Rlcyhmb3JtLCBub2RlaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBvbGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgb2NoaWxkcyA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChvbGlzdCA9IGZvcm1bJ25vZGVpZCddKSAmJiAob2NoaWxkcyA9IGZvcm1bJ2NoaWxkcyddKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvbGlzdC5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgeCA9IDE7CiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAxOyBpIDwgb2NoaWxkcy5vcHRpb25zLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdG5hbWUgPSBvY2hpbGRzLm9wdGlvbnNbaV0udGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgdGlkID0gb2NoaWxkcy5vcHRpb25zW2ldLnZhbHVlOwogICAgICAgICAgICAgICAgICAgICAgICBpZih0aWQgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0bmFtZSA9PSAnKicpIHRuYW1lID0gJy4uJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA9PSB0aWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpc3Qub3B0aW9uc1t4KytdID0gbmV3IE9wdGlvbih0bmFtZSwgdGlkLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xpc3Qub3B0aW9uc1t4KytdID0gbmV3IE9wdGlvbih0bmFtZSwgdGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBvY2hpbGRzLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMaXN0Tm9kZVVSTHMoZm9ybSwgb25hbWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIG9zZWxlY3QgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gMDsKICAgICAgICAgICAgICAgIHZhciBvdGV4dCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChvc2VsZWN0ID0gZm9ybVtvbmFtZV0pICYmIChpbmRleCA9IG9zZWxlY3Quc2VsZWN0ZWRJbmRleCkgPiAwIAogICAgICAgICAgICAgICAgICAgICYmIChub2RlaWQgPSBvc2VsZWN0Lm9wdGlvbnNbaW5kZXhdLnZhbHVlKSA+PSAwIAogICAgICAgICAgICAgICAgICAgICYmIChvdGV4dCA9IG9zZWxlY3Qub3B0aW9uc1tpbmRleF0udGV4dCkgIT0gJyonKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKG9uYW1lID09ICdjaGlsZHMnKSBtb3ZlQ2hpbGROb2Rlcyhmb3JtLCBub2RlaWQpOwogICAgICAgICAgICAgICAgICAgIGxldmVsID0gZm9ybVsnbGV2ZWwnXS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBSZXNldFVSTExpc3QoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTGlzdFVSTHMoJ2xpc3QnLCBub2RlaWQsIGxldmVsLCAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3Q2hpbGRzVVJMKHVybG5vZGVpZCwgbGV2ZWwsIHBhZ2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZih1cmxub2RlaWQgPj0gMCAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFVSTExpc3QoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD11cmxub2RlX2NoaWxkcyZ1cmxub2RlaWQ9Iit1cmxub2RlaWQrIiZwYWdlPSIrcGFnZTsKICAgICAgICAgICAgICAgICAgICBpZihsZXZlbCA+PSAwKSBhcmd2ICs9ICImbGV2ZWw9IitsZXZlbDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd05vZGVVUkxzKHhtbEh0dHAucmVzcG9uc2VUZXh0LCBwYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RVUkxzKHR5cGUsIG5vZGVpZCwgbGV2ZWwsIHBhZ2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihub2RlaWQgPj0gMCAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBSZXNldFVSTExpc3QoKTsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICIiOwogICAgICAgICAgICAgICAgICAgIGlmKHR5cGUgPT0gJ2xpc3QnKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiA9ICJvcD11cmxub2RlX2xpc3Qmbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ID0gIm9wPXVybG5vZGVfY2hpbGRzJnVybG5vZGVpZD0iK25vZGVpZDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJnBhZ2U9IitwYWdlOwogICAgICAgICAgICAgICAgICAgIGlmKGxldmVsID49IDApIGFyZ3YgKz0gIiZsZXZlbD0iK2xldmVsOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93Tm9kZVVSTHMoeG1sSHR0cC5yZXNwb25zZVRleHQsIHBhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBWaWV3UmVjb3Jkcyh0eHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBucmVjb3JkcyA9IDA7CiAgICAgICAgICAgICAgICB2YXIgcmVzID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciByZWNvcmRzID0gbnVsbDsKICAgICAgICAgICAgICAgIHZhciB4ID0gMDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiAocmVzID0gZXZhbCh0eHQpKSAhPSBudWxsICYmIChyZWNvcmRzID0gcmVzWydyZWNvcmRzJ10pIAogICAgICAgICAgICAgICAgICAgICYmIChucmVjb3JkcyA9IHJlc1snbnJlY29yZHMnXSkgPiAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBzdHIgPSAiPGRpdiBpZD0ncmVjb3JkLWhlYWRlcicgb25tb3VzZWRvd249JyI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiZGl2bW92ZShldmVudCwgdGhpcyknPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSdkaXZyZW1vdmUoIjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJ0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID5YPC9zcGFuPiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHNwYW4gY2xhc3M9J2Nsb3NldHh0JyBvbmNsaWNrPSdkaXZyZW1vdmUoIjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICJ0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZSknID7lhbPpl608L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDvnu5Pmnpw6IitucmVjb3JkcysiPC9kaXY+IjsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8ZGl2IGlkPSdyZWNvcmQtcmVzJyA+IjsKICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiByZWNvcmRzKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8c3BhbiBjbGFzcz0ncmVjb3JkLXRpdGxlJz4iK3JlY29yZHNbeF1bJ25hbWUnXSsiPC9zcGFuPjxocj4iOwogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjxzcGFuID4iCiAgICAgICAgICAgICAgICAgICAgICAgIHN0ciArPSAiPHRleHRhcmVhIGNvbHM9OTAgcm93cz00ID4iK2Jhc2U2NHN0cmRlY29kZShyZWNvcmRzW3hdWydkYXRhJ10pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIjwvdGV4dGFyZWE+PGJyPiI7ICAgIAogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gIjwvc3Bhbj48aHI+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc3RyICs9ICI8L2Rpdj4iOwogICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICBpZigoZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWNvcmQtdmlldycpKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IHN0cjsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlkID0gJ3JlY29yZC12aWV3JzsKICAgICAgICAgICAgICAgICAgICB2YXIgZGl2d2lkdGggPSA3NTA7CiAgICAgICAgICAgICAgICAgICAgdmFyIG9ib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5mcmFtZScpOwogICAgICAgICAgICAgICAgICAgIHZhciB4bGVmdCA9IHBhcnNlSW50KG9ib2R5Lm9mZnNldFdpZHRoKSAtIGRpdndpZHRoOwogICAgICAgICAgICAgICAgICAgIHZhciB4ID0gb2JvZHkub2Zmc2V0TGVmdCArKHhsZWZ0LzIpOwogICAgICAgICAgICAgICAgICAgIHZhciB5ID0gMjAgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDsKICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLmxlZnQgPSB4KydweCc7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS50b3AgPSB5KydweCc7CiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IGRpdndpZHRoICsgJ3B4JzsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFZpZXdSZWNvcmQocmVjb3JkaWQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihyZWNvcmRpZCA+IDAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cmVjb3JkX3ZpZXcmcmVjb3JkaWQ9IityZWNvcmRpZDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmlld1JlY29yZHMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvKiBTaG93IE5vZGUgVVJMcyAqLwogICAgICAgICAgICBmdW5jdGlvbiBTaG93Tm9kZVVSTHModHh0LCBwYWdlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmZvcm1zWyd1cmxibG9ja2Zvcm0nXTsKICAgICAgICAgICAgICAgIHZhciB1cmxsaXN0ID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmKHR4dCAmJiBmb3JtICYmICh1cmxsaXN0ID0gZXZhbCh0eHQpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc2V0VVJMTGlzdCgpOyAKICAgICAgICAgICAgICAgICAgICB2YXIgdXJsaXRlbSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdmFyIG5vZGVpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciB0bmFtZSA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBuY2hpbGRzID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgdXJsbm9kZWlkID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlY29yZGlkID0gLTE7CiAgICAgICAgICAgICAgICAgICAgdmFyIG9jaGlsZHMgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHZhciBpID0gMCwgeCA9IDE7CiAgICAgICAgICAgICAgICAgICAgaWYoKG9jaGlsZHMgPSBmb3JtWydjaGlsZHMnXSkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBub2RlaWQgPSB1cmxsaXN0Wydub2RlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBpZCA9IHVybGxpc3RbJ3BhcmVudCddOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgb25vZGUgPSBmb3JtWydub2RlaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChwaWQrIjoiK25vZGVpZCsiOiIrb25vZGUudmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihvbm9kZS5vcHRpb25zW29ub2RlLnNlbGVjdGVkSW5kZXhdLnRleHQgPT0gJy4uJyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IG9ub2RlLm9wdGlvbnNbb25vZGUuc2VsZWN0ZWRJbmRleF0udmFsdWUgIT0gbm9kZWlkKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0UE5vZGVzKG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaSA9IDAsIHggPSAxLCB6ID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgb2NoaWxkcy5vcHRpb25zLmxlbmd0aCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3RbJ250bm9kZXMnXSA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5vZGVpZCA+IDApb2NoaWxkcy5vcHRpb25zW3grK10gPSBuZXcgT3B0aW9uKCcqJywgbm9kZWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvbGlzdGNoaWxkcyA9IGRvY3VtZW50LmZvcm1zWyd1cmxsaXN0LWFkZC1mb3JtJ11bJ25vZGVpZCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob2xpc3RjaGlsZHMpIG9saXN0Y2hpbGRzLm9wdGlvbnMubGVuZ3RoID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihpIGluIHVybGxpc3RbJ3Rub2RlcyddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVpZCA9IHVybGxpc3RbJ3Rub2RlcyddW2ldWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRuYW1lID0gdXJsbGlzdFsndG5vZGVzJ11baV1bJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuY2hpbGRzID0gdXJsbGlzdFsndG5vZGVzJ11baV1bJ25jaGlsZHMnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvY2hpbGRzLm9wdGlvbnNbeCsrXSA9IG5ldyBPcHRpb24odG5hbWUsIG5vZGVpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob2xpc3RjaGlsZHMpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGlzdGNoaWxkcy5vcHRpb25zW3orK10gPSBuZXcgT3B0aW9uKHRuYW1lLCBub2RlaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0ndXJsLXVsJz4iOwogICAgICAgICAgICAgICAgICAgIHZhciBmcm9tID0gMCwgdG8gPSAwOwogICAgICAgICAgICAgICAgICAgIHZhciBwaHRtbHN0ciA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBsZXZlbCA9IDA7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBwcGlkID0gMDsKICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9ICJsaXN0IjsKICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IGZvcm1bJ2xldmVsJ10udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgbm9kZWlkID0gdXJsbGlzdFsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgZnJvbSA9IHBhcnNlSW50KHBhZ2UpIC0gMTA7CiAgICAgICAgICAgICAgICAgICAgaWYoZnJvbSA8IDEpIGZyb20gPSAxOwogICAgICAgICAgICAgICAgICAgIHRvID0gZnJvbSArIDIwOwogICAgICAgICAgICAgICAgICAgIGlmKHRvID4gdXJsbGlzdFsncGFnZXMnXSkgdG8gPSBwYXJzZUludCh1cmxsaXN0WydwYWdlcyddKSArIDE7CiAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIjxsaSBjbGFzcz0ndXJsbGktaGVhZGVyJz4gIjsKICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0Wydpc19jaGlsZHMnXSA+IDApIHR5cGUgPSAiY2hpbGRzIjsKICAgICAgICAgICAgICAgICAgICBlbHNlIHR5cGUgPSAibGlzdCI7CiAgICAgICAgICAgICAgICAgICAgaWYoKHBwaWQgPSB1cmxsaXN0WydwcGlkJ10pID4gMCkgCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiWzxhIGhyZWY9J2phdmFzY3JpcHQ6OycgY2xhc3M9J2VhZGQnIG9uY2xpY2s9XCJMaXN0VVJMcygnIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgK3R5cGUrIicsIitwcGlkKyIsICIrbGV2ZWwrIiwgMSk7XCI+5LiK5LiA5bGCPC9hPl0mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiVVJM5oC75pWw77yaIit1cmxsaXN0Wyd0b3RhbCddOwogICAgICAgICAgICAgICAgICAgIGlmKHVybGxpc3RbJ3BhZ2VzJ10gPiAxKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIiDlhbEiK3VybGxpc3RbJ3BhZ2VzJ10rIumhtSI7CiAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihmcm9tID4gMjApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8YSBjbGFzcz0ndXJsLWxpLXBhZ2UnIGhyZWY9J2phdmFzY3JpcHQ6OycgIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICIgb25jbGljaz1cIkxpc3RVUkxzKCciK3R5cGUrIicsICIrbm9kZWlkKyIsJyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbGV2ZWwrIicsJzEnKTtcIj4xPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Li4uIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBmb3IoaSA9IGZyb207IGkgPCB0bzsgaSsrKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGkgPT0gcGFnZSkgcGh0bWxzdHIgKz0gaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIjxhIGNsYXNzPSd1cmwtbGktcGFnZScgaHJlZj0namF2YXNjcmlwdDo7JyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICJvbmNsaWNrPVwiTGlzdFVSTHMoJyIrdHlwZSsiJywgIitub2RlaWQrIiwnIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArbGV2ZWwrIicsJyIraSsiJyk7XCI+IitpKyI8L2E+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZih0byA8ICh1cmxsaXN0WydwYWdlcyddIC0gMjApKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gdXJsbGlzdFsncGFnZXMnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsuLi4mbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIjxhIGNsYXNzPSd1cmwtbGktcGFnZScgaHJlZj0namF2YXNjcmlwdDo7JyAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGh0bWxzdHIgKz0gIm9uY2xpY2s9XCJMaXN0VVJMcygnIit0eXBlKyInLCAiK25vZGVpZCArIiwnIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICtsZXZlbCsiJywnIitpKyInKTtcIj4iK2krIjwvYT4iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgaWYocGh0bWxzdHIgIT0gIiIpaHRtbHN0ciArPSBwaHRtbHN0ciArICI8aHI+IjsKICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KHBodG1sc3RyKTsKICAgICAgICAgICAgICAgICAgICBpID0gMDsKICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiB1cmxsaXN0Wyd1cmxub2RlcyddKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgICAgICAgICB1cmxpdGVtID0gdXJsbGlzdFsndXJsbm9kZXMnXVt4XTsKICAgICAgICAgICAgICAgICAgICAgICAgbm9kZWlkID0gdXJsaXRlbVsnbm9kZWlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHVybGlkID0gdXJsaXRlbVsndXJsaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWwgPSB1cmxpdGVtWydsZXZlbCddOwogICAgICAgICAgICAgICAgICAgICAgICB1cmxub2RlaWQgPSB1cmxpdGVtWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICByZWNvcmRpZCA9IHVybGl0ZW1bJ3JlY29yZGlkJ107CiAgICAgICAgICAgICAgICAgICAgICAgIG5jaGlsZHMgPSB1cmxpdGVtWyduY2hpbGRzJ107CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHVybGl0ZW1bJ3VybCddOwogICAgICAgICAgICAgICAgICAgICAgICBjc3MgPSAndXJsLWxpJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYodXJsaXRlbVsnc3RhdHVzJ10gPCAwKSBjc3MgPSAndXJsLWxpLXdhcm4nOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8bGkgY2xhc3M9JyIrY3NzKyInIG9ubW91c2VvdXQ9XCJvdXREaXYodGhpcywnIitjc3MrIicpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ3VybC1saS1zZWxlY3RlZCcpXCIgPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gaSsiOiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxhIHRhcmdldD0nX2JsYW5rJyBocmVmPSciK3VybCsiJz4iK3VybCsiPC9hPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKG5jaGlsZHMgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJbPHNwYW4gY2xhc3M9J2V2aWV3JyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25jbGljaz1cIlZpZXdDaGlsZHNVUkwoIit1cmxub2RlaWQrIiwwLDEpXCI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gbmNoaWxkcysiPC9zcGFuPl0iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzZWxlY3QgbmFtZT0nbGV2ZWwnIG9uY2hhbmdlPVwiVXBkYXRlTm9kZVVSTCgiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9IG5vZGVpZCsiLCIrdXJsbm9kZWlkKyIsICIrdXJsaWQrIiwgdGhpcywgIitwYWdlKyIpXCI+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuS8mOWFiOe6pzwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxvcHRpb24gdmFsdWU9JzAnICI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxldmVsID09IDApIGh0bWxzdHIgKz0gInNlbGVjdGVkPXRydWUiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI+5pmu6YCaPC9vcHRpb24+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPG9wdGlvbiB2YWx1ZT0nMSciOwogICAgICAgICAgICAgICAgICAgICAgICBpZihsZXZlbCA9PSAxKSBodG1sc3RyICs9ICJzZWxlY3RlZD10cnVlIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPue0p+aApTwvb3B0aW9uPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvc2VsZWN0PiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlY29yZGlkID4gMCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiJm5ic3A7Jm5ic3A7Jm5ic3A7IjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdldmlldycgdGl0bGU9J1ZpZXcnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiVmlld1JlY29yZCgiK3JlY29yZGlkKyIpXCI+IitjaHJ2aWV3KyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZih1cmxsaXN0WydudG5vZGVzJ10gPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPHNwYW4gY2xhc3M9J2VhZGQnIHRpdGxlPSdBZGQnICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiWEFkZE5vZGVVUkwoZXZlbnQsICIrdXJsbm9kZWlkKyIpXCI+IitjaHJhZGQrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIiZuYnNwOyZuYnNwOyZuYnNwOyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdlZGVsZXRlJyB0aXRsZT0nRGVsZXRlJyAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICJvbmNsaWNrPVwiRGVsZXRlTm9kZVVSTCgiK25vZGVpZCsiLCAiK3VybG5vZGVpZCsiLCIrdXJsaWQrIiwiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICInIit1cmwrIicsJyIrcGFnZSsiJylcIj4iK2NocmRlbCsiPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvbGk+IjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYodXJsbGlzdFsncGFnZXMnXSA+IDEpIGh0bWxzdHIgKz0gIjxocj4iOwogICAgICAgICAgICAgICAgICAgIGlmKHBodG1sc3RyICE9ICIiKWh0bWxzdHIgKz0gcGh0bWxzdHI7CiAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC91bD4iOwogICAgICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXJsLWxpc3QnKTsKICAgICAgICAgICAgICAgICAgICBpZihkaXYpIGRpdi5pbm5lckhUTUwgPSBodG1sc3RyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnVuY3Rpb24gSGlkZGVuVVJMTGlzdEZvcm0oKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VybGxpc3QtZm9ybScpOwogICAgICAgICAgICAgICAgaWYoZGl2KSBkaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGROb2RlVVJMKGZvcm0pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBub2RlaWQgPSAtMTsKICAgICAgICAgICAgICAgIHZhciBwYXJlbnRpZCA9IC0xOwogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoZm9ybSAmJiAobm9kZWlkID0gZm9ybVsnbm9kZWlkJ10udmFsdWUpID4gMCAKICAgICAgICAgICAgICAgICAgICAmJiAodXJsID0gZm9ybVsndXJsJ10udmFsdWUpCiAgICAgICAgICAgICAgICAgICAgJiYgKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9dXJsbm9kZV9hZGQmbm9kZWlkPSIrbm9kZWlkOwogICAgICAgICAgICAgICAgICAgICAgICBhcmd2ICs9ICImdXJsPSIrZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7CiAgICAgICAgICAgICAgICAgICAgaWYoKHBhcmVudGlkID0gZm9ybVsncGFyZW50aWQnXS52YWx1ZSkgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJnBhcmVudGlkPSIrcGFyZW50aWQ7CiAgICAgICAgICAgICAgICAgICAgaWYoKGxldmVsID0gZm9ybVsnbGV2ZWwnXS52YWx1ZSkgPj0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgYXJndiArPSAiJmxldmVsPSIrbGV2ZWw7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd05vZGVVUkxzKHhtbEh0dHAucmVzcG9uc2VUZXh0LCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEhpZGRlblVSTExpc3RGb3JtKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBYQWRkTm9kZVVSTChlLCBwYXJlbnRpZCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgICAgICAgICAgICB2YXIgWGRpdiA9ICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidXJsbGlzdC1mb3JtIik7CiAgICAgICAgICAgICAgICB2YXIgeCA9IGUuY2xpZW50WCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdDsKICAgICAgICAgICAgICAgIHZhciB5ID0gZS5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmxlZnQgPSB4OwogICAgICAgICAgICAgICAgWGRpdi5zdHlsZS50b3AgPSB5ICsgMTA7CiAgICAgICAgICAgICAgICBYZGl2LnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lJzsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbInVybGxpc3QtYWRkLWZvcm0iXTsKICAgICAgICAgICAgICAgIGZvcm1bJ3BhcmVudGlkJ10udmFsdWUgPSBwYXJlbnRpZDsKICAgICAgICAgICAgICAgIGZvcm1bJ3VybCddLmZvY3VzKCk7CiAgICAgICAgICAgICAgICBmb3JtWyd1cmwnXS52YWx1ZSA9ICdodHRwOi8vJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gVXBkYXRlTm9kZVVSTChub2RlaWQsIHVybG5vZGVpZCwgdXJsaWQsIG9zZWxlY3QsIHBhZ2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSAob3NlbGVjdCkgPyBvc2VsZWN0LnNlbGVjdGVkSW5kZXggOiAwOwogICAgICAgICAgICAgICAgdmFyIGxldmVsID0gKGluZGV4ID49IDApID8gb3NlbGVjdC5vcHRpb25zW2luZGV4XS52YWx1ZSA6IC0xOwogICAgICAgICAgICAgICAgdmFyIHRleHQgPSAoaW5kZXggPj0gMCk/IG9zZWxlY3Qub3B0aW9uc1tpbmRleF0udGV4dCA6ICIiOwogICAgICAgICAgICAgICAgaWYobm9kZWlkID4gMCAmJiB1cmxub2RlaWQgPiAwICYmIGxldmVsID49IDAKICAgICAgICAgICAgICAgICAgICAmJiBjb25maXJtKCLmgqjnoa7orqTkv67mlLnkvJjlhYjnuqfkuLpbIit0ZXh0KyJdPyIpCiAgICAgICAgICAgICAgICAgICAgJiYoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD11cmxub2RlX3VwZGF0ZSZub2RlaWQ9Iitub2RlaWQrIiZ1cmxub2RlaWQ9IiAKICAgICAgICAgICAgICAgICAgICAgICAgK3VybG5vZGVpZCsiJnVybGlkPSIrdXJsaWQrIiZsZXZlbD0iK2xldmVsOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93Tm9kZVVSTHMoeG1sSHR0cC5yZXNwb25zZVRleHQsIHBhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERlbGV0ZU5vZGVVUkwobm9kZWlkLCB1cmxub2RlaWQsIHVybGlkLCB1cmwsIHBhZ2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihub2RlaWQgPiAwICYmIHVybG5vZGVpZCA+IDAgCiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgi5oKo56Gu6K6k5Yig6ZmkVVJMWyIrdXJsKyJdID8iKQogICAgICAgICAgICAgICAgICAgICYmKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD11cmxub2RlX2RlbGV0ZSZub2RlaWQ9Iitub2RlaWQrIiZ1cmxub2RlaWQ9IgogICAgICAgICAgICAgICAgICAgICt1cmxub2RlaWQrIiZ1cmxpZD0iK3VybGlkOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93Tm9kZVVSTHMoeG1sSHR0cC5yZXNwb25zZVRleHQsIHBhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgICAgICBSZXNldERpdigndXJsLWxpc3QnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFJlc2V0RE5TTGlzdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2Rucy1hZGQtZm9ybSddOwogICAgICAgICAgICAgICAgaWYoZm9ybSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBmb3JtWydob3N0J10uZm9jdXMoKTsKICAgICAgICAgICAgICAgICAgICBmb3JtWydob3N0J10udmFsdWUgPSAnJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBTaG93RE5TKHR4dCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkbnMtbGlzdCcpOwogICAgICAgICAgICAgICAgdmFyIG9iamRuc2xpc3QgPSBudWxsOwogICAgICAgICAgICAgICAgdmFyIGRuc2xpc3QgPSBudWxsOwogICAgICAgICAgICAgICAgaWYodHh0ICYmIGRpdiAmJiAob2JqZG5zbGlzdCA9IGV2YWwodHh0KSkgIT0gbnVsbCAKICAgICAgICAgICAgICAgICAgICAmJiAoZG5zbGlzdCA9IG9iamRuc2xpc3RbJ2Ruc2xpc3QnXSkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRETlNMaXN0KCk7IAogICAgICAgICAgICAgICAgICAgIHZhciBob3N0aWQgPSAtMTsKICAgICAgICAgICAgICAgICAgICB2YXIgaG9zdCA9ICIiOwogICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSAtMTsKICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbHN0ciA9ICI8dWwgY2xhc3M9J2Rucy11bCc+IjsKICAgICAgICAgICAgICAgICAgICBmb3IoeCBpbiBkbnNsaXN0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaG9zdGlkID0gZG5zbGlzdFt4XVsnaWQnXTsKICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9ICBkbnNsaXN0W3hdWydob3N0J107CiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IGRuc2xpc3RbeF1bJ3N0YXR1cyddOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8bGkgY2xhc3M9J2Rucy1saScgb25tb3VzZW91dD1cIm91dERpdih0aGlzLCAnZG5zLWxpJylcIiAiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICIgb25tb3VzZW1vdmU9XCJvbkRpdih0aGlzLCAnZG5zLWxpLXNlbGVjdGVkJylcIiA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBob3N0OwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihzdGF0dXMgPiAwKSBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nc3RhdHVzX2Vycic+5pyJ5pWIPC9zcGFuPiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgIGh0bWxzdHIgKz0gIjxzcGFuIGNsYXNzPSdzdGF0dXNfb2snPuWkseaViDwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZUROUygiK2hvc3RpZCsiLCAnIitob3N0KyInKVwiPiIrY2hyZGVsKyI8L3NwYW4+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiPC9saT4iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L3VsPiI7CiAgICAgICAgICAgICAgICAgICAgZGl2LmlubmVySFRNTCA9IGh0bWxzdHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGRETlMoZm9ybSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGhvc3QgPSAiIjsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihmb3JtICYmIChob3N0ID0gZm9ybVsnaG9zdCddLnZhbHVlKSAKICAgICAgICAgICAgICAgICAgICAmJiAoeG1sSHR0cCA9IENyZWF0ZVhNTEhUVFAoKSkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJndiA9ICJvcD1kbnNfYWRkJmhvc3Q9Iitob3N0OwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KGFyZ3YpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dETlMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERlbGV0ZUROUyhob3N0aWQsIGhvc3QpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciB4bWxIdHRwID0gbnVsbDsgCiAgICAgICAgICAgICAgICBpZihob3N0aWQgPj0gMCAmJiBob3N0CiAgICAgICAgICAgICAgICAgICAgJiYgY29uZmlybSgi5oKo56Gu6K6k5Yig6ZmkRE5TWyIraG9zdCsiXSA/IikKICAgICAgICAgICAgICAgICAgICAmJih4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPWRuc19kZWxldGUmaG9zdGlkPSIraG9zdGlkKyImaG9zdD0iK2hvc3Q7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dETlMoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIExpc3RETlMoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9ZG5zX2xpc3QiOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub3BlbignUE9TVCcsICcvJywgdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LUxlbmd0aCIsIGFyZ3YubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnJlYWR5U3RhdGU9PTQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAuc3RhdHVzID09IDIwMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93RE5TKHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBSZXNldFByb3h5TGlzdCgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBmb3JtID0gZG9jdW1lbnQuZm9ybXNbJ3Byb3h5LWFkZC1mb3JtJ107CiAgICAgICAgICAgICAgICBpZihmb3JtKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS5mb2N1cygpOwogICAgICAgICAgICAgICAgICAgIGZvcm1bJ2hvc3QnXS52YWx1ZSA9ICcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIFNob3dQcm94eSh0eHQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJveHktbGlzdCcpOwogICAgICAgICAgICAgICAgdmFyIHByb3h5bGlzdCA9IG51bGw7CiAgICAgICAgICAgICAgICBpZih0eHQgJiYgZGl2ICYmIChwcm94eWxpc3QgPSBldmFsKHR4dCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzZXRQcm94eUxpc3QoKTsgCiAgICAgICAgICAgICAgICAgICAgdmFyIGhvc3RpZCA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBob3N0ID0gIiI7CiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IC0xOwogICAgICAgICAgICAgICAgICAgIHZhciBodG1sc3RyID0gIjx1bCBjbGFzcz0ncHJveHktdWwnPiI7CiAgICAgICAgICAgICAgICAgICAgZm9yKHggaW4gcHJveHlsaXN0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaG9zdGlkID0gcHJveHlsaXN0W3hdWydpZCddOwogICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gIHByb3h5bGlzdFt4XVsnaG9zdCddOwogICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBwcm94eWxpc3RbeF1bJ3N0YXR1cyddOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8bGkgY2xhc3M9J3Byb3h5LWxpJyBvbm1vdXNlb3V0PVwib3V0RGl2KHRoaXMsICdwcm94eS1saScpXCIgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAiIG9ubW91c2Vtb3ZlPVwib25EaXYodGhpcywgJ3Byb3h5LWxpLXNlbGVjdGVkJylcIiA+IjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSBob3N0OwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBpZihzdGF0dXMgPiAwKSBodG1sc3RyICs9ICLmnInmlYgiOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlICBodG1sc3RyICs9ICLlrp7mlYgiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICImbmJzcDsmbmJzcDsiOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8c3BhbiBjbGFzcz0nZWRlbGV0ZScgdGl0bGU9J0RlbGV0ZScgIjsKICAgICAgICAgICAgICAgICAgICAgICAgaHRtbHN0ciArPSAib25jbGljaz1cIkRlbGV0ZVByb3h5KCIraG9zdGlkKyIsICciK2hvc3QrIicpXCI+IitjaHJkZWwrIjwvc3Bhbj4iOwogICAgICAgICAgICAgICAgICAgICAgICBodG1sc3RyICs9ICI8L2xpPiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGh0bWxzdHIgKz0gIjwvdWw+IjsKICAgICAgICAgICAgICAgICAgICBkaXYuaW5uZXJIVE1MID0gaHRtbHN0cjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBBZGRQcm94eShmb3JtKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgaG9zdCA9ICIiOwogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGZvcm0gPT0gbnVsbCB8fCAoaG9zdD1mb3JtWydob3N0J10udmFsdWUpID09ICIiIHx8IGhvc3QuaW5kZXhPZignOicpIDw9IDApIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfku6PnkIbmnI3liqHlmajmoLzlvI/kuLo6MjAyLjEwNi4wLjIwOjg4ODgnKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihob3N0ICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXByb3h5X2FkZCZob3N0PSIraG9zdDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydChhcmd2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaG93UHJveHkoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2VuZChhcmd2KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIERlbGV0ZVByb3h5KGhvc3RpZCwgaG9zdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBudWxsOyAKICAgICAgICAgICAgICAgIGlmKGhvc3RpZCA+PSAwICYmIGhvc3QKICAgICAgICAgICAgICAgICAgICAmJiBjb25maXJtKCLmgqjnoa7orqTliKDpmaTku6PnkIZbIitob3N0KyJdID8iKQogICAgICAgICAgICAgICAgICAgICYmICh4bWxIdHRwID0gQ3JlYXRlWE1MSFRUUCgpKSAhPSBudWxsKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhciBhcmd2ID0gIm9wPXByb3h5X2RlbGV0ZSZob3N0aWQ9Iitob3N0aWQrIiZob3N0PSIraG9zdDsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oJ1BPU1QnLCAnLycsIHRydWUpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1MZW5ndGgiLCBhcmd2Lmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIik7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih4bWxIdHRwLnN0YXR1cyA9PSAyMDApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU2hvd1Byb3h5KHhtbEh0dHAucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNlbmQoYXJndik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmdW5jdGlvbiBMaXN0UHJveHkoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgeG1sSHR0cCA9IG51bGw7IAogICAgICAgICAgICAgICAgaWYoKHhtbEh0dHAgPSBDcmVhdGVYTUxIVFRQKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3YgPSAib3A9cHJveHlfbGlzdCI7CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5vcGVuKCdQT1NUJywgJy8nLCB0cnVlKTsKICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtTGVuZ3RoIiwgYXJndi5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpOwogICAgICAgICAgICAgICAgICAgIHhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeG1sSHR0cC5zdGF0dXMgPT0gMjAwKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoeG1sSHR0cC5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNob3dQcm94eSh4bWxIdHRwLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKGFyZ3YpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICA8L3NjcmlwdD4KICAgIDwvaGVhZD4KICAgIDwhLS0gPGJvZHkgb25sb2FkPSdqYXZhc2NyaXB0OmxvYWRJbml0KCk7Jz4gLS0+CiAgICA8Ym9keSBvbmxvYWQ9J2phdmFzY3JpcHQ6bG9hZFRhc2tJbmZvKCk7Jz4KICA8ZGl2IGlkPSdtYWluZnJhbWUnPgogICAgPGRpdiBpZD0naXRhYic+CiAgICAgICAgPHVsPgogICAgICAgIDxsaSBjbGFzcz0ndGFiLXNlbGVjdGVkJyBpZD0ndGFiMCcgb25jbGljaz0ic2VsZWN0VmlldygndGFza2luZm8nLGV2ZW50KSIgPuS4i+i9veS7u+WKoTwvbGk+CiAgICAgICAgPGxpIGlkPSd0YWIxJyBvbmNsaWNrPSJzZWxlY3RWaWV3KCdkYXRhYmFzZScsZXZlbnQpIiA+5pWw5o2u5bqT6YWN572uPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjInIG9uY2xpY2s9InNlbGVjdFZpZXcoJ3RlbXBsYXRlJywgZXZlbnQpIiA+5qih54mI6YWN572uPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjMnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ3VybGJsb2NrJywgZXZlbnQpIiA+VVJM566h55CGPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjQnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ2RhdGEnLCBldmVudCkiID7mlbDmja7nrqHnkIY8L2xpPgogICAgICAgIDxsaSBpZD0ndGFiNScgb25jbGljaz0ic2VsZWN0VmlldygnZG5zJywgZXZlbnQpIiA+RE5T566h55CGPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjYnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ3Byb3h5JywgZXZlbnQpIiA+5Luj55CG6K6+572uPC9saT4KICAgICAgICA8bGkgaWQ9J3RhYjcnIG9uY2xpY2s9InNlbGVjdFZpZXcoJ3VzZXInLCBldmVudCkiID7nlKjmiLfnrqHnkIY8L2xpPgogICAgICAgIDwvdWw+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3Rhc2tpbmZvJz48L2Rpdj4KICAgIDxkaXYgaWQ9J2RhdGFiYXNlJz4KICAgICAgICA8dGFibGUgd2lkdGg9MTAwJSBoZWlnaHQ9MTAwJSBjZWxsc3BhY2luZz0wIGJvcmRlcj0wIHZhbGlnbj10b3AgYWxpZ249bGVmdCA+CiAgICAgICAgPHRyPgogICAgICAgIDx0ZCBjbGFzcz0nZGJsaXN0JyB2YWxpZ249dG9wIHdpZHRoPTIwJSBoZWlnaHQ9MTAwJSA+CiAgICAgICAgICAgIDx0YWJsZSBjZWxsc3BhY2luZz0wIGJvcmRlcj0wIHZhbGlnbj10b3AgYWxpZ249bGVmdCB3aWR0aD0xMDAlID4KICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgPHRkIHZhbGlnbj10b3AgY2xhc3M9J2RidGl0bGUnIHdpZHRoPTEwMCUgPgogICAgICAgICAgICAgICAg54K55Ye7PHNwYW4gY2xhc3M9J2VhZGQnIHRpdGxlPSdBZGQnIG9uY2xpY2s9J0RCWEFkZChldmVudCknPiDinJogPC9zcGFuPua3u+WKoOaVsOaNruihqDwvZGl2PgogICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPHRyPgogICAgICAgICAgICAgICAgPHRkIHZhbGlnbj10b3Agd2lkdGg9MTAwJSA+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nZGJzZWxlY3QnPjwvZGl2PgogICAgICAgICAgICAgICAgPC90ZD4KICAgICAgICAgICAgPC90cj4KICAgICAgICAgICAgPC90YWJsZT4KICAgICAgICA8L3RkPgogICAgICAgIDx0ZCB2YWxpZ249dG9wIGFsaWduPWxlZnQgY2xhc3M9J2RiZmllbGRzJyBjZWxsc3BhY2luZz0wIGJvcmRlcj0wID4KICAgICAgICAgICAgPGRpdiBpZD0nZGJmaWVsZHMnPjwvZGl2PgogICAgICAgIDwvdGQ+CiAgICAgICAgPC90cj4KICAgICAgICA8L3RhYmxlPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd0ZW1wbGF0ZSc+CiAgICA8dGFibGUgY2VsbHNwYWNpbmc9MCBib3JkZXI9MCB2YWxpZ249dG9wIGFsaWduPWxlZnQgaGVpZ2h0PTEwMCUgY2xhc3M9J3RlbXBsYXRlLXRhYicgPgogICAgICAgIDx0cj4KICAgICAgICA8dGQgdmFsaWduPXRvcCBhbGlnbj1sZWZ0IGhlaWdodD0xMDAlIGNsYXNzPSd0cmVldGFiJz4KICAgICAgICAgICAgPGRpdiBpZD0ndHJlZS10aXRsZSc+5oqT5Y+W5qCR55So5LqO5oyH5a+854is6Jmr55qE54is5Y+W6Lev5b6EPC9kaXY+CiAgICAgICAgICAgIDxkaXYgaWQ9J3RyZWVib2R5JyBsZXZlbD0nMCc+PC9kaXY+CiAgICAgICAgPC90ZD4KICAgICAgICA8dGQgdmFsaWduPXRvcCBhbGlnbj1sZWZ0ID4KICAgICAgICAgICAgICA8ZGl2IGlkPSd0ZW1wbGF0ZS10aXRsZSc+5qih54mI55So5LqO5oq95Y+W6Ieq5bex6ZyA6KaB55qE5pWw5o2uPC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBpZD0nbm9kZS10ZW1wbGF0ZSc+PC9kaXY+CiAgICAgICAgICAgICAgPGRpdiBpZD0neHRlbXBsYXRlZm9ybSc+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPXVybGZvcm0gPgogICAgICAgICAgICAgICAgPGZvcm0gYWN0aW9uPSdqYXZhc2NyaXB0OnZvaWQoMCk7JyBuYW1lPSd1cmxmb3JtJyBvbnN1Ym1pdD0ncmV0dXJuIExvYWRVUkwodGhpcyk7Jz4KICAgICAgICAgICAgICAgIFVSTDo8aW5wdXQgdHlwZT10ZXh0IHNpemU9JzY0JyBuYW1lPSd1cmwnPgogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdtZXRob2QnIHZhbHVlPScwJyBjaGVja2VkPkdFVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdtZXRob2QnIHZhbHVlPScxJz5QT1NUCiAgICAgICAgICAgICAgICAmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nTG9hZCc+CiAgICAgICAgICAgICAgICA8L2Zvcm0+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgaWQ9J3NvdXJjZV9jb2RlX29wJz4KICAgICAgICAgICAgICAgICAgPGRpdiBpZD0nc291cmNlX3ZpZXcnPjwvZGl2PgogICAgICAgICAgICAgICAgICA8ZGl2IGlkPSdzb3VyY2Vfb3AnPjwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8ZGl2IGlkPSd0ZW1wbGF0ZWRpdic+CiAgICAgICAgICAgICAgICA8Zm9ybSBuYW1lPSJ0ZW1wbGF0ZWZvcm0iIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0ZW1wbGF0ZV9hZGQnID4KICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdub2RlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RlbXBsYXRlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPSctMScgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZsYWcnIHZhbHVlPScwJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbmZpZWxkcycgdmFsdWU9Jy0xJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbWFwJyB2YWx1ZT0nJyA+CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nbGlua21hcCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3VybCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J21ldGhvZCcgdmFsdWU9JycgPgogICAgICAgICAgICAgICAg5Luj56CBOjx0ZXh0YXJlYSBuYW1lPSdjb2RlJyByb3dzPTggIGNvbHM9MTIwPjwvdGV4dGFyZWE+IAogICAgICAgICAgICAgICAgPGJyPgogICAgICAgICAgICAgICAg5qih54mIOjx0ZXh0YXJlYSBuYW1lPSdwYXR0ZXJuJyByb3dzPTQgIGNvbHM9MTIwPjwvdGV4dGFyZWE+CiAgICAgICAgICAgICAgICA8YnI+CiAgICAgICAgICAgICAgICA8c3BhbiBhbGlnbj1jZW50ZXI+CiAgICAgICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX3B1YmxpYycgPuWFrOWFseWtl+autQogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19nbG9iYWwnID7ph43lpI3ljLnphY3lpJrmnaEKICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0naXNfaWdub3JlY2FzZScgPuW/veeVpeWkp+Wwj+WGmQogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xpbmtfdGFibGUnIG9uY2hhbmdlPSJjaGFuZ2VUYWJsZSh0aGlzLmZvcm0sICdsaW5rX2ZpZWxkJywgdGhpcykiPgogICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7mlbDmja7ooag8L29wdGlvbj4KICAgICAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nVGVzdCBUZW1wbGF0ZScgb25jbGljaz0iVGVzdFRlbXBsYXRlKHRoaXMuZm9ybSkiPgogICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nQ29uZmlnIFRlbXBsYXRlJyBvbmNsaWNrPSJDb25maWdUZW1wbGF0ZSh0aGlzLmZvcm0pIj4KICAgICAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RlbXBsYXRlLWJhcic+55So5LqO5ou85o6l6ZqQ6JeP55qE6ZO+5o6l5ZKMQWpheOWGheWuueWdl+WcsOWdgDwvZGl2PgogICAgICAgICAgICAgICAgVVJM6KeE5YiZOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0nbGluaycgdmFsdWU9Jycgc2l6ZT00OD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2J1dHRvbicgdmFsdWU9J1Rlc3QgVGVtcGxhdGUgJiBMaW5rJyBvbmNsaWNrPSJUZXN0VGVtcGxhdGUodGhpcy5mb3JtKSI+CiAgICAgICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSdidXR0b24nIHZhbHVlPSdTdWJtaXQgTGluaycgb25jbGljaz0iRWRpdExpbmsodGhpcy5mb3JtKTsiPgogICAgICAgICAgICAgICAgPGJyPgogICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT0nbGlua19tZXRob2QnIHZhbHVlPScwJyBjaGVja2VkPkdFVAogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPSdsaW5rX21ldGhvZCcgdmFsdWU9JzEnPlBPU1QKICAgICAgICAgICAgICAgICZuYnNwOwogICAgICAgICAgICAgICAgPHNwYW4gdGl0bGU9J+WIl+ihqOmhteS8muWumuacn+abtOaWsCc+PGlucHV0IHR5cGU9Y2hlY2tib3ggbmFtZT0nbGlua19saXN0JyA+5YiX6KGo6aG1PC9zcGFuPgogICAgICAgICAgICAgICAgJm5ic3A7CiAgICAgICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xpbmtfZmllbGQnID4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5a2X5q61PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdsaW5rX25vZGUnID4KICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5a2Q6IqC54K5PC9vcHRpb24+CiAgICAgICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgIDwvZm9ybT4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L3RkPgogICAgICAgIDwvdHI+CiAgICAgICA8L3RhYmxlPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1cmxibG9jayc+CiAgICA8ZGl2IGlkPSd1cmwtaGVhZGVyJz4KICAgIDxmb3JtIG5hbWU9J3VybGJsb2NrZm9ybScgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249J2phdmFzY3JpcHQ6dm9pZCgwKScgCiAgICAgICAgICAgIG9uc3VibWl0PSdyZXR1cm4gQWRkTm9kZVVSTCh0aGlzKScgPgogICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJ3ZhbHVlPSd1cmxfYWRkJyA+CiAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0ncGFyZW50aWQndmFsdWU9JzAnID4KICAgIDxzZWxlY3QgbmFtZT0nbm9kZWlkJyBvbmNoYW5nZT0nTGlzdE5vZGVVUkxzKHRoaXMuZm9ybSwgIm5vZGVpZCIpJz4KICAgIDxvcHRpb24gdmFsdWU9Jy0xJz7pgInmi6noioLngrk8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9JzAnIHNlbGVjdGVkPlJvb3Q8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8c2VsZWN0IG5hbWU9J2NoaWxkcycgb25jaGFuZ2U9J0xpc3ROb2RlVVJMcyh0aGlzLmZvcm0sICJjaGlsZHMiKSc+CiAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+6YCJ5oup5a2Q6IqC54K5PC9vcHRpb24+CiAgICA8L3NlbGVjdD4KICAgICZuYnNwOyZuYnNwOwogICAgPHNlbGVjdCBuYW1lPSdtZXRob2QnPgogICAgPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuivt+axguaWueazlTwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0nMCcgPkdFVDwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0nMScgPlBPU1Q8L29wdGlvbj4KICAgIDwvc2VsZWN0PgogICAgJm5ic3A7Jm5ic3A7CiAgICA8c2VsZWN0IG5hbWU9J2xldmVsJyA+CiAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5LyY5YWI57qnPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScwJyA+5pmu6YCaPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPScxJyA+57Sn5oClPC9vcHRpb24+CiAgICA8L3NlbGVjdD4KICAgICZuYnNwOyZuYnNwOwogICAgPGlucHV0IHR5cGU9dGV4dCBuYW1lPXVybCBzaXplPTQ4IHZhbHVlPSdodHRwOi8vJyA+CiAgICAmbmJzcDsmbmJzcDsKICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdBZGQnPgogICAgPC9mb3JtPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1cmwtbGlzdCc+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J2RhdGEnPjwvZGl2PgogICAgPGRpdiBpZD0nZG5zJz4KICAgIDxkaXYgaWQ9J2Rucy1oZWFkZXInPgogICAgPGZvcm0gbmFtZT0nZG5zLWFkZC1mb3JtJyBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyAKICAgICAgICAgICAgb25zdWJtaXQ9J3JldHVybiBBZGRETlModGhpcyknPgogICAg5re75YqgRE5TOjxpbnB1dCB0eXBlPXRleHQgbmFtZT0naG9zdCcgc2l6ZT00OCB2YWx1ZT0nJyA+CiAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJz4KICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZG5zLWxpc3QnPjwvZGl2PgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSdwcm94eSc+CiAgICA8ZGl2IGlkPSdwcm94eS1oZWFkZXInPgogICAgPGZvcm0gbmFtZT0ncHJveHktYWRkLWZvcm0nIGFjdGlvbj0namF2YXNjcmlwdDp2b2lkKDApJyBvbnN1Ym1pdD0ncmV0dXJuIEFkZFByb3h5KHRoaXMpJz4KICAgIOa3u+WKoOS7o+eQhjo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9J2hvc3QnIHNpemU9NDggdmFsdWU9JycgPgogICAgPGlucHV0IHR5cGU9c3VibWl0IHZhbHVlPSdvayc+CiAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3Byb3h5LWxpc3QnPjwvZGl2PgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSd1c2VyJz4KICAgIDwvZGl2Pgo8L2Rpdj4KICAgIDxkaXYgaWQ9J3R4dGZvcm0nPgogICAgICAgIDxmb3JtIG5hbWU9ImVkaXRvcmZvcm0iIGNsYXNzPSdsaXN0Zm9ybScgYWN0aW9uPSJqYXZhc2NyaXB0OnZvaWQoMCkiIAogICAgICAgICAgICBvbnN1Ym1pdD0icmV0dXJuIEVkaXROb2RlKHRoaXMpOyI+IAogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2V0eHQnIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSIgPuWFs+mXrTwvc3Bhbj4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29wJyB2YWx1ZT0nbm9kZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J25vZGVpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3BpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9J3RleHQnIG5hbWU9J25vZGVuYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nb2snIGNsYXNzPSdzdWJtaXQnID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIj54PC9zcGFuPgogICAgICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZGJmb3JtJz4KICAgICAgICA8Zm9ybSBuYW1lPSJ4ZGJmb3JtIiBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiAKICAgICAgICAgICAgb25zdWJtaXQ9InJldHVybiBFZGl0REIodGhpcyk7Ij4gCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIiA+5YWz6ZetPC9zcGFuPgogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0YWJsZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPScwJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSduYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCB2YWx1ZT0nb2snIGNsYXNzPSdzdWJtaXQnID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZWJ1dHRvbicgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIj54PC9zcGFuPgogICAgICAgIDwvZm9ybT4KICAgIDwvZGl2PgogICAgPGRpdiBpZD0nZGJmaWVsZGZvcm0nPgogICAgICAgIDxmb3JtIG5hbWU9ImRiZmllbGRmb3JtIiBjbGFzcz0nbGlzdGZvcm0nIGFjdGlvbj0iamF2YXNjcmlwdDp2b2lkKDApIiAKICAgICAgICAgICAgb25zdWJtaXQ9InJldHVybiBFZGl0RmllbGQodGhpcyk7Ij4gCiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdjbG9zZXR4dCcgb25jbGljaz0iQ2xvc2VUaGlzKHRoaXMpIiA+5YWz6ZetPC9zcGFuPgogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd0YWJsZV9hZGQnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3RhYmxlaWQnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZpZWxkaWQnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J29sZG5hbWUnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J3R5cGUnIHZhbHVlPScnID4KICAgICAgICAgICAgPGlucHV0IHR5cGU9aGlkZGVuIG5hbWU9J2ZsYWcnIHZhbHVlPScnID4KICAgICAgICAgICAg5a2X5q615ZCNOjxpbnB1dCB0eXBlPSd0ZXh0JyBuYW1lPSduYW1lJyBjbGFzcz0ndHh0aW5wdXQnIHNpemU9MjQ+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICDnsbvlnos6PHNlbGVjdCBuYW1lPSdmdHlwZScgPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMSc+SU5UPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScyJz5Eb3VibGU8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzQnIHNlbGVjdGVkPlRleHQ8L29wdGlvbj4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9JzgnPkJsb2I8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSdpc19pbmRleCcgdmFsdWU9MSA+5piv5ZCm57Si5byVCiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9J2lzX251bGwnIHZhbHVlPTQgPuaYr+WQpuS4uuepugogICAgICAgICAgICA8aW5wdXQgdHlwZT1zdWJtaXQgdmFsdWU9J29rJyBjbGFzcz0nc3VibWl0JyA+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c3BhbiBjbGFzcz0nY2xvc2VidXR0b24nIG9uY2xpY2s9IkNsb3NlVGhpcyh0aGlzKSI+eDwvc3Bhbj4KICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9J3VybGxpc3QtZm9ybSc+CiAgICAgICAgPGZvcm0gbmFtZT0idXJsbGlzdC1hZGQtZm9ybSIgY2xhc3M9J2xpc3Rmb3JtJyBhY3Rpb249ImphdmFzY3JpcHQ6dm9pZCgwKSIgCiAgICAgICAgICAgIG9uc3VibWl0PSJyZXR1cm4gQWRkTm9kZVVSTCh0aGlzKTsiPiAKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NldHh0JyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiID7lhbPpl608L3NwYW4+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT0nb3AnIHZhbHVlPSd1cmxfYWRkJyA+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPSdwYXJlbnRpZCcgdmFsdWU9JzAnID4KICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdtZXRob2QnPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nLTEnIHNlbGVjdGVkPuivt+axguaWueazlTwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMCcgPkdFVDwvb3B0aW9uPgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0nMScgPlBPU1Q8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOwogICAgICAgICAgICA8c2VsZWN0IG5hbWU9J2xldmVsJyA+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSctMScgc2VsZWN0ZWQ+5LyY5YWI57qnPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScwJyA+5pmu6YCaPC9vcHRpb24+CiAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPScxJyA+57Sn5oClPC9vcHRpb24+CiAgICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgICAgICAmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNlbGVjdCBuYW1lPSdub2RlaWQnID4KICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9Jy0xJyBzZWxlY3RlZD7pgInmi6nlrZDoioLngrk8L29wdGlvbj4KICAgICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7CiAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOwogICAgICAgICAgICAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsKICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2Nsb3NlYnV0dG9uJyBvbmNsaWNrPSJDbG9zZVRoaXModGhpcykiPng8L3NwYW4+CiAgICAgICAgICAgIDxocj4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIFVSTDo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9dXJsIHNpemU9NDggdmFsdWU9J2h0dHA6Ly8nID4KICAgICAgICAgICAgJm5ic3A7Jm5ic3A7CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPXN1Ym1pdCBuYW1lPSdzdWJtaXQnIHZhbHVlPSdBZGQnPjxicj4KICAgICAgICAgICAgPGhyPgogICAgICAgICAgICBodHRwOi8vYWJjLmNvbS9saXN0L1sxLTQ4NzZdLmh0bWwgJm5ic3A7Jm5ic3A7aHR0cDovL2FiYy5jb20vMDBsaXN0L1sxLTQ4NzZdezJ9Lmh0bWw8YnI+CiAgICAgICAgICAgIGh0dHA6Ly9hYmMuY29tL2FiY2xpc3QvW2Etel0uaHRtbCAmbmJzcDsmbmJzcDtodHRwOi8vYWJjLmNvbS9hYWFsaXN0L1thLXpdezN9Lmh0bWwKICAgICAgICA8L2Zvcm0+CiAgICA8L2Rpdj4KCiAgICA8L2JvZHk+CjwvaHRtbD4K";
#endif
